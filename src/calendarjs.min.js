function calendarJs(sb,tb,ub){function aa(a){q=k(a)?a:new Date;var b=(new Date(q.getFullYear(),q.getMonth(),1)).getDay();a=Ka(q.getFullYear(),q.getMonth());0===b&&(b=7);sa();if(!Za){var c=R($a);c.className="calendar";vb(c);wb(c);xb(c);yb(c);zb();var e=g("div"),f=d.dayHeaderNames.length;e.className="row header-days";c.appendChild(e);for(var h=0;h<f;h++){var m=d.dayHeaderNames[h],l=g("div");l.className="cell";l.innerHTML=m;e.appendChild(l)}for(e=0;6>e;e++)for(f=g("div"),f.className="row",c.appendChild(f),
h=0;7>h;h++)m=7*e+(h+1),l=g("div"),l.className="cell",l.id="calendar-day-"+m,f.appendChild(l);Za=!0}h=b;if(1<h)for(c=new Date(q),c.setMonth(c.getMonth()-1),e=Ka(c.getFullYear(),c.getMonth()),f=1,h=e-h+1;h<e;h++)La(h+1,f,c.getMonth(),c.getFullYear(),!0),f++;for(e=c=0;e<a;e++)c=b+e,La(e+1,c,q.getMonth(),q.getFullYear(),!1);if(42>c)for(a=1,b=new Date(q),b.setMonth(b.getMonth()+1),c+=1;43>c;c++)La(a,c,b.getMonth(),b.getFullYear(),!0),a++;K();null===L&&(L=g("div"),L.className="disabled-background");null===
M&&(M=g("div"),M.className="calender-event-editor-dialog",r.body.appendChild(M),b=g("div"),b.className="view",M.appendChild(b),ba=g("div"),ba.className="disabled-area",b.appendChild(ba),ca=g("div"),ca.className="title-bar",b.appendChild(ca),a=g("div"),a.className="contents",b.appendChild(a),b=g("p"),b.innerText=d.fromText,a.appendChild(b),b=g("div"),b.className="split",a.appendChild(b),x=g("input"),x.onchange=Ma,b.appendChild(x),ta(x,"date"),y=g("input"),b.appendChild(y),ta(y,"time"),b=g("label"),
b.className="checkbox",b.innerText=d.isAllDayEventText,a.appendChild(b),E=g("input"),E.type="checkbox",E.onchange=Ma,b.appendChild(E),c=g("span"),c.className="check-mark",b.appendChild(c),b=g("p"),b.innerText=d.toText,a.appendChild(b),b=g("div"),b.className="split",a.appendChild(b),z=g("input"),b.appendChild(z),ta(z,"date"),A=g("input"),b.appendChild(A),ta(A,"time"),b=g("p"),b.innerText=d.titleText,a.appendChild(b),N=g("input"),N.type="text",a.appendChild(N),b=g("p"),b.innerText=d.descriptionText,
a.appendChild(b),da=g("textarea"),a.appendChild(da),S=g("p"),S.className="error",a.appendChild(S),b=g("div"),b.className="split",a.appendChild(b),F=g("input"),F.className="ok",F.type="button",F.value=d.addText,F.onclick=Ab,b.appendChild(F),c=g("input"),c.className="cancel",c.type="button",c.value=d.cancelText,c.onclick=Na,b.appendChild(c),G=g("input"),G.className="remove",G.type="button",G.value=d.removeEventText,G.onclick=Bb,a.appendChild(G));null===H&&(H=g("div"),H.className="calender-confirmation-dialog",
r.body.appendChild(H),ua=g("div"),ua.className="title-bar",H.appendChild(ua),a=g("div"),a.className="contents",H.appendChild(a),va=g("div"),va.className="message",a.appendChild(va),b=g("div"),b.className="split",a.appendChild(b),O=g("input"),O.className="yes",O.type="button",O.value=d.yesText,b.appendChild(O),P=g("input"),P.className="no",P.type="button",P.value=d.noText,b.appendChild(P));null===I&&(I=g("div"),I.className="calender-select-export-type-dialog",r.body.appendChild(I),wa=g("div"),wa.className=
"title-bar",wa.innerHTML=d.selectExportTypeTitle,I.appendChild(wa),b=g("div"),b.className="contents",I.appendChild(b),Oa=xa(b,"CSV","ExportType"),ab=xa(b,"XML","ExportType"),bb=xa(b,"JSON","ExportType"),cb=xa(b,"TEXT","ExportType"),a=g("div"),a.className="split",b.appendChild(a),b=g("input"),b.className="ok",b.type="button",b.value=d.okText,b.onclick=Cb,a.appendChild(b),b=g("input"),b.className="cancel",b.type="button",b.value=d.cancelText,b.onclick=db,a.appendChild(b));ya.innerHTML=d.monthNames[q.getMonth()]+
", "+q.getFullYear()+" \u25be"}function yb(a){t=g("div");t.className="header-date";a.appendChild(t);a=g("div");a.className="arrow previous-month";a.title=d.previousMonthTooltipText;a.onclick=eb;t.appendChild(a);a=g("div");a.className="today";a.title=d.todayTooltipText;a.onclick=fb;t.appendChild(a);a=g("div");a.className="refresh";a.title=d.refreshTooltipText;a.onclick=Pa;t.appendChild(a);a=g("div");a.className="arrow next-month";a.title=d.nextMonthTooltipText;a.onclick=gb;t.appendChild(a);d.manualEditingEnabled&&
(a=g("div"),a.className="add-event",a.title=d.addEventTooltipText,a.onclick=za,t.appendChild(a));d.exportEventsEnabled&&(T=g("div"),T.className="export-events",T.title=d.exportEventsTooltipText,t.appendChild(T),T.onclick=function(){Aa()});a=g("div");a.className="list-all-events";a.title=d.listAllEventsTooltipText;a.onclick=hb;t.appendChild(a);a=g("div");a.className="list-week-events";a.title=d.listWeekEventsTooltipText;a.onclick=ib;t.appendChild(a);ya=g("span");t.appendChild(ya)}function zb(){if(null===
w){var a=new Date(1900,1,1),b=(new Date).getFullYear()-a.getFullYear()+d.extraSelectableYearsAhead;w=g("div");w.className="years-drop-down";t.appendChild(w);var c=g("div");c.className="contents custom-scroll-bars";w.appendChild(c);for(var e=0;e<b;e++)Db(c,a.getFullYear()),a.setFullYear(a.getFullYear()+1);ya.onclick=function(f){"block"!==w.style.display&&(f.preventDefault(),f.cancelBubble=!0,w.style.display="block")};r.body.onclick=sa;jb.onresize=sa}}function Db(a,b){var c=g("div");c.innerText=b.toString();
a.appendChild(c);c.onclick=function(){q.setFullYear(b);aa(q);sa()}}function ea(a){a.isAllDayEvent&&(a.from=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),0,0),a.to=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),23,59));return a}function fa(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate()),e=new Date(b.getFullYear(),b.getMonth(),b.getDate());return Math.ceil(Math.abs(e-c)/864E5)}function sa(){null!==w&&"none"!==w.style.display&&(w.style.display="none")}
function ha(a){if(null!==d&&Qa(d[a]))d[a]()}function Ba(a,b){if(null!==d&&Qa(d[a]))d[a](b)}function kb(){for(var a=[],b=0;32>b;b++){8!==b&&12!==b&&16!==b&&20!==b||a.push("-");var c=Math.floor(16*Math.random()).toString(16);a.push(c)}return a.join("")}function K(){Eb();lb();for(var a in n)if(n.hasOwnProperty(a)){var b=[],c;for(c in n[a])n[a].hasOwnProperty(c)&&b.push(ea(n[a][c]));b.sort(function(m,l){return m.from-l.from});for(var e=b.length,f=0;f<e;f++){var h=b[f];null!==Ra(h.from)&&Fb(h)}b=[]}Gb();
mb()}function Fb(a){nb(a.from,a);if(a.from.getDate()!==a.to.getDate()){var b=fa(a.from,a.to);if(0<b)for(var c=new Date(a.from),e=0;e<b;e++)c.setDate(c.getDate()+1),null!==Ra(c)&&nb(c,a)}}function nb(a,b){var c=Ra(a);if(null!==c&&c.getElementsByClassName(d.manualEditingEnabled?"event":"event-no-hover").length<d.maximumEventsPerDayDisplay){var e=g("div"),f=b.title;d.showTimesInMainCalendarEvents&&!b.isAllDayEvent&&b.from.getDate()===b.to.getDate()&&(f=Ca(b.from,b.to)+": "+f);e.className=d.manualEditingEnabled?
"event":"event-no-hover";e.title=f;e.innerHTML=f;c.appendChild(e);b.to<new Date&&(e.className+=" expired");b.isAllDayEvent&&(e.className+=" all-day-event");d.dragAndDropForEventsEnabled&&d.manualEditingEnabled&&e.setAttribute("draggable",!0);d.manualEditingEnabled&&(e.onclick=function(){U(b)});d.dragAndDropForEventsEnabled&&d.manualEditingEnabled&&(e.ondragstart=function(){u=b})}}function Gb(){var a=0,b;for(b in n)if(n.hasOwnProperty(b))for(var c in n[b])if(n[b].hasOwnProperty(c)){a++;break}d.exportEventsEnabled&&
(T.style.display=0===a?"none":"block")}function Ra(a){var b=new Date(q.getFullYear(),q.getMonth(),1),c=new Date(q),e=new Date(q),f=null,h=0;c.setMonth(c.getMonth()+1);e.setMonth(e.getMonth()-1);a.getMonth()===c.getMonth()&&a.getFullYear()===c.getFullYear()?(b=b.getDay()+Ka(q.getFullYear(),q.getMonth()),h=a.getDate()+b-1):a.getMonth()===e.getMonth()&&a.getFullYear()===e.getFullYear()?h=b.getDay()-fa(a,q):a.getMonth()===q.getMonth()&&a.getFullYear()===q.getFullYear()&&(b=b.getDay(),h=a.getDate()+b-
1);0<h&&(f=R("calendar-day-"+h));return f}function Eb(){for(var a=0;6>a;a++)for(var b=0;7>b;b++)for(var c=R("calendar-day-"+(7*a+(b+1))).getElementsByClassName(d.manualEditingEnabled?"event":"event-no-hover");c[0];)c[0].parentNode.removeChild(c[0])}function xb(a){if(null===B){B=g("div");B.className="full-day-view";a.appendChild(B);a=g("div");a.className="title-bar";B.appendChild(a);Q=g("div");Q.className="title";a.appendChild(Q);var b=g("div");b.className="close";b.title=d.closeTooltipText;a.appendChild(b);
b.onclick=function(){Sa(B);Da=null};d.manualEditingEnabled&&(b=g("div"),b.className="add-event",b.title=d.addEventTooltipText,b.onclick=za,a.appendChild(b));d.exportEventsEnabled&&(V=g("div"),V.className="export-events",V.title=d.exportEventsTooltipText,a.appendChild(V),V.onclick=function(){Aa(Ea)});ia=g("div");ia.className="contents custom-scroll-bars";B.appendChild(ia)}}function ob(a){Ta(B);Q.innerText="";ia.innerHTML="";Da=a;Ea=[];var b=g("span");b.innerText=a.getDate();Q.appendChild(b);d.showDayNumberOrdinals&&
(b=g("sup"),b.innerText=Ua(a.getDate()),Q.appendChild(b));b=g("span");b.innerText=" "+d.monthNames[a.getMonth()]+" "+a.getFullYear();Q.appendChild(b);for(var c in n)if(n.hasOwnProperty(c)){b=[];for(var e in n[c])if(n[c].hasOwnProperty(e))for(var f=ea(n[c][e]),h=fa(f.from,f.to)+1,m=new Date(f.from),l=0;l<h;l++)m.getFullYear()===a.getFullYear()&&m.getMonth()===a.getMonth()&&m.getDate()===a.getDate()&&b.push(f),m.setDate(m.getDate()+1);b.sort(function(p,J){return p.from-J.from});f=b.length;for(h=0;h<
f;h++)Hb(b[h])}d.exportEventsEnabled&&(V.style.display=0===Ea.length?"none":"block")}function Hb(a){var b=g("div");b.className=d.manualEditingEnabled?"event":"event-no-hover";ia.appendChild(b);var c=g("div");c.className="title";c.innerHTML=a.title;b.appendChild(c);c=g("div");c.className="date";b.appendChild(c);a.from.getDate()===a.to.getDate()?c.innerHTML=a.isAllDayEvent?d.allDayEventText:Ca(a.from,a.to):Va(c,a.from,a.to);a.to<new Date&&(b.className+=" expired");a.isAllDayEvent&&(b.className+=" all-day-event");
""!==a.description&&(c=g("div"),c.className="description",c.innerHTML=a.description,b.appendChild(c));d.manualEditingEnabled&&(b.onclick=function(){U(a)});Ea.push(a)}function vb(a){if(null===C){C=g("div");C.className="list-all-events-view";a.appendChild(C);a=g("div");a.className="title-bar";C.appendChild(a);var b=g("div");b.className="title";b.innerHTML=d.allEventsText;a.appendChild(b);b=g("div");b.className="close";b.title=d.closeTooltipText;a.appendChild(b);b.onclick=function(){Sa(C)};d.manualEditingEnabled&&
(b=g("div"),b.className="add-event",b.title=d.addEventTooltipText,b.onclick=za,a.appendChild(b));d.exportEventsEnabled&&(ja=g("div"),ja.className="export-events",ja.title=d.exportEventsTooltipText,a.appendChild(ja),ja.onclick=function(){Aa()});ka=g("div");ka.className="contents custom-scroll-bars";C.appendChild(ka)}}function hb(){Ta(C);ka.innerHTML="";var a=[];for(c in n)if(n.hasOwnProperty(c))for(var b in n[c])n[c].hasOwnProperty(b)&&a.push(ea(n[c][b]));a.sort(function(h,m){return h.from-m.from});
var c=a.length;for(b=0;b<c;b++){var e=a[b],f=Ib(e.from);Jb(e,f)}}function Jb(a,b){var c=g("div");c.className=d.manualEditingEnabled?"event":"event-no-hover";b.appendChild(c);var e=g("div");e.className="title";e.innerHTML=a.title;c.appendChild(e);e=g("div");e.className="date";c.appendChild(e);a.from.getDate()===a.to.getDate()?a.isAllDayEvent?Fa(e,a.from,null," - "+d.allDayEventText):Fa(e,a.from,null," - "+Ca(a.from,a.to)):Va(e,a.from,a.to);a.to<new Date&&(c.className+=" expired");a.isAllDayEvent&&
(c.className+=" all-day-event");""!==a.description&&(e=g("div"),e.className="description",e.innerHTML=a.description,c.appendChild(e));d.manualEditingEnabled&&(c.onclick=function(){U(a)})}function Ib(a){var b="month-"+a.getMonth()+"-"+a.getFullYear(),c=R(b);if(null===c){var e=g("div");e.className="month";ka.appendChild(e);c=g("div");c.className="header";c.innerHTML=d.monthNames[a.getMonth()]+" "+a.getFullYear();e.appendChild(c);c=g("div");c.id=b;c.className="events";e.appendChild(c)}return c}function wb(a){if(null===
D){D=g("div");D.className="list-all-week-events-view";a.appendChild(D);a=g("div");a.className="title-bar";D.appendChild(a);var b=g("div");b.className="title";b.innerHTML=d.allWeekEventsText;a.appendChild(b);b=g("div");b.className="close";b.title=d.closeTooltipText;a.appendChild(b);b.onclick=function(){Sa(D)};d.manualEditingEnabled&&(b=g("div"),b.className="add-event",b.title=d.addEventTooltipText,b.onclick=za,a.appendChild(b));d.exportEventsEnabled&&(W=g("div"),W.className="export-events",W.title=
d.exportEventsTooltipText,a.appendChild(W),W.onclick=function(){Aa(Ga)});la=g("div");la.className="contents custom-scroll-bars";D.appendChild(la)}}function ib(){Ta(D);la.innerHTML="";Ga=[];var a=[],b=new Date,c=b.getDate()-b.getDay()+1,e=c+6;c=new Date(b.setDate(c));b=new Date(b.setDate(e));c.setHours(0,0,0,0);b.setHours(0,0,0,0);for(var f in n)if(n.hasOwnProperty(f))for(var h in n[f])n[f].hasOwnProperty(h)&&a.push(ea(n[f][h]));a.sort(function(Kb,Lb){return Kb.from-Lb.from});f=a.length;for(h=0;h<
f;h++){e=a[h];for(var m=fa(e.from,e.to)+1,l=new Date(e.from),p=!1,J=0;J<m;J++)l>=c&&l<=b&&(p=Mb(l),Nb(e,p),p=!0),l.setDate(l.getDate()+1);p&&Ga.push(e)}d.exportEventsEnabled&&(W.style.display=0===Ga.length?"none":"block")}function Nb(a,b){var c=g("div");c.className=d.manualEditingEnabled?"event":"event-no-hover";b.appendChild(c);var e=g("div");e.className="title";e.innerHTML=a.title;c.appendChild(e);e=g("div");e.className="date";c.appendChild(e);a.from.getDate()===a.to.getDate()?e.innerHTML=a.isAllDayEvent?
d.allDayEventText:Ca(a.from,a.to):Va(e,a.from,a.to);a.to<new Date&&(c.className+=" expired");a.isAllDayEvent&&(c.className+=" all-day-event");""!==a.description&&(e=g("div"),e.className="description",e.innerHTML=a.description,c.appendChild(e));d.manualEditingEnabled&&(c.onclick=function(){U(a)})}function Mb(a){var b=0>a.getDay()-1?6:a.getDay()-1,c="day-"+b,e=R(c);if(null===e){var f=g("div");f.className="day";la.appendChild(f);e=g("div");e.className="header";f.appendChild(e);Fa(e,a,d.dayNames[b]+", ");
e=g("div");e.id=c;e.className="events";f.appendChild(e)}return e}function Ca(a,b){return Wa(a)+" "+d.toTimeText+" "+Wa(b)}function Wa(a){return v(a.getHours())+":"+v(a.getMinutes())}function Va(a,b,c){var e=g("span");e.innerText=d.startsAtText+" ";a.appendChild(e);pb(a,b);b=g("span");b.innerText=" "+d.andFinishesAtText+" ";a.appendChild(b);pb(a,c)}function pb(a,b,c){c=k(c)?c:!0;Fa(a,b);var e=g("span");e.innerText=" "+d.monthNames[b.getMonth()]+" "+b.getFullYear();a.appendChild(e);c&&(c=g("span"),
c.innerText=" "+Wa(b),a.appendChild(c))}function Fa(a,b,c,e){if(k(c)){var f=g("span");f.innerText=c;a.appendChild(f)}c=g("span");c.innerText=b.getDate();a.appendChild(c);d.showDayNumberOrdinals&&(c=g("sup"),c.innerText=Ua(b.getDate()),a.appendChild(c));k(e)&&(b=g("span"),b.innerText=e,a.appendChild(b))}function La(a,b,c,e,f){var h=new Date;h=a===h.getDate()&&q.getFullYear()===h.getFullYear()&&q.getMonth()===h.getMonth();b=R("calendar-day-"+b);var m=g("span");b.className="cell"+(h?" today":"");b.innerHTML=
"";m.className=f?"day-muted":"";m.innerText=a;d.showDayNumberOrdinals&&(f=g("sup"),f.innerText=Ua(a),m.appendChild(f));b.appendChild(m);d.fullDayViewEnabled&&(f=g("div"),f.className="expand-day",f.title=d.expandDayTooltipText,b.appendChild(f),f.onclick=function(){ob(new Date(e,c,a))});d.manualEditingEnabled&&(b.ondblclick=function(){U(null,new Date(e,c,a))},d.manualEditingEnabled&&(b.ondragover=function(l){l.preventDefault();l.cancelBubble=!0},b.ondrop=function(l){l.preventDefault();l.cancelBubble=
!0;if(null!==u){l=fa(u.from,u.to);var p=new Date(e,c,a,u.from.getHours(),u.from.getMinutes()),J=new Date(e,c,a,u.to.getHours(),u.to.getMinutes());0<l&&J.setDate(J.getDate()+l);ma.updateEvent(u.id,{from:p,to:J,title:u.title,description:u.description,isAllDayEvent:u.isAllDayEvent})}}))}function Ka(a,b){return(new Date(a,b+1,0)).getDate()}function Ua(a){var b=d.thText;if(31===a||21===a||1===a)b=d.stText;else if(22===a||2===a)b=d.ndText;else if(23===a||3===a)b=d.rdText;return b}function ta(a,b){try{a.type=
b}catch(c){a.type="text"}}function za(){U(null,Da)}function Ma(){var a=!1;E.checked&&(z.value=x.value,y.value="00:00",A.value="23:59",a=!0);z.disabled=a;y.disabled=a;A.disabled=a}function U(a,b){try{r.body.appendChild(L)}catch(h){console.warn(h.message)}lb();M.style.display="block";S.style.display="none";x.focus();if(k(a))F.value=d.updateText,G.style.display="block",ca.innerHTML=d.editEventTitle,X=a,x.value=Ha(a.from),y.value=Ia(a.from),z.value=Ha(a.to),A.value=Ia(a.to),E.checked=a.isAllDayEvent,
N.value=a.title,da.value=a.description;else{var c=new Date,e=k(b)?b:c,f=new Date;e.getDate()===f.getDate()&&e.getFullYear()===f.getFullYear()&&e.getMonth()===f.getMonth()&&(e.setHours(c.getHours()),e.setMinutes(c.getMinutes()));F.value=d.addText;G.style.display="none";ca.innerHTML=d.addEventTitle;X=null;x.value=Ha(e);y.value=Ia(e);z.value=Ha(e);A.value=Ia(e);E.checked=!1;N.value="";da.value=""}Ma()}function Ab(){var a=new Date(x.value),b=new Date(z.value),c=y.value.split(":"),e=A.value.split(":"),
f=N.value.replace(/^\s+|\s+$/g,""),h=da.value.replace(/^\s+|\s+$/g,"");0>=c.length?Ja(d.fromTimeErrorMessage,y):0>=e.length?Ja(d.toTimeErrorMessage,A):b<a?Ja(d.toSmallerThanFromErrorMessage,z):""===f?Ja(d.titleErrorMessage,N):(Na(),a.setHours(parseInt(c[0])),a.setMinutes(parseInt(c[1])),b.setHours(parseInt(e[0])),b.setMinutes(parseInt(e[1])),a={from:a,to:b,title:f,description:h,isAllDayEvent:E.checked},null!==X?ma.updateEvent(X.id,a,!1):ma.addEvent(a,!1),K(),Xa())}function Na(){M.style.display="none";
try{r.body.removeChild(L)}catch(a){console.warn(a.message)}mb()}function Bb(){ba.style.display="block";var a=function(){ba.style.display="none"};Ob(d.confirmEventRemoveTitle,d.confirmEventRemoveMessage,function(){a();Na();null!==X&&(ma.removeEvent(X.id,!0),Xa())},a)}function Ha(a){var b=("0"+a.getDate()).slice(-2),c=("0"+(a.getMonth()+1)).slice(-2);return a.getFullYear()+"-"+c+"-"+b}function Ia(a){return v(a.getHours())+":"+v(a.getMinutes())}function v(a){a=a.toString();return 1===a.length?"0"+a:
a}function Ja(a,b){S.innerHTML=a;S.style.display="block";b.focus()}function Xa(){na(B)&&ob(Da);na(C)&&hb();na(D)&&ib()}function Ob(a,b,c,e){H.style.display="block";ua.innerHTML=a;va.innerHTML=b;O.onclick=qb;P.onclick=qb;O.addEventListener("click",c);Qa(e)&&P.addEventListener("click",e)}function qb(){H.style.display="none"}function xa(a,b,c){var e=g("label");e.className="radioButton";e.innerText=b;a.appendChild(e);a=g("input");a.type="radio";a.name=c;e.appendChild(a);c=g("span");c.className="check-mark";
e.appendChild(c);return a}function Aa(a){try{r.body.appendChild(L)}catch(b){console.warn(b.message)}I.style.display="block";oa=a;Oa.checked=!0}function db(){try{r.body.removeChild(L)}catch(a){console.warn(a.message)}I.style.display="none"}function Cb(){db();Oa.checked?pa(oa,"csv"):ab.checked?pa(oa,"xml"):bb.checked?pa(oa,"json"):cb.checked&&pa(oa,"text")}function mb(){null===qa&&0<d.autoRefreshTimerDelay&&(qa=setInterval(function(){Pa()},d.autoRefreshTimerDelay))}function lb(){null!==qa&&0<d.autoRefreshTimerDelay&&
(clearTimeout(qa),qa=null)}function Pa(){Xa();K()}function Ta(a){na(a)||(a.className+=" overlay-shown")}function Sa(a){na(a)&&(a.className=a.className.replace(" overlay-shown",""))}function na(a){return-1<a.className.indexOf("overlay-shown")}function g(a){a=a.toLowerCase();var b="text"===a;Ya.hasOwnProperty(a)||(Ya[a]=b?r.createTextNode(""):r.createElement(a));return Ya[a].cloneNode(!1)}function R(a){Y.hasOwnProperty(a)&&null!==Y[a]||(Y[a]=r.getElementById(a));r.body.contains(Y[a])||(Y[a]=r.getElementById(a));
return Y[a]}function k(a){return void 0!==a&&null!==a&&""!==a}function Qa(a){return k(a)&&"function"===typeof a}function pa(a,b){b=k(b)?b.toLowerCase():"csv";var c="",e=Pb(a);if("csv"===b){var f=[d.fromText,d.toText,d.isAllDayEventText,d.titleText,d.descriptionText],h=f.length;c=[];for(var m=[],l=0;l<h;l++)c.push(Z(f[l]));m.push(c.join(","));f=e.length;for(h=0;h<f;h++){c=m;l=e[h];var p=[];p.push(Z(ra(l.from)));p.push(Z(ra(l.to)));p.push(Z(l.isAllDayEvent?d.yesText:d.noText));p.push(Z(l.title.toString()));
p.push(Z(l.description.toString()));c.push(p.join(","))}c=m.join("\n")}else if("xml"===b){m=[];m.push('<?xml version="1.0" ?>');m.push("<Events>");h=e.length;for(c=0;c<h;c++){l=e[c];m.push("<Event>");for(f in l)l.hasOwnProperty(f)&&(p=l[f],"boolean"===typeof p?p=p?d.yesText:d.noText:"object"===typeof p&&(p=ra(p)),m.push("<"+rb(f)+">"+p+"</"+f+">"));m.push("</Event>")}m.push("</Events>");c=m.join("\n")}else if("json"===b){f=[];f.push("{");f.push('"events:": [');h=e.length;for(c=0;c<h;c++){l=e[c];f.push("{");
for(m in l)l.hasOwnProperty(m)&&(p=l[m],"boolean"===typeof p?p=p?d.yesText:d.noText:"object"===typeof p&&(p=ra(p)),f.push('"'+m+'":"'+p+'",'));l=f[f.length-1];f[f.length-1]=l.substring(0,l.length-1);f.push("},")}f[f.length-1]="}";f.push("]");f.push("}");c=f.join("\n")}else if("text"===b){m=[];f=e.length;for(c=0;c<f;c++){l=e[c];for(h in l)l.hasOwnProperty(h)&&(p=l[h],"boolean"===typeof p?p=p?d.yesText:d.noText:"object"===typeof p&&(p=ra(p)),m.push(rb(h)+": "+p));m.push("")}m.pop();c=m.join("\n")}""!==
c&&(e=g("a"),f="text"===b?"plain":b,m="text"===b?"txt":b,e.style.display="none",e.setAttribute("target","_blank"),e.setAttribute("href","data:text/"+f+";charset=utf-8,"+encodeURIComponent(c)),f=e.setAttribute,c=new Date,h=v(c.getDate())+"-"+v(c.getMonth())+"-"+c.getFullYear(),c=v(c.getHours())+"-"+v(c.getMinutes()),f.call(e,"download",d.exportStartFilename+h+"_"+c+"."+m),r.body.appendChild(e),e.click(),r.body.removeChild(e),ha("onEventsExported"))}function Pb(a){var b=[];if(k(a))for(var c=a.length,
e=0;e<c;e++)b.push(a[e]);else for(c in n)if(n.hasOwnProperty(c))for(e in n[c])n[c].hasOwnProperty(e)&&b.push(n[c][e]);b.sort(function(f,h){return f.from-h.from});return b}function ra(a){var b=v(a.getDate())+"/"+v(a.getMonth())+"/"+a.getFullYear();a=v(a.getHours())+":"+v(a.getMinutes());return b+" "+a}function rb(a){return a.charAt(0).toUpperCase()+a.slice(1)}function Z(a){a=a.replace(/(\r\n|\n|\r)/gm,"").replace(/(\s\s)/gm," ");a=a.replace(/"/g,'""');return'"'+a+'"'}function eb(){var a=new Date(q);
a.setMonth(a.getMonth()-1);a.setDate(1);aa(a);ha("onPreviousMonth")}function gb(){var a=new Date(q);a.setMonth(a.getMonth()+1);a.setDate(1);aa(a);ha("onNextMonth")}function fb(){aa();ha("onToday")}var d={},ma=this,q,Ya={},Y={},r=null,jb=null,$a=null,Za=!1,n={},qa=null,u=null,t=null,ya=null,w=null,T=null,L=null,M=null,ba=null,ca=null,x=null,y=null,z=null,A=null,E=null,N=null,da=null,S=null,X=null,F=null,G=null,B=null,Q=null,ia=null,Da=null,Ea=[],V=null,C=null,ja=null,ka=null,D=null,W=null,la=null,
Ga=[],H=null,ua=null,va=null,O=null,P=null,I=null,wa=null,Oa=null,ab=null,bb=null,cb=null,oa=null;this.moveToPreviousMonth=function(){eb()};this.moveToNextMonth=function(){gb()};this.moveToToday=function(){fb()};this.exportAllEvents=function(a){d.exportEventsEnabled&&pa(null,a)};this.refresh=function(){Pa()};this.addEvents=function(a,b,c){b=k(b)?b:!0;c=k(c)?c:!0;for(var e=a.length,f=0;f<e;f++)this.addEvent(a[f],!1,!1);c&&Ba("onEventAdded",a);b&&K()};this.addEvent=function(a,b,c){var e=!1;if(a.from<=
a.to){var f=a.from;f=f.getFullYear()+"-"+f.getMonth()+"-"+f.getDate();var h=kb();n.hasOwnProperty(f)||(n[f]={});n[f].hasOwnProperty(h)||(b=k(b)?b:!0,c=k(c)?c:!0,a.id=h,n[f][h]=ea(a),e=!0,c&&Ba("onEventAdded",a),b&&K())}return e};this.updateEvent=function(a,b,c,e){if(a=this.removeEvent(a,!1,!1))c=k(c)?c:!0,e=k(e)?e:!0,b.id=kb(),(a=this.addEvent(b,c,!1))&&e&&Ba("onEventUpdated",b);return a};this.removeEvent=function(a,b,c){var e=!1,f;for(f in n)if(n.hasOwnProperty(f))for(var h in n[f])if(n[f].hasOwnProperty(h)&&
h===a){b=k(b)?b:!0;c=k(c)?c:!0;delete n[f][h];e=!0;c&&Ba("onEventRemoved",n[f][h]);b&&K();break}return e};this.clearEvents=function(a){a=k(a)?a:!0;n={};ha("onEventsCleared");a&&K()};this.setOptions=function(a){d=null!==a&&"object"===typeof a?a:{};k(d.previousMonthTooltipText)||(d.previousMonthTooltipText="Previous Month");k(d.nextMonthTooltipText)||(d.nextMonthTooltipText="Next Month");k(d.addEventTooltipText)||(d.addEventTooltipText="Add Event");k(d.closeTooltipText)||(d.closeTooltipText="Close");
k(d.exportEventsTooltipText)||(d.exportEventsTooltipText="Export Events");k(d.todayTooltipText)||(d.todayTooltipText="Today");k(d.refreshTooltipText)||(d.refreshTooltipText="Refresh");k(d.expandDayTooltipText)||(d.expandDayTooltipText="Expand Day");k(d.listAllEventsTooltipText)||(d.listAllEventsTooltipText="View All Events");k(d.listWeekEventsTooltipText)||(d.listWeekEventsTooltipText="View Week Events");k(d.dayHeaderNames)||(d.dayHeaderNames="Mo Tu We Th Fr Sa Su".split(" "));k(d.dayNames)||(d.dayNames=
"Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "));k(d.fromText)||(d.fromText="From:");k(d.toText)||(d.toText="To:");k(d.isAllDayEventText)||(d.isAllDayEventText="Is All Day Event");k(d.titleText)||(d.titleText="Title:");k(d.descriptionText)||(d.descriptionText="Description:");k(d.addText)||(d.addText="Add");k(d.updateText)||(d.updateText="Update");k(d.cancelText)||(d.cancelText="Cancel");k(d.removeEventText)||(d.removeEventText="Remove Event");k(d.addEventTitle)||(d.addEventTitle=
"Add Event");k(d.editEventTitle)||(d.editEventTitle="Edit Event");k(d.monthNames)||(d.monthNames="January February March April May June July August September October November December".split(" "));k(d.showDayNumberOrdinals)||(d.showDayNumberOrdinals=!0);k(d.dragAndDropForEventsEnabled)||(d.dragAndDropForEventsEnabled=!0);k(d.exportStartFilename)||(d.exportStartFilename="exported_events_");k(d.fromTimeErrorMessage)||(d.fromTimeErrorMessage="Please select a valid 'From' time.");k(d.toTimeErrorMessage)||
(d.toTimeErrorMessage="Please select a valid 'To' time.");k(d.toSmallerThanFromErrorMessage)||(d.toSmallerThanFromErrorMessage="Please select a 'To' date that is larger than the 'From' date.");k(d.titleErrorMessage)||(d.titleErrorMessage="Please enter a value in the 'Title' field (no empty space).");k(d.stText)||(d.stText="st");k(d.ndText)||(d.ndText="nd");k(d.rdText)||(d.rdText="rd");k(d.thText)||(d.thText="th");k(d.fullDayViewEnabled)||(d.fullDayViewEnabled=!0);k(d.maximumEventsPerDayDisplay)||
(d.maximumEventsPerDayDisplay=3);k(d.yesText)||(d.yesText="Yes");k(d.noText)||(d.noText="No");k(d.extraSelectableYearsAhead)||(d.extraSelectableYearsAhead=51);k(d.allDayEventText)||(d.allDayEventText="All Day Event");k(d.allEventsText)||(d.allEventsText="All Events");k(d.allWeekEventsText)||(d.allWeekEventsText="All Week Events");k(d.exportEventsEnabled)||(d.exportEventsEnabled=!0);k(d.manualEditingEnabled)||(d.manualEditingEnabled=!0);k(d.showTimesInMainCalendarEvents)||(d.showTimesInMainCalendarEvents=
!1);k(d.startsAtText)||(d.startsAtText="Starts at");k(d.andFinishesAtText)||(d.andFinishesAtText="and finishes at");k(d.toTimeText)||(d.toTimeText="to");k(d.autoRefreshTimerDelay)||(d.autoRefreshTimerDelay=5E3);k(d.confirmEventRemoveTitle)||(d.confirmEventRemoveTitle="Confirm Event Removal");k(d.confirmEventRemoveMessage)||(d.confirmEventRemoveMessage="Removing this event cannot be undone.  Do you want to continue?");k(d.okText)||(d.okText="OK");k(d.selectExportTypeTitle)||(d.selectExportTypeTitle=
"Select Export Type")};(function(a,b){r=a;jb=b;$a=sb;ma.setOptions(tb);aa(ub)})(document,window)};