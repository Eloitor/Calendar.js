function calendarJs(Ud,Vd,Wd){function J(a,c){t=h(a)?a:new Date;c=h(c)?c:!1;t.setDate(1);t.setHours(0,0,0,0);var b=(new Date(t.getFullYear(),t.getMonth(),1)).getDay(),e=Jb(t.getFullYear(),t.getMonth());0===b&&(b=7);ya();if(!Kb){B=Ma(Xc);B.className="calendar";B.innerHTML="";Xd();Yd();Zd();$d();var f=g("div","row header-days"),k=d.dayHeaderNames.length;B.appendChild(f);for(var l=0;l<k;l++){var m=d.dayHeaderNames[l],n=g("div","cell");n.innerHTML=m;f.appendChild(n)}for(f=0;6>f;f++)for(k=g("div","row"),
B.appendChild(k),l=0;7>l;l++)m=7*f+(l+1),n=g("div","cell"),n.id="calendar-day-"+m,k.appendChild(n),0<d.minimumDayHeight&&(n.style.height=d.minimumDayHeight+"px");ae();Kb=!0}m=b;if(1<m)for(f=new Date(t),f.setMonth(f.getMonth()-1),k=Jb(f.getFullYear(),f.getMonth()),l=1,m=k-m+1;m<k;m++)tc(m+1,l,f.getMonth(),f.getFullYear(),!0),l++;for(k=f=0;k<e;k++)f=b+k,tc(k+1,f,t.getMonth(),t.getFullYear(),!1);if(42>f){b=1;e=new Date(t);e.setMonth(e.getMonth()+1);for(f+=1;43>f;f++)tc(b,f,e.getMonth(),e.getFullYear(),
!0),b++;b=Jb(e.getFullYear(),e.getMonth());b=Math.round(b/2);uc=new Date(e.getFullYear(),e.getMonth(),b)}else uc=null;ja();c&&(null===R&&(R=g("div","disabled-background")),null!==za&&C(r.body,za),za=g("div","calendar-dialog event-editor"),r.body.appendChild(za),b=g("div","view"),za.appendChild(b),ka=g("div","disabled-area"),b.appendChild(ka),Lb=g("div","title-bar"),b.appendChild(Lb),e=g("div","contents"),b.appendChild(e),b=g("p"),b.innerText=d.titleText,e.appendChild(b),b=g("div","input-title-container"),
e.appendChild(b),Aa=g("input",null,"text"),b.appendChild(Aa),f=g("input","select-colors","button"),f.value="...",f.onclick=be,b.appendChild(f),b=g("p"),b.innerText=d.fromText.replace(":","")+"/"+d.toText,e.appendChild(b),b=g("div","split"),e.appendChild(b),L=g("input"),L.onchange=Mb,b.appendChild(L),la(L,"date"),S=g("input"),b.appendChild(S),la(S,"time"),b=g("div","split"),e.appendChild(b),G=g("input"),G.onchange=Mb,b.appendChild(G),la(G,"date"),T=g("input"),b.appendChild(T),la(T,"time"),fb=H(e,d.isAllDayText,
Mb)[0],b=g("p"),b.innerText=d.repeatsText,e.appendChild(b),b=g("div","radioButtonsContainer"),e.appendChild(b),Ba=U(b,d.repeatsNever,"RepeatType",Na),Nb=U(b,d.repeatsEveryDayText,"RepeatType",Na),Ob=U(b,d.repeatsEveryWeekText,"RepeatType",Na),Pb=U(b,d.repeatsEveryMonthText,"RepeatType",Na),Qb=U(b,d.repeatsEveryYearText,"RepeatType",Na),Oa=g("input","repeat-options","button"),Oa.value="...",Oa.onclick=ce,b.appendChild(Oa),b=g("p"),b.innerText=d.locationText,e.appendChild(b),gb=g("input",null,"text"),
e.appendChild(gb),b=g("p"),b.innerText=d.descriptionText,e.appendChild(b),hb=g("textarea","custom-scroll-bars"),e.appendChild(hb),ib=g("p","error"),e.appendChild(ib),b=g("div","split"),e.appendChild(b),Pa=g("input","ok","button"),Pa.value=d.addText,Pa.onclick=de,b.appendChild(Pa),f=g("input","cancel","button"),f.value=d.cancelText,f.onclick=vc,b.appendChild(f),Qa=g("input","remove","button"),Qa.value=d.removeEventText,Qa.onclick=ee,e.appendChild(Qa),null!==ma&&C(r.body,ma),ma=g("div","calendar-dialog event-editor-colors"),
r.body.appendChild(ma),e=g("div","title-bar"),e.innerHTML=d.selectColorsText,ma.appendChild(e),e=g("div","contents"),ma.appendChild(e),b=g("p"),b.innerText=d.backgroundColorText,e.appendChild(b),Ra=g("input"),e.appendChild(Ra),la(Ra,"color"),b=g("p"),b.innerText=d.textColorText,e.appendChild(b),Sa=g("input"),e.appendChild(Sa),la(Sa,"color"),b=g("p"),b.innerText=d.borderColorText,e.appendChild(b),Ta=g("input"),e.appendChild(Ta),la(Ta,"color"),b=g("div","split"),e.appendChild(b),e=g("input","ok","button"),
e.value=d.okText,e.onclick=fe,b.appendChild(e),e=g("input","cancel","button"),e.value=d.cancelText,e.onclick=Yc,b.appendChild(e),null!==na&&C(r.body,na),na=g("div","calendar-dialog event-editor-repeat-options"),r.body.appendChild(na),e=g("div","title-bar"),e.innerHTML=d.repeatOptionsTitle,na.appendChild(e),e=g("div","contents"),na.appendChild(e),b=g("p"),b.innerText=d.daysToExcludeText,e.appendChild(b),Rb=H(e,d.dayNames[0])[0],Sb=H(e,d.dayNames[1])[0],Tb=H(e,d.dayNames[2])[0],Ub=H(e,d.dayNames[3])[0],
Vb=H(e,d.dayNames[4])[0],Wb=H(e,d.dayNames[5])[0],Xb=H(e,d.dayNames[6])[0],b=g("p"),b.innerText=d.repeatEndsText,e.appendChild(b),Ca=g("input"),e.appendChild(Ca),la(Ca,"date"),b=g("div","split"),e.appendChild(b),e=g("input","ok","button"),e.value=d.okText,e.onclick=ge,b.appendChild(e),e=g("input","cancel","button"),e.value=d.cancelText,e.onclick=Zc,b.appendChild(e),null!==oa&&C(r.body,oa),oa=g("div","calendar-dialog confirmation"),r.body.appendChild(oa),wc=g("div","title-bar"),oa.appendChild(wc),
e=g("div","contents"),oa.appendChild(e),xc=g("div","message"),e.appendChild(xc),b=H(e,d.removeAllEventsInSeriesText),Yb=b[0],yc=b[1],b=g("div","split"),e.appendChild(b),jb=g("input","yes","button"),jb.value=d.yesText,b.appendChild(jb),kb=g("input","no","button"),kb.value=d.noText,b.appendChild(kb),null!==pa&&C(r.body,pa),pa=g("div","calendar-dialog select-export-type"),r.body.appendChild(pa),e=g("div","title-bar"),e.innerHTML=d.selectExportTypeTitle,pa.appendChild(e),b=g("div","contents"),pa.appendChild(b),
e=g("div","radioButtonsContainer"),b.appendChild(e),zc=U(e,"CSV","ExportType"),$c=U(e,"XML","ExportType"),ad=U(e,"JSON","ExportType"),bd=U(e,"TEXT","ExportType"),cd=U(e,"iCAL","ExportType"),e=g("div","split"),b.appendChild(e),b=g("input","ok","button"),b.value=d.okText,b.onclick=he,e.appendChild(b),b=g("input","cancel","button"),b.value=d.cancelText,b.onclick=dd,e.appendChild(b),null!==A&&C(r.body,A),A=g("div","calendar-dialog search"),r.body.appendChild(A),e=g("div","title-bar"),e.innerHTML=d.searchEventsTitle,
e.onmousedown=ie,e.onmouseup=je,A.appendChild(e),b=g("div","ib-close"),b.onclick=ke,e.appendChild(b),p(b,d.closeTooltipText),qa=g("div","ib-minus"),qa.onclick=ed,e.appendChild(qa),p(qa,d.minimizedTooltipText),K=g("div","contents"),A.appendChild(K),e=g("p"),e.innerText=d.forText,K.appendChild(e),V=g("input",null,"text"),V.oninput=Da,V.onpropertychange=Da,V.onkeypress=le,K.appendChild(V),fd=H(K,d.matchCaseText,Da)[0],e=g("p"),e.innerText=d.includeText,K.appendChild(e),e=g("div","checkboxContainer"),
K.appendChild(e),gd=H(e,d.titleText.replace(":",""),Da)[0],hd=H(e,d.locationText.replace(":",""),Da)[0],id=H(e,d.descriptionText.replace(":",""),Da)[0],e=g("div","split"),K.appendChild(e),Ua=g("input","previous","button"),Ua.value=d.previousText,Ua.onclick=me,e.appendChild(Ua),Ea=g("input","next","button"),Ea.value=d.nextText,Ea.onclick=jd,e.appendChild(Ea),r.body.addEventListener("mousemove",ne),null===w&&(w=g("div"),r.body.appendChild(w),Ac=g("div","title"),Zb=g("div","date"),lb=g("div","repeats"),
mb=g("div","description"),nb=g("div","location"),document.body.addEventListener("mousemove",Bc)),oe(),pe());ob.innerHTML=d.monthNames[t.getMonth()]+", "+t.getFullYear()+" \u25be"}function pb(){var a=[];qb(function(c){a.push(c)});return a}function qb(a){for(var c in M)if(M.hasOwnProperty(c))for(var b in M[c])if(M[c].hasOwnProperty(b)){var e=kd(M[c][b]);if(a(e,c,b))return}}function Fa(a,c){c=h(c)?c:!0;a=a.sort(function(b,e){return b.from-e.from});c&&(a=a.sort(function(b,e){return ld(e.isAllDay)-ld(b.isAllDay)}));
return a}function $d(){D=g("div","header-date");B.appendChild(D);d.fullScreenModeEnabled&&(D.ondblclick=ba);var a=g("div","ib-arrow-left-full");a.onclick=Cc;a.ondblclick=q;D.appendChild(a);p(a,d.previousMonthTooltipText);a=g("div","ib-pin");a.onclick=Dc;a.ondblclick=q;D.appendChild(a);p(a,d.todayTooltipText);a=g("div","ib-refresh");a.onclick=$b;a.ondblclick=q;D.appendChild(a);p(a,d.refreshTooltipText);a=g("div","ib-search");a.onclick=md;a.ondblclick=q;D.appendChild(a);p(a,d.searchTooltipText);a=g("div",
"ib-arrow-right-full");a.onclick=Ec;a.ondblclick=q;D.appendChild(a);p(a,d.nextMonthTooltipText);d.manualEditingEnabled&&(a=g("div","ib-plus"),a.onclick=ac,a.ondblclick=q,D.appendChild(a),p(a,d.addEventTooltipText));d.exportEventsEnabled&&(Va=g("div","ib-arrow-down-full-line"),Va.ondblclick=q,D.appendChild(Va),p(Va,d.exportEventsTooltipText),Va.onclick=function(){bc()});a=g("div","ib-eye");a.ondblclick=q;D.appendChild(a);a.onclick=function(){nd(!0)};p(a,d.listAllEventsTooltipText);a=g("div","ib-hamburger");
a.ondblclick=q;D.appendChild(a);a.onclick=function(){rb(null,!0)};p(a,d.listWeekEventsTooltipText);d.fullScreenModeEnabled&&(ca=g("div","ib-arrow-expand-left-right"),ca.ondblclick=q,ca.onclick=ba,D.appendChild(ca),p(ca,d.enableFullScreenTooltipText));a=g("div","title-container");D.appendChild(a);ob=g("span");ob.ondblclick=q;a.appendChild(ob);qe(a)}function qe(a){var c=new Date(1900,1,1),b=(new Date).getFullYear()-c.getFullYear()+d.extraSelectableYearsAhead;N=g("div","years-drop-down");a.appendChild(N);
cc=g("div","contents custom-scroll-bars");N.appendChild(cc);for(a=0;a<b;a++)re(c.getFullYear()),c.setFullYear(c.getFullYear()+1);ob.onclick=se}function re(a){var c=g("div");c.innerText=a.toString();c.id="year-selected-"+a.toString();cc.appendChild(c);c.onclick=function(){t.setFullYear(a);J(t);dc()&&(N.style.display="none")}}function kd(a){a.isAllDay&&(a.from=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),0,0),a.to=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),
23,59));return a}function sb(a,c){var b=new Date(a.getFullYear(),a.getMonth(),a.getDate()),e=new Date(c.getFullYear(),c.getMonth(),c.getDate());return Math.ceil(Math.abs(e-b)/864E5)}function se(a){if("block"!==N.style.display){ya();q(a);a=N.getElementsByClassName("current-year-selected");if(1<=a.length)for(var c=a.length,b=0;b<c;b++)a[b].removeAttribute("class");a=Ma("year-selected-"+t.getFullYear());null!==a&&(a.className="current-year-selected");N.style.display="block";cc.scrollTop=a.offsetTop-
N.offsetHeight/2}}function dc(){return null!==N&&"block"===N.style.display}function ra(a){if(null!==d&&Fc(d[a]))d[a]()}function ec(a,c){if(null!==d&&Fc(d[a]))d[a](c)}function od(){for(var a=[],c=0;32>c;c++){8!==c&&12!==c&&16!==c&&20!==c||a.push("-");var b=Math.floor(16*Math.random()).toString(16);a.push(b)}return a.join("")}function ba(){Wa?pd():qd()}function qd(){!Wa&&d.fullScreenModeEnabled&&(rd=B.style.cssText,Wa=!0,ca.className="ib-arrow-contract-left-right",da.className="ib-arrow-contract-left-right",
ea.className="ib-arrow-contract-left-right",fa.className="ib-arrow-contract-left-right",p(ca,d.disableFullScreenTooltipText),p(da,d.disableFullScreenTooltipText),p(ea,d.disableFullScreenTooltipText),p(fa,d.disableFullScreenTooltipText),B.className+=" full-screen-view",B.removeAttribute("style"))}function pd(){Wa&&d.fullScreenModeEnabled&&(Wa=!1,ca.className="ib-arrow-expand-left-right",da.className="ib-arrow-expand-left-right",ea.className="ib-arrow-expand-left-right",fa.className="ib-arrow-expand-left-right",
p(ca,d.enableFullScreenTooltipText),p(da,d.enableFullScreenTooltipText),p(ea,d.enableFullScreenTooltipText),p(fa,d.enableFullScreenTooltipText),B.className=B.className.replace(" full-screen-view",""),B.style.cssText=rd)}function ae(){sd||(r.body.addEventListener("click",ya),r.body.addEventListener("contextmenu",ya),Ga.addEventListener("resize",ya),Ga.addEventListener("resize",td),r.addEventListener("keydown",function(a){Wa&&ud()&&(37===a.keyCode&&(a.ctrlKey||a.metaKey)?(a.preventDefault(),vd()):39===
a.keyCode&&(a.ctrlKey||a.metaKey)?(a.preventDefault(),wd()):70===a.keyCode&&(a.ctrlKey||a.metaKey)?(a.preventDefault(),md()):27===a.keyCode?ba():37===a.keyCode?Cc():39===a.keyCode?Ec():40===a.keyCode?Dc():116===a.keyCode&&$b())}),sd=!0)}function ya(){Gc()&&(I.style.display="none");Hc()&&(O.style.display="none");dc()&&(N.style.display="none");Bc()}function fc(a,c){return a.getDate()===c.getDate()&&a.getMonth()===c.getMonth()&&a.getFullYear()===c.getFullYear()}function Ic(a,c){var b=new Date(a.getFullYear(),
a.getMonth(),a.getDate());b.setHours(0,0,0,0);var e=new Date(c.getFullYear(),c.getMonth(),c.getDate());e.setHours(0,0,0,0);return b<=e}function tb(a,c){var b=null;if(h(a)){b=("0"+a.getDate()).slice(-2);var e=("0"+(a.getMonth()+1)).slice(-2);b="date"===c?a.getFullYear()+"-"+e+"-"+b:b+"/"+e+"/"+a.getFullYear()}return b}function Xa(a){var c=("0"+a.getDate()).slice(-2),b=("0"+a.getMonth()).slice(-2);return c+"/"+b+"/"+a.getFullYear()}function gc(a){return E(a.getHours())+":"+E(a.getMinutes())}function Jc(a){return 0>
a.getDay()-1?6:a.getDay()-1}function te(a){a=h(a)?a:new Date;var c=0===a.getDay()?7:a.getDay();c=a.getDate()-c+1;var b=c+6,e=new Date(a);a=new Date(a);e.setDate(c);e.setHours(0,0,0,0);a.setDate(b);a.setHours(23,59,59,99);return[e,a]}function ja(){ue();xd();for(var a=Fa(pb()),c=a.length,b=0;b<c;b++){var e=a[b];null!==hc(e.from)&&ve(e);var f=W(e.repeatEvery);0<f&&(1===f?ic(e,function(k){k.setDate(k.getDate()+1)}):2===f?ic(e,function(k){k.setDate(k.getDate()+7)}):3===f?ic(e,function(k){k.setMonth(k.getMonth()+
1)}):4===f&&ic(e,function(k){k.setFullYear(k.getFullYear()+1)}))}d.exportEventsEnabled&&(Va.style.display=0===c?"none":"inline-block");yd()}function ic(a,c){for(var b=new Date(a.from),e=X(a.repeatEveryExcludeDays),f=X(a.seriesIgnoreDates);b<uc;){c(b);var k=Xa(b),l=!(!h(a.repeatEnds)||Ic(b,a.repeatEnds));-1!==e.indexOf(b.getDay())||-1!==f.indexOf(k)||l||null!==hc(b)&&Kc(b,a)}}function ve(a){Kc(a.from,a);if(a.from.getDate()!==a.to.getDate()){var c=sb(a.from,a.to);if(0<c)for(var b=new Date(a.from),e=
0;e<c;e++)b.setDate(b.getDate()+1),null!==hc(b)&&Kc(b,a)}}function Kc(a,c){var b=hc(a);if(null!==b){var e=d.manualEditingEnabled?"event":"event-no-hover";if(b.getElementsByClassName(e).length<d.maximumEventsPerDayDisplay||0>=d.maximumEventsPerDayDisplay){e=g("div",e);var f=c.title;d.showTimesInMainCalendarEvents&&!c.isAllDay&&c.from.getDate()===c.to.getDate()&&(f=ub(c.from,c.to)+": "+f);e.innerHTML=f;b.appendChild(e);jc(c,e,Lc(c,a));e.onmousemove=function(m){zd(m,c)};if(d.manualEditingEnabled){var k=
Xa(a);e.oncontextmenu=function(m){kc(m,c,k)}}d.manualEditingEnabled&&(e.onclick=function(){sa(c)});d.dragAndDropForEventsEnabled&&d.manualEditingEnabled&&(e.setAttribute("draggable",!0),e.ondragstart=function(){x=c})}else if(e=b.getElementsByClassName("plus-x-events"),e=0<e.length?e[0]:null,null===e){var l=new Date(a);e=g("div","plus-x-events");e.setAttribute("events","1");e.innerHTML="+1 "+d.moreText;e.ondblclick=q;b.appendChild(e);e.onclick=function(){Ha(l,!0)}}else b=parseInt(e.getAttribute("events"))+
1,e.setAttribute("events",b.toString()),e.innerHTML="+"+b+" "+d.moreText}}function hc(a){var c=new Date(t.getFullYear(),t.getMonth(),1);var b=new Date(t);var e=new Date(t),f=null,k=0;c=Jc(c);b.setMonth(b.getMonth()+1);e.setMonth(e.getMonth()-1);a.getMonth()===b.getMonth()&&a.getFullYear()===b.getFullYear()?(b=c+Jb(t.getFullYear(),t.getMonth()),k=a.getDate()+b):a.getMonth()===e.getMonth()&&a.getFullYear()===e.getFullYear()?k=c-sb(a,t)+1:a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear()&&
(b=c,k=a.getDate()+b);0<k&&(f=Ma("calendar-day-"+k));return f}function ue(){for(var a=0;6>a;a++)for(var c=0;7>c;c++){var b=Ma("calendar-day-"+(7*a+(c+1)));Mc(b,d.manualEditingEnabled?"event":"event-no-hover");Mc(b,"plus-x-events")}}function Mc(a,c){for(var b=a.getElementsByClassName(c);b[0];)b[0].parentNode.removeChild(b[0])}function jc(a,c,b){h(b)&&b<new Date&&(c.className+=" expired");P(a.color)?(c.style.backgroundColor=a.color,P(a.colorText)&&(c.style.color=a.colorText),P(a.colorBorder)&&(c.style.borderLeftColor=
a.colorBorder)):a.isAllDay&&(c.className+=" all-day")}function Lc(a,c){var b=W(a.repeatEvery),e=new Date(a.to);0<b&&(b=new Date(c),b.setHours(e.getHours(),e.getMinutes()),e=b);return e}function Zd(){Ia=g("div","full-day-view");B.appendChild(Ia);var a=g("div","title-bar");Ia.appendChild(a);d.fullScreenModeEnabled&&(a.ondblclick=ba);vb=g("div","title");a.appendChild(vb);var c=g("div","ib-close");c.ondblclick=q;a.appendChild(c);p(c,d.closeTooltipText);c.onclick=function(){lc(Ia);Y=null};d.manualEditingEnabled&&
(c=g("div","ib-plus"),c.onclick=ac,c.ondblclick=q,a.appendChild(c),p(c,d.addEventTooltipText));c=g("div","ib-arrow-right-full");c.onclick=we;c.ondblclick=q;a.appendChild(c);p(c,d.nextDayTooltipText);c=g("div","ib-arrow-left-full");c.onclick=xe;c.ondblclick=q;a.appendChild(c);p(c,d.previousDayTooltipText);d.exportEventsEnabled&&(Ya=g("div","ib-arrow-down-full-line"),Ya.ondblclick=q,a.appendChild(Ya),p(Ya,d.exportEventsTooltipText),Ya.onclick=function(){bc(Nc)});d.fullScreenModeEnabled&&(da=g("div",
"ib-arrow-expand-left-right"),da.ondblclick=q,da.onclick=ba,a.appendChild(da),p(da,d.enableFullScreenTooltipText));ha=g("div","contents custom-scroll-bars");Ia.appendChild(ha);Ja=g("div","content-events-all-day");ha.appendChild(Ja);a=g("div","all-day-text");a.innerHTML=d.allDayText;Ja.appendChild(a);wb=g("div","contents-events");ha.appendChild(wb);for(a=0;24>a;a++){c=g("div","hour");wb.appendChild(c);var b=g("div","hour-text");b.innerHTML=E(a)+":00";c.appendChild(b);b=g("div","hour-text");b.innerHTML=
E(a)+":30";c.appendChild(b)}}function Ha(a,c){c=h(c)?c:!1;vb.innerText="";Y=new Date(a);Nc=[];Ja.style.display="block";Mc(ha,d.manualEditingEnabled?"event":"event-no-hover");Oc(Ia);Ka(vb,a,!1,!0,!0);var b=Ad(a),e=[];if(null!==b){var f=g("span","holiday");f.innerText=" ("+b+")";vb.appendChild(f)}qb(function(m){for(var n=sb(m.from,m.to)+1,u=new Date(m.from),Z=0;Z<n;Z++){if(fc(u,a)){e.push(m);break}u.setDate(u.getDate()+1)}n=W(m.repeatEvery);0<n&&(1===n?mc(m,e,a,function(y){y.setDate(y.getDate()+1)}):
2===n?mc(m,e,a,function(y){y.setDate(y.getDate()+7)}):3===n?mc(m,e,a,function(y){y.setMonth(y.getMonth()+1)}):4===n&&mc(m,e,a,function(y){y.setFullYear(y.getFullYear()+1)}))});e=Fa(e);b=e.length;f=null;for(var k=0;k<b;k++){var l=ye(e[k],a);null===f&&(f=l)}c&&(ha.scrollTop=f-ha.offsetHeight/2);1>=Ja.offsetHeight&&(Ja.style.display="none");d.exportEventsEnabled&&(Ya.style.display=0===e.length?"none":"inline-block")}function mc(a,c,b,e){for(var f=new Date(a.from),k=X(a.repeatEveryExcludeDays),l=X(a.seriesIgnoreDates);f<
b;){e(f);var m=Xa(f),n=!(!h(a.repeatEnds)||Ic(f,a.repeatEnds));if(-1===k.indexOf(f.getDay())&&-1===l.indexOf(m)&&!n&&fc(f,b)){c.push(a);break}}}function ye(a,c){var b=g("div",d.manualEditingEnabled?"event":"event-no-hover");a.isAllDay?Ja.appendChild(b):wb.appendChild(b);if(d.manualEditingEnabled){var e=Xa(c);b.oncontextmenu=function(k){kc(k,a,e)}}jc(a,b,Lc(a,c));var f=g("div","title");f.innerHTML=a.title;b.appendChild(f);f=g("div","date");b.appendChild(f);a.from.getDate()===a.to.getDate()?f.innerHTML=
a.isAllDay?d.allDayText:ub(a.from,a.to):nc(f,a.from,a.to);xb(a.repeatEvery)&&0<a.repeatEvery&&(f=g("div","repeats"),f.innerHTML=d.repeatsText.replace(":","")+" "+Za(a.repeatEvery),b.appendChild(f));P(a.location)&&(f=g("div","location"),f.innerHTML=a.location,b.appendChild(f));P(a.description)&&(f=g("div","description"),f.innerHTML=a.description,b.appendChild(f));d.manualEditingEnabled&&(b.onclick=function(){sa(a)});f=0;a.isAllDay||(f=ze(c,b,a));return f}function ze(a,c,b){var e=wb.offsetHeight,f=
e/1440,k=d.spacing,l=null;Nc.push(b);if(!b.isAllDay){l=W(b.repeatEvery);if(fc(b.from,a)||0<l)k=f*Bd(b.from);l=fc(b.to,a)?f*Bd(b.to)-k:e;l-=2*d.spacing}c.style.top=k+"px";null!==l&&(c.style.height=l+"px");c.offsetTop+c.offsetHeight>e-d.spacing&&(c.style.height=e-c.offsetTop-3*d.spacing+"px");a=k+ha.offsetHeight/2;a<=ha.offsetHeight&&(a=0);return a}function Bd(a){var c=a.getHours();a=a.getMinutes();return 60*c+a}function xe(){Y.setDate(Y.getDate()-1);Ha(Y,!0)}function we(){Y.setDate(Y.getDate()+1);
Ha(Y,!0)}function Xd(){ta=g("div","list-all-events-view");B.appendChild(ta);var a=g("div","title-bar");ta.appendChild(a);d.fullScreenModeEnabled&&(a.ondblclick=ba);var c=g("div","title");c.innerHTML=d.allEventsText;a.appendChild(c);c=g("div","ib-close");c.ondblclick=q;a.appendChild(c);p(c,d.closeTooltipText);c.onclick=function(){lc(ta)};d.manualEditingEnabled&&(c=g("div","ib-plus"),c.onclick=ac,c.ondblclick=q,a.appendChild(c),p(c,d.addEventTooltipText));d.exportEventsEnabled&&(yb=g("div","ib-arrow-down-full-line"),
yb.ondblclick=q,a.appendChild(yb),p(yb,d.exportEventsTooltipText),yb.onclick=function(){bc()});d.fullScreenModeEnabled&&(ea=g("div","ib-arrow-expand-left-right"),ea.ondblclick=q,ea.onclick=ba,a.appendChild(ea),p(ea,d.enableFullScreenTooltipText));zb=g("div","contents custom-scroll-bars");ta.appendChild(zb)}function nd(a){a=h(a)?a:!1;Oc(ta);zb.innerHTML="";a&&(zb.scrollTop=0);a=Fa(pb());for(var c=a.length,b=0;b<c;b++){var e=a[b],f=Ae(e.from);Be(e,f)}}function Be(a,c){var b=g("div",d.manualEditingEnabled?
"event":"event-no-hover");c.appendChild(b);d.manualEditingEnabled&&(b.oncontextmenu=function(f){kc(f,a)});jc(a,b);var e=g("div","title");e.innerHTML=a.title;b.appendChild(e);e=g("div","date");b.appendChild(e);a.from.getDate()===a.to.getDate()?a.isAllDay?oc(e,a.from,null," - "+d.allDayText):oc(e,a.from,null," - "+ub(a.from,a.to)):nc(e,a.from,a.to);xb(a.repeatEvery)&&0<a.repeatEvery&&(e=g("div","repeats"),e.innerHTML=d.repeatsText.replace(":","")+" "+Za(a.repeatEvery),b.appendChild(e));P(a.location)&&
(e=g("div","location"),e.innerHTML=a.location,b.appendChild(e));P(a.description)&&(e=g("div","description"),e.innerHTML=a.description,b.appendChild(e));d.manualEditingEnabled&&(b.onclick=function(){sa(a)})}function Ae(a){var c="month-"+a.getMonth()+"-"+a.getFullYear(),b=Ma(c),e=new Date(a);if(null===b){var f=g("div","month");zb.appendChild(f);b=g("div","header");b.innerHTML=d.monthNames[a.getMonth()]+" "+a.getFullYear();f.appendChild(b);a=g("div","ib-arrow-expand-left-right");a.ondblclick=q;b.appendChild(a);
a.onclick=function(){lc(ta);J(e)};p(a,d.expandMonthTooltipText);b=g("div","events");b.id=c;f.appendChild(b)}return b}function Yd(){La=g("div","list-all-week-events-view");B.appendChild(La);var a=g("div","title-bar");La.appendChild(a);d.fullScreenModeEnabled&&(a.ondblclick=ba);aa=g("div","title");a.appendChild(aa);var c=g("div","ib-close");c.ondblclick=q;a.appendChild(c);p(c,d.closeTooltipText);c.onclick=function(){lc(La)};d.manualEditingEnabled&&(c=g("div","ib-plus"),c.onclick=ac,c.ondblclick=q,a.appendChild(c),
p(c,d.addEventTooltipText));c=g("div","ib-arrow-right-full");c.onclick=Ce;c.ondblclick=q;a.appendChild(c);p(c,d.nextWeekTooltipText);c=g("div","ib-arrow-left-full");c.onclick=De;c.ondblclick=q;a.appendChild(c);p(c,d.previousWeekTooltipText);d.exportEventsEnabled&&($a=g("div","ib-arrow-down-full-line"),$a.ondblclick=q,a.appendChild($a),p($a,d.exportEventsTooltipText),$a.onclick=function(){bc(Ab)});d.fullScreenModeEnabled&&(fa=g("div","ib-arrow-expand-left-right"),fa.ondblclick=q,fa.onclick=ba,a.appendChild(fa),
p(fa,d.enableFullScreenTooltipText));Bb=g("div","contents custom-scroll-bars");La.appendChild(Bb)}function rb(a,c){c=h(c)?c:!1;Oc(La);Bb.innerHTML="";ab={};Pc={};Ab=[];ua=null===a?new Date:new Date(a);c&&(Bb.scrollTop=0);var b=te(a),e=b[0];b=b[1];Ee(e,b);for(var f=Fa(pb()),k=f.length,l=0;l<k;l++){for(var m=f[l],n=sb(m.from,m.to)+1,u=new Date(m.from),Z=!1,y=0;y<n;y++)u>=e&&u<=b&&(Z=Cd(u),Dd(m,Z,u),Z=!0),u.setDate(u.getDate()+1);Z&&Ab.push(m);n=W(m.repeatEvery);u=!1;0<n&&(1===n?u=pc(m,e,b,function(Q){Q.setDate(Q.getDate()+
1)}):2===n?u=pc(m,e,b,function(Q){Q.setDate(Q.getDate()+7)}):3===n?u=pc(m,e,b,function(Q){Q.setMonth(Q.getMonth()+1)}):4===n&&(u=pc(m,e,b,function(Q){Q.setFullYear(Q.getFullYear()+1)})));u&&!Z&&Ab.push(m)}for(var Ed in ab)ab.hasOwnProperty(Ed)&&Bb.appendChild(ab[Ed]);d.exportEventsEnabled&&($a.style.display=0===Ab.length?"none":"inline-block")}function pc(a,c,b,e){for(var f=new Date(a.from),k=X(a.repeatEveryExcludeDays),l=X(a.seriesIgnoreDates),m=!1;f<b;){e(f);var n=Xa(f),u=!(!h(a.repeatEnds)||Ic(f,
a.repeatEnds));-1===k.indexOf(f.getDay())&&-1===l.indexOf(n)&&!u&&f>=c&&f<=b&&(m=Cd(f),Dd(a,m,f),m=!0)}return m}function Ee(a,c){aa.innerHTML="";if(a.getFullYear()===c.getFullYear()){Ka(aa,a,!1,!1);var b=g("span");b.innerHTML=" - ";aa.appendChild(b);Ka(aa,c,!1,!1);b=g("span");b.innerHTML=", "+a.getFullYear();aa.appendChild(b)}else Ka(aa,a,!1,!0),b=g("span"),b.innerHTML=" - ",aa.appendChild(b),Ka(aa,c,!1,!0)}function Dd(a,c,b){var e=g("div",d.manualEditingEnabled?"event":"event-no-hover");c.appendChild(e);
if(d.manualEditingEnabled){var f=Xa(b);e.oncontextmenu=function(k){kc(k,a,f)}}jc(a,e,Lc(a,b));c=g("div","title");c.innerHTML=a.title;e.appendChild(c);c=g("div","date");e.appendChild(c);a.from.getDate()===a.to.getDate()?c.innerHTML=a.isAllDay?d.allDayText:ub(a.from,a.to):nc(c,a.from,a.to);xb(a.repeatEvery)&&0<a.repeatEvery&&(c=g("div","repeats"),c.innerHTML=d.repeatsText.replace(":","")+" "+Za(a.repeatEvery),e.appendChild(c));P(a.location)&&(c=g("div","location"),c.innerHTML=a.location,e.appendChild(c));
P(a.description)&&(c=g("div","description"),c.innerHTML=a.description,e.appendChild(c));d.manualEditingEnabled&&(e.onclick=function(){sa(a)})}function Cd(a){var c=Jc(a),b=a.getFullYear()+a.getMonth()+c,e=null,f=new Date(a);if(ab.hasOwnProperty(b))e=Pc[b];else{var k=g("div","day");ab[b]=k;e=g("div","header");k.appendChild(e);oc(e,a,d.dayNames[c]+", ");a=g("div","ib-arrow-expand-left-right");a.ondblclick=q;e.appendChild(a);a.onclick=function(){Ha(f,!0)};p(a,d.expandDayTooltipText);e=g("div","events");
k.appendChild(e);Pc[b]=e}return e}function De(){ua.setDate(ua.getDate()-7);rb(ua,!0)}function Ce(){ua.setDate(ua.getDate()+7);rb(ua,!0)}function ub(a,c){return Qc(a)+" "+d.toTimeText+" "+Qc(c)}function Qc(a){return E(a.getHours())+":"+E(a.getMinutes())}function nc(a,c,b){a.innerHTML="";var e=g("span");e.innerText=d.startsOnText+" ";a.appendChild(e);Ka(a,c);c=g("span");c.innerText=" "+d.andFinishesOnText+" ";a.appendChild(c);Ka(a,b)}function Ka(a,c,b,e,f){b=h(b)?b:!0;e=h(e)?e:!0;if(f=h(f)?f:!1){f=
Jc(c);var k=g("span");k.innerText=d.dayNames[f]+", ";a.appendChild(k)}oc(a,c);f=g("span");f.innerText=" "+d.monthNames[c.getMonth()];a.appendChild(f);e&&(e=g("span"),e.innerText=" "+c.getFullYear(),a.appendChild(e));b&&(b=g("span"),b.innerText=" "+Qc(c),a.appendChild(b))}function oc(a,c,b,e){if(h(b)){var f=g("span");f.innerText=b;a.appendChild(f)}b=g("span");b.innerText=c.getDate();a.appendChild(b);d.showDayNumberOrdinals&&(b=g("sup"),b.innerText=Fd(c.getDate()),a.appendChild(b));h(e)&&(c=g("span"),
c.innerText=e,a.appendChild(c))}function tc(a,c,b,e,f){var k=new Date;k=a===k.getDate()&&e===k.getFullYear()&&b===k.getMonth();var l=Ma("calendar-day-"+c);c=g("span");var m=new Date(e,b,a);l.innerHTML="";c.className=f?"day-muted":"";c.className+=k?" today":"";c.innerText=a;if(6===m.getDay()||0===m.getDay()&&"cell"===l.className)l.className="cell weekend-day";l.oncontextmenu=function(u){qc=new Date(m);ya();q(u);Rc(u,I)};d.showDayNumberOrdinals&&(f=g("sup"),f.innerText=Fd(a),c.appendChild(f));l.appendChild(c);
f=g("div","ib-arrow-top-right");l.appendChild(f);p(f,d.expandDayTooltipText);k=Ad(m);if(null!==k){var n=g("span","holiday");n.innerText=k;c.appendChild(n)}f.onclick=function(){Ha(m,!0)};d.manualEditingEnabled&&(l.ondblclick=function(){sa(null,m)},d.dragAndDropForEventsEnabled&&(l.ondragover=function(u){q(u);Gd(l)},l.ondragenter=function(u){q(u);Gd(l)},l.ondragleave=function(u){q(u);Hd(l)},l.ondrop=function(u){q(u);if(null!==x){u=sb(x.from,x.to);var Z=new Date(e,b,a,x.from.getHours(),x.from.getMinutes()),
y=new Date(e,b,a,x.to.getHours(),x.to.getMinutes());0<u&&y.setDate(y.getDate()+u);Cb.updateEvent(x.id,{from:Z,to:y,title:x.title,description:x.description,location:x.location,isAllDay:x.isAllDay,color:x.color,colorText:x.colorText,colorBorder:x.colorBorder,repeatEvery:x.repeatEvery,repeatEveryExcludeDays:x.repeatEveryExcludeDays})}Hd(l)}))}function Gd(a){-1===a.className.indexOf(" drag-over")&&(a.className+=" drag-over")}function Hd(a){-1<a.className.indexOf(" drag-over")&&(a.className=a.className.replace(" drag-over",
""))}function Jb(a,c){return(new Date(a,c+1,0)).getDate()}function Fd(a){var c=d.thText;if(31===a||21===a||1===a)c=d.stText;else if(22===a||2===a)c=d.ndText;else if(23===a||3===a)c=d.rdText;return c}function Ad(a){for(var c=null,b=[],e=d.holidays.length,f=0;f<e;f++){var k=d.holidays[f];W(k.day)===a.getDate()&&W(k.month)===a.getMonth()+1&&(k=v(k.title,null),null!==k&&b.push(k))}0<b.length&&(c=b.join(", "));return c}function oe(){null!==I&&C(r.body,I);I=g("div","calendar-drop-down-menu");r.body.appendChild(I);
if(d.manualEditingEnabled){var a=g("div","item");a.innerHTML=d.addEventTitle;I.appendChild(a);a.onclick=function(){sa(null,qc)};a=g("div","separator");I.appendChild(a)}a=g("div","item");a.innerHTML=d.expandDayTooltipText;I.appendChild(a);a.onclick=function(){Ha(qc,!0)};a=g("div","separator");I.appendChild(a);a=g("div","item");a.innerHTML=d.listWeekEventsTooltipText;I.appendChild(a);a.onclick=function(){rb(qc,!0)}}function pe(){null!==O&&C(r.body,O);if(d.manualEditingEnabled){O=g("div","calendar-drop-down-menu");
r.body.appendChild(O);var a=g("div","item");a.innerHTML=d.removeEventText;O.appendChild(a);a.onclick=function(){bb(r.body,R);var c=function(){C(r.body,R)},b=0<W(va.repeatEvery)&&null!==Db;Id(d.confirmEventRemoveTitle,d.confirmEventRemoveMessage,function(){c();h(va.id)&&(Yb.checked||null===Db?Cb.removeEvent(va.id,!0):(Sc(va.seriesIgnoreDates)?va.seriesIgnoreDates.push(Db):va.seriesIgnoreDates=[Db],ja()),rc())},c,b)};a=g("div","separator");O.appendChild(a);a=g("div","item");a.innerHTML=d.editEventTitle;
O.appendChild(a);a.onclick=function(){sa(va)}}}function kc(a,c,b){va=c;Db=h(b)?b:null;ya();q(a);Rc(a,O)}function Gc(){return null!==I&&"block"===I.style.display}function Hc(){return null!==O&&"block"===O.style.display}function la(a,c){try{a.type=c}catch(b){a.type="text"}}function ac(){sa(null,Y)}function Na(){Oa.disabled=Ba.checked}function Mb(){var a=!1;fb.checked&&(G.value=L.value,S.value="00:00",T.value="23:59",a=!0);G.disabled=a;S.disabled=a;T.disabled=a;a=Eb(L);var c=Eb(G);c>a||c<a?(a=!0,Ba.checked=
!0):a=!1;Ba.disabled=a;Nb.disabled=a;Ob.disabled=a;Pb.disabled=a;Qb.disabled=a;Oa.disabled=a;Na()}function sa(a,c){bb(r.body,R);if(h(a)){Pa.value=d.updateText;Qa.style.display="block";Lb.innerHTML=d.editEventTitle;F=a;L.value=tb(a.from,L.type);S.value=gc(a.from);G.value=tb(a.to,G.type);T.value=gc(a.to);fb.checked=a.isAllDay;Aa.value=v(a.title);hb.value=v(a.description);gb.value=v(a.location);Ra.value=v(a.color,"#484848");Sa.value=v(a.colorText,"#F5F5F5");Ta.value=v(a.colorBorder,"#282828");var b=
W(a.repeatEvery);0===b?Ba.checked=!0:1===b?Nb.checked=!0:2===b?Ob.checked=!0:3===b?Pb.checked=!0:4===b&&(Qb.checked=!0);b=X(a.repeatEveryExcludeDays);Rb.checked=-1<b.indexOf(1);Sb.checked=-1<b.indexOf(2);Tb.checked=-1<b.indexOf(3);Ub.checked=-1<b.indexOf(4);Vb.checked=-1<b.indexOf(5);Wb.checked=-1<b.indexOf(6);Xb.checked=-1<b.indexOf(0);Ca.value=tb(a.repeatEnds,Ca.type)}else{b=new Date;var e=h(c)?c:b,f=new Date;e.getDate()===f.getDate()&&e.getFullYear()===f.getFullYear()&&e.getMonth()===f.getMonth()&&
(e.setHours(b.getHours()),e.setMinutes(b.getMinutes()));Pa.value=d.addText;Qa.style.display="none";Lb.innerHTML=d.addEventTitle;F={};L.value=tb(e,L.type);S.value=gc(e);G.value=tb(e,G.type);T.value=gc(e);fb.checked=!1;Aa.value="";hb.value="";gb.value="";Ra.value="#484848";Sa.value="#F5F5F5";Ta.value="#282828";Ba.checked=!0;Rb.checked=!1;Sb.checked=!1;Tb.checked=!1;Ub.checked=!1;Vb.checked=!1;Wb.checked=!1;Xb.checked=!1;Ca.value=null}Mb();za.style.display="block";ib.style.display="none";Aa.focus()}
function de(){var a=Eb(L),c=Eb(G),b=S.value.split(":"),e=T.value.split(":"),f=Tc(Aa.value),k=Tc(hb.value),l=Tc(gb.value),m=Eb(Ca,null);2>b.length?sc(d.fromTimeErrorMessage,S):2>e.length?sc(d.toTimeErrorMessage,T):""===f?sc(d.titleErrorMessage,Aa):(Jd(a,S.value),Jd(c,T.value),c<a?sc(d.toSmallerThanFromErrorMessage,G):(vc(),b=h(F.id),a={from:a,to:c,title:f,description:k,location:l,isAllDay:fb.checked,color:F.color,colorText:F.colorText,colorBorder:F.colorBorder,repeatEveryExcludeDays:F.repeatEveryExcludeDays,
repeatEnds:m},Ba.checked?a.repeatEvery=0:Nb.checked?a.repeatEvery=1:Ob.checked?a.repeatEvery=2:Pb.checked?a.repeatEvery=3:Qb.checked&&(a.repeatEvery=4),b||(a.organizerName=d.organizerName,a.organizerEmailAddress=d.organizerEmailAddress),b?Cb.updateEvent(F.id,a,!1):Cb.addEvent(a,!1),ja(),rc()))}function Jd(a,c){var b=0,e=0,f=c.split(":");if(2===f.length){var k=parseInt(f[0]);f=parseInt(f[1]);!isNaN(k)&&2>=k.toString().length&&(b=k);!isNaN(f)&&2>=f.toString().length&&(e=f)}a.setHours(b);a.setMinutes(e)}
function Eb(a,c){var b=void 0!==c?c:new Date;if(""!==a.value)if("date"===a.type)b=new Date(a.value);else{var e=a.value.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);e&&(e=new Date(e[3],e[2]-1,e[1]),e instanceof Date&&!isNaN(e)&&(b=e))}return b}function vc(){za.style.display="none";C(r.body,R)}function ee(){ka.style.display="block";var a=function(){ka.style.display="none"};Id(d.confirmEventRemoveTitle,d.confirmEventRemoveMessage,function(){a();vc();h(F.id)&&(Cb.removeEvent(F.id,!0),rc())},a)}function E(a){a=
a.toString();return 1===a.length?"0"+a:a}function sc(a,c){ib.innerHTML=a;ib.style.display="block";c.focus()}function Tc(a){return a.replace(/^\s+|\s+$/g,"")}function rc(){Fb(Ia)&&Ha(Y);Fb(ta)&&nd();Fb(La)&&rb(ua)}function fe(){Yc();F.color=Ra.value;F.colorText=Sa.value;F.colorBorder=Ta.value}function Yc(){ma.style.display="none";ka.style.display="none"}function be(){ma.style.display="block";ka.style.display="block"}function ge(){Zc();var a=[];Rb.checked&&a.push(1);Sb.checked&&a.push(2);Tb.checked&&
a.push(3);Ub.checked&&a.push(4);Vb.checked&&a.push(5);Wb.checked&&a.push(6);Xb.checked&&a.push(0);F.repeatEveryExcludeDays=a}function Zc(){na.style.display="none";ka.style.display="none"}function ce(){na.style.display="block";ka.style.display="block"}function Id(a,c,b,e,f){f=h(f)?f:!1;oa.style.display="block";wc.innerHTML=a;xc.innerHTML=c;jb.onclick=Kd;kb.onclick=Kd;jb.addEventListener("click",b);f?(yc.style.display="block",Yb.checked=!1):(yc.style.display="none",Yb.checked=!0);Fc(e)&&kb.addEventListener("click",
e)}function Kd(){oa.style.display="none"}function bc(a){bb(r.body,R);pa.style.display="block";cb=a;zc.checked=!0}function dd(){C(r.body,R);pa.style.display="none"}function he(){dd();zc.checked?db(cb,"csv"):$c.checked?db(cb,"xml"):ad.checked?db(cb,"json"):bd.checked?db(cb,"text"):cd.checked&&db(cb,"ical")}function ie(a){Gb||(Gb=!0,Ld=a.pageX-A.offsetLeft,Md=a.pageY-A.offsetTop)}function ne(a){Gb&&(A.style.left=a.pageX-Ld+"px",A.style.top=a.pageY-Md+"px")}function je(){Gb&&(Gb=!1,Nd=!0)}function Da(){Ua.disabled=
!0;Ea.disabled=""===V.value;ia=[];wa=0}function md(){"block"!==A.style.display&&(ia=[],A.style.display="block",V.value="",td(),Da());"block"!==K.style.display&&ed();V.focus()}function td(){Nd||(A.style.left=Ga.innerWidth/2-A.offsetWidth/2+"px",A.style.top=Ga.innerHeight/2-A.offsetHeight/2+"px")}function ke(){A.style.display="none"}function ed(){"block"===K.style.display?(K.style.display="none",qa.className="ib-square-hollow",p(qa,d.restoreTooltipText)):(K.style.display="block",qa.className="ib-minus",
p(qa,d.minimizedTooltipText))}function me(){0<wa&&(wa--,Od(),J(ia[wa].from))}function le(a){13!==a.keyCode||Ea.disabled||jd()}function jd(){if(0===ia.length){var a=fd.checked,c=a?V.value:V.value.toLowerCase(),b={};qb(function(e){var f=v(e.title),k=v(e.location),l=v(e.description),m=!1;a||(f=f.toLowerCase(),l=l.toLowerCase(),k=k.toLowerCase());gd.checked&&-1<f.indexOf(c)?m=!0:hd.checked&&-1<k.indexOf(c)?m=!0:id.checked&&-1<l.indexOf(c)&&(m=!0);m&&(f=e.from.getMonth()+"-"+e.from.getFullYear(),b.hasOwnProperty(f)||
(ia.push(e),b[f]=!0))})}else wa++;Od();0<ia.length&&J(ia[wa].from)}function Od(){Ua.disabled=0===wa;Ea.disabled=wa===ia.length-1||0===ia.length}function zd(a,c,b){q(a);null!==xa&&(clearTimeout(xa),xa=null);Bc();"block"!==w.style.display&&(xa=setTimeout(function(){r.body.contains(R)||dc()||Gc()||Hc()||(b=h(b)?b:"",w.className=""===b?"calendar-tooltip-event":"calendar-tooltip",""!==b?w.innerHTML=b:(w.innerHTML="",w.appendChild(Ac),w.appendChild(Zb),Ac.innerHTML=c.title,xb(c.repeatEvery)&&0<c.repeatEvery?
(lb.innerHTML=d.repeatsText.replace(":","")+" "+Za(c.repeatEvery),bb(w,lb)):(lb.innerHTML="",C(w,lb)),P(c.location)?(nb.innerHTML=c.location,bb(w,nb)):(nb.innerHTML="",C(w,nb)),P(c.description)?(mb.innerHTML=c.description,bb(w,mb)):(mb.innerHTML="",C(w,mb)),c.from.getDate()===c.to.getDate()?Zb.innerHTML=c.isAllDay?d.allDayText:ub(c.from,c.to):nc(Zb,c.from,c.to)),Rc(a,w))},d.eventTooltipDelay))}function Bc(){null!==xa&&(clearTimeout(xa),xa=null);Pd()&&(w.style.display="none")}function Pd(){return null!==
xa||null!==w&&"block"===w.style.display}function p(a,c){a.onmousemove=function(b){zd(b,null,c)}}function yd(){null===Hb&&0<d.autoRefreshTimerDelay&&(Hb=setInterval(function(){$b()},d.autoRefreshTimerDelay))}function xd(){null!==Hb&&0<d.autoRefreshTimerDelay&&(clearTimeout(Hb),Hb=null)}function $b(){ud()&&(rc(),ja())}function ud(){return!Pd()&&!r.body.contains(R)&&!dc()&&!Gc()&&!Hc()}function Oc(a){Fb(a)||(a.className+=" overlay-shown")}function lc(a){Fb(a)&&(a.className=a.className.replace(" overlay-shown",
""))}function Fb(a){return-1<a.className.indexOf("overlay-shown")}function g(a,c,b){a=a.toLowerCase();var e="text"===a;Uc.hasOwnProperty(a)||(Uc[a]=e?r.createTextNode(""):r.createElement(a));a=Uc[a].cloneNode(!1);h(c)&&(a.className=c);h(b)&&(a.type=b);return a}function Ma(a){eb.hasOwnProperty(a)&&null!==eb[a]||(eb[a]=r.getElementById(a));r.body.contains(eb[a])||(eb[a]=r.getElementById(a));return eb[a]}function bb(a,c){try{a.contains(c)||a.appendChild(c)}catch(b){console.warn(b.message)}}function C(a,
c){try{a.contains(c)&&a.removeChild(c)}catch(b){console.warn(b.message)}}function q(a){a.preventDefault();a.cancelBubble=!0}function Rc(a,c){var b=a.pageX,e=a.pageY;c.style.display="block";b+c.offsetWidth>Ga.innerWidth?b-=c.offsetWidth:b++;e+c.offsetHeight>Ga.innerHeight?e-=c.offsetHeight:e++;c.style.left=b+"px";c.style.top=e+"px"}function U(a,c,b,e){var f=g("div","radioButtonContainer");a.appendChild(f);a=g("label","radioButton");f.appendChild(a);f=g("input",null,"radio");f.name=b;a.appendChild(f);
h(e)&&(f.onchange=e);b=g("span","check-mark");a.appendChild(b);b=g("span","text");b.innerText=c;a.appendChild(b);return f}function H(a,c,b){var e=g("div");a.appendChild(e);a=g("label","checkbox");a.innerText=c;e.appendChild(a);c=g("input",null,"checkbox");a.appendChild(c);h(b)&&(c.onchange=b);b=g("span","check-mark");a.appendChild(b);return[c,a]}function h(a){return void 0!==a&&null!==a&&""!==a}function Fc(a){return h(a)&&"function"===typeof a}function Qd(a){return h(a)&&"string"===typeof a}function xb(a){return h(a)&&
"number"===typeof a}function Sc(a){return h(a)&&"object"===typeof a&&a instanceof Array}function P(a){return Qd(a)&&""!==a}function db(a,c){c=h(c)?c.toLowerCase():"csv";var b="",e=[];e=h(a)?e.concat(a):pb();e=Fa(e);e=Fa(e,!1);if("csv"===c){var f=[d.idText,d.fromText,d.toText,d.isAllDayText,d.titleText,d.descriptionText,d.locationText,d.backgroundColorText,d.textColorText,d.borderColorText,d.repeatsText,d.repeatEndsText,d.repeatDaysToExcludeText,d.seriesIgnoreDatesText,d.createdText,d.organizerNameText,
d.organizerEmailAddressText];b=f.length;for(var k=[],l=[],m=0;m<b;m++)k.push(z(f[m]));l.push(k.join(","));f=e.length;for(b=0;b<f;b++){k=l;m=e[b];var n=[];n.push(z(v(m.id)));n.push(z(Ib(m.from)));n.push(z(Ib(m.to)));n.push(z(m.isAllDay?d.yesText:d.noText));n.push(z(v(m.title)));n.push(z(v(m.description)));n.push(z(v(m.location)));n.push(z(v(m.color)));n.push(z(v(m.colorText)));n.push(z(v(m.colorBorder)));n.push(z(Za(m.repeatEvery)));n.push(z(Ib(m.repeatEnds)));n.push(z(Rd(m.repeatEveryExcludeDays)));
n.push(z(X(m.seriesIgnoreDates).join(",")));n.push(z(Ib(m.created)));n.push(z(v(m.organizerName)));n.push(z(v(m.organizerEmailAddress)));k.push(n.join(","))}b=l.join("\n")}else if("xml"===c){f=[];f.push('<?xml version="1.0" ?>');f.push("<Events>");b=e.length;for(k=0;k<b;k++){m=e[k];f.push("<Event>");for(l in m)m.hasOwnProperty(l)&&null!==m[l]&&(n=Sd(l),f.push("<"+n+">"+Vc(l,m[l])+"</"+n+">"));f.push("</Event>")}f.push("</Events>");b=f.join("\n")}else if("json"===c){l=[];l.push("{");l.push('"events:": [');
b=e.length;for(k=0;k<b;k++){m=e[k];l.push("{");for(f in m)m.hasOwnProperty(f)&&null!==m[f]&&l.push('"'+f+'":"'+Vc(f,m[f])+'",');m=l[l.length-1];l[l.length-1]=m.substring(0,m.length-1);l.push("},")}l[l.length-1]="}";l.push("]");l.push("}");b=l.join("\n")}else if("text"===c){l=[];f=e.length;for(b=0;b<f;b++){m=e[b];for(k in m)m.hasOwnProperty(k)&&null!==m[k]&&l.push(Sd(k)+": "+Vc(k,m[k]));l.push("")}l.pop();b=l.join("\n")}else if("ical"===c){l=[];l.push("BEGIN:VCALENDAR");l.push("VERSION:2.0");l.push("PRODID:-//hacksw/handcal//NONSGML v1.0//EN");
f=e.length;for(b=0;b<f;b++)k=e[b],l.push("BEGIN:VEVENT"),l.push("UID:"+v(k.id)),l.push("DTSTAMP:"+Wc(k.created)),l.push("ORGANIZER;CN="+v(k.organizerName)+":MAILTO:"+v(k.organizerEmailAddress)),l.push("DTSTART:"+Wc(k.from)),l.push("DTEND:"+Wc(k.to)),l.push("SUMMARY:"+v(k.title)),l.push("END:VEVENT");l.push("END:VCALENDAR");b=l.join("\n")}""!==b&&(e=g("a"),l="text",f=k=c,"text"===c?(k="plain",f="txt"):"ical"===c?(k="calendar",f="ics"):"json"===c&&(l="application"),e.style.display="none",e.setAttribute("target",
"_blank"),e.setAttribute("href","data:"+l+"/"+k+";charset=utf-8,"+encodeURIComponent(b)),l=e.setAttribute,k=new Date,b=E(k.getDate())+"-"+E(k.getMonth())+"-"+k.getFullYear(),k=E(k.getHours())+"-"+E(k.getMinutes()),l.call(e,"download",d.exportStartFilename+b+"_"+k+"."+f),r.body.appendChild(e),e.click(),r.body.removeChild(e),ra("onEventsExported"))}function Ib(a){var c=d.repeatsNever;h(a)&&(c=E(a.getDate())+"/"+E(a.getMonth())+"/"+a.getFullYear(),a=E(a.getHours())+":"+E(a.getMinutes()),c=c+" "+a);return c}
function v(a,c){c=h(c)?c:"";return Qd(a)?a:c}function W(a,c){c=h(c)?c:0;return xb(a)?a:c}function ld(a,c){c=h(c)?c:0;return h(a)&&"boolean"===typeof a?a?1:0:c}function X(a,c){c=h(c)?c:[];return Sc(a)?a:c}function Za(a){var c=d.repeatsNever;a=W(a);1===a?c=d.repeatsEveryDayText:2===a?c=d.repeatsEveryWeekText:3===a?c=d.repeatsEveryMonthText:4===a&&(c=d.repeatsEveryYearText);return c}function Sd(a){return a.charAt(0).toUpperCase()+a.slice(1)}function Vc(a,c){var b=v(c);"boolean"===typeof c?b=c?d.yesText:
d.noText:"object"===typeof c&&c instanceof Date?b=Ib(c):"object"===typeof c&&c instanceof Array?b="repeatEveryExcludeDays"===a?Rd(c):X(c).join(","):"number"===typeof c&&(b="repeatEvery"===a?Za(c):c.toString());return b}function Wc(a){var c=[];c.push(a.getFullYear());c.push(a.getMonth());c.push(a.getDate());c.push("T");c.push(a.getHours());c.push(a.getMinutes());c.push("00");c.push("Z");return c.join("")}function Rd(a){var c=[];if(Sc(a))for(var b=a.length,e=0;e<b;e++){var f=a[e]-1;-1===f&&(f=6);c.push(d.dayNames[f])}return X(c).join(",")}
function z(a){a=a.replace(/(\r\n|\n|\r)/gm,"").replace(/(\s\s)/gm," ");a=a.replace(/"/g,'""');return'"'+a+'"'}function Cc(){var a=new Date(t);a.setMonth(a.getMonth()-1);J(a);ra("onPreviousMonth")}function Ec(){var a=new Date(t);a.setMonth(a.getMonth()+1);J(a);ra("onNextMonth")}function vd(){var a=new Date(t);a.setFullYear(a.getFullYear()-1);J(a);ra("onPreviousYear")}function wd(){var a=new Date(t);a.setFullYear(a.getFullYear()+1);J(a);ra("onNextYear")}function Dc(){var a=new Date;if(t.getMonth()!==
a.getMonth()||t.getFullYear()!==a.getFullYear())J(),ra("onToday")}function Td(a){h(a)&&"object"===typeof a||(a={});return a}var d={},Cb=this,t=null,uc=null,Uc={},eb={},r=null,Ga=null,Xc=null,Kb=!1,sd=!1,M={},Hb=null,x=null,rd=null,Wa=!1,B=null,D=null,ob=null,N=null,cc=null,Va=null,ca=null,R=null,za=null,ka=null,Lb=null,L=null,S=null,G=null,T=null,fb=null,Aa=null,hb=null,gb=null,Ba=null,Nb=null,Ob=null,Pb=null,Qb=null,Oa=null,ib=null,F={},Pa=null,Qa=null,ma=null,Ra=null,Sa=null,Ta=null,na=null,Rb=
null,Sb=null,Tb=null,Ub=null,Vb=null,Wb=null,Xb=null,Ca=null,Ia=null,vb=null,ha=null,Ja=null,wb=null,Y=null,Nc=[],Ya=null,da=null,ta=null,yb=null,ea=null,zb=null,La=null,aa=null,$a=null,fa=null,Bb=null,ab={},Pc={},Ab=[],ua=null,oa=null,wc=null,xc=null,Yb=null,yc=null,jb=null,kb=null,pa=null,zc=null,$c=null,ad=null,bd=null,cd=null,cb=null,w=null,Ac=null,Zb=null,lb=null,mb=null,nb=null,xa=null,I=null,qc=null,O=null,va=null,Db=null,A=null,qa=null,K=null,V=null,fd=null,gd=null,hd=null,id=null,Ua=null,
Ea=null,Gb=!1,Nd=!1,Ld=0,Md=0,ia=[],wa=0;this.turnOnFullScreen=function(){qd()};this.turnOffFullScreen=function(){pd()};this.startTheAutoRefreshTimer=function(){yd()};this.stopTheAutoRefreshTimer=function(){xd()};this.moveToPreviousMonth=function(){Cc()};this.moveToNextMonth=function(){Ec()};this.moveToPreviousYear=function(){vd()};this.moveToNextYear=function(){wd()};this.moveToToday=function(){Dc()};this.getCurrentDisplayDate=function(){return new Date(t)};this.setCurrentDisplayDate=function(a){J(new Date(a));
ra("onSetDate")};this.exportAllEvents=function(a){d.exportEventsEnabled&&(a=h(a)?a:"csv",db(null,a))};this.refresh=function(){$b()};this.addEvents=function(a,c,b){c=h(c)?c:!0;b=h(b)?b:!0;for(var e=a.length,f=0;f<e;f++)this.addEvent(a[f],!1,!1);b&&ec("onEventAdded",a);c&&ja()};this.addEvent=function(a,c,b){var e=!1;if(a.from<=a.to){var f=a.from;f=f.getFullYear()+"-"+f.getMonth()+"-"+f.getDate();var k=od();M.hasOwnProperty(f)||(M[f]={});M[f].hasOwnProperty(k)||(c=h(c)?c:!0,b=h(b)?b:!0,h(a.id)?k=a.id:
a.id=k,h(a.created)||(a.created=new Date),M[f][k]=kd(a),e=!0,b&&ec("onEventAdded",a),c&&ja())}return e};this.updateEvent=function(a,c,b,e){if(a=this.removeEvent(a,!1,!1))b=h(b)?b:!0,e=h(e)?e:!0,c.id=od(),(a=this.addEvent(c,b,!1))&&e&&ec("onEventUpdated",c);return a};this.removeEvent=function(a,c,b){var e=!1;qb(function(f,k,l){if(l===a)return c=h(c)?c:!0,b=h(b)?b:!0,delete M[k][l],e=!0,b&&ec("onEventRemoved",f),c&&ja(),!0});return e};this.clearEvents=function(a){a=h(a)?a:!0;M={};ra("onEventsCleared");
a&&ja()};this.getEvents=function(){return Fa(pb())};this.getEvent=function(a){var c=null;qb(function(b,e,f){if(f===a)return c=b,!0});return c};this.setOptions=function(a){a=Td(a);for(var c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);Kb&&(Kb=!1,J(t,!0))};(function(a,c){r=a;Ga=c;Xc=Ud;d=Td(Vd);h(d.previousMonthTooltipText)||(d.previousMonthTooltipText="Previous Month");h(d.nextMonthTooltipText)||(d.nextMonthTooltipText="Next Month");h(d.previousDayTooltipText)||(d.previousDayTooltipText="Previous Day");h(d.nextDayTooltipText)||
(d.nextDayTooltipText="Next Day");h(d.previousWeekTooltipText)||(d.previousWeekTooltipText="Previous Week");h(d.nextWeekTooltipText)||(d.nextWeekTooltipText="Next Week");h(d.addEventTooltipText)||(d.addEventTooltipText="Add Event");h(d.closeTooltipText)||(d.closeTooltipText="Close");h(d.exportEventsTooltipText)||(d.exportEventsTooltipText="Export Events");h(d.todayTooltipText)||(d.todayTooltipText="Today");h(d.refreshTooltipText)||(d.refreshTooltipText="Refresh");h(d.searchTooltipText)||(d.searchTooltipText=
"Search");h(d.expandDayTooltipText)||(d.expandDayTooltipText="Expand Day");h(d.listAllEventsTooltipText)||(d.listAllEventsTooltipText="View All Events");h(d.listWeekEventsTooltipText)||(d.listWeekEventsTooltipText="View Current Week Events");h(d.dayHeaderNames)||(d.dayHeaderNames="Mon Tue Wed Thu Fri Sat Sun".split(" "));h(d.dayNames)||(d.dayNames="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "));h(d.fromText)||(d.fromText="From:");h(d.toText)||(d.toText="To:");h(d.isAllDayText)||
(d.isAllDayText="Is All-Day");h(d.titleText)||(d.titleText="Title:");h(d.descriptionText)||(d.descriptionText="Description:");h(d.locationText)||(d.locationText="Location:");h(d.addText)||(d.addText="Add");h(d.updateText)||(d.updateText="Update");h(d.cancelText)||(d.cancelText="Cancel");h(d.removeEventText)||(d.removeEventText="Remove");h(d.addEventTitle)||(d.addEventTitle="Add Event");h(d.editEventTitle)||(d.editEventTitle="Edit Event");h(d.monthNames)||(d.monthNames="January February March April May June July August September October November December".split(" "));
h(d.showDayNumberOrdinals)||(d.showDayNumberOrdinals=!0);h(d.dragAndDropForEventsEnabled)||(d.dragAndDropForEventsEnabled=!0);h(d.exportStartFilename)||(d.exportStartFilename="exported_events_");h(d.fromTimeErrorMessage)||(d.fromTimeErrorMessage="Please select a valid 'From' time.");h(d.toTimeErrorMessage)||(d.toTimeErrorMessage="Please select a valid 'To' time.");h(d.toSmallerThanFromErrorMessage)||(d.toSmallerThanFromErrorMessage="Please select a 'To' date that is larger than the 'From' date.");
h(d.titleErrorMessage)||(d.titleErrorMessage="Please enter a value in the 'Title' field (no empty space).");h(d.stText)||(d.stText="st");h(d.ndText)||(d.ndText="nd");h(d.rdText)||(d.rdText="rd");h(d.thText)||(d.thText="th");h(d.maximumEventsPerDayDisplay)||(d.maximumEventsPerDayDisplay=3);h(d.yesText)||(d.yesText="Yes");h(d.noText)||(d.noText="No");h(d.extraSelectableYearsAhead)||(d.extraSelectableYearsAhead=51);h(d.allDayText)||(d.allDayText="All-Day");h(d.allEventsText)||(d.allEventsText="All Events");
h(d.exportEventsEnabled)||(d.exportEventsEnabled=!0);h(d.manualEditingEnabled)||(d.manualEditingEnabled=!0);h(d.showTimesInMainCalendarEvents)||(d.showTimesInMainCalendarEvents=!1);h(d.startsOnText)||(d.startsOnText="Starts on the");h(d.andFinishesOnText)||(d.andFinishesOnText="and finishes on the");h(d.toTimeText)||(d.toTimeText="to");h(d.autoRefreshTimerDelay)||(d.autoRefreshTimerDelay=5E3);h(d.confirmEventRemoveTitle)||(d.confirmEventRemoveTitle="Confirm Event Removal");h(d.confirmEventRemoveMessage)||
(d.confirmEventRemoveMessage="Removing this event cannot be undone.  Do you want to continue?");h(d.okText)||(d.okText="OK");h(d.selectExportTypeTitle)||(d.selectExportTypeTitle="Select Export Type");h(d.fullScreenModeEnabled)||(d.fullScreenModeEnabled=!0);h(d.eventTooltipDelay)||(d.eventTooltipDelay=1E3);h(d.selectColorsText)||(d.selectColorsText="Select Colors");h(d.backgroundColorText)||(d.backgroundColorText="Background Color:");h(d.textColorText)||(d.textColorText="Text Color:");h(d.borderColorText)||
(d.borderColorText="Border Color:");h(d.searchEventsTitle)||(d.searchEventsTitle="Search Events");h(d.forText)||(d.forText="For:");h(d.previousText)||(d.previousText="Previous");h(d.nextText)||(d.nextText="Next");h(d.matchCaseText)||(d.matchCaseText="Match Case");h(d.minimumDayHeight)||(d.minimumDayHeight=0);h(d.repeatsText)||(d.repeatsText="Repeats:");h(d.repeatDaysToExcludeText)||(d.repeatDaysToExcludeText="Repeat Days To Exclude:");h(d.daysToExcludeText)||(d.daysToExcludeText="Days To Exclude:");
h(d.seriesIgnoreDatesText)||(d.seriesIgnoreDatesText="Series Ignore Dates:");h(d.repeatsNever)||(d.repeatsNever="Never");h(d.repeatsEveryDayText)||(d.repeatsEveryDayText="Every Day");h(d.repeatsEveryWeekText)||(d.repeatsEveryWeekText="Every Week");h(d.repeatsEveryMonthText)||(d.repeatsEveryMonthText="Every Month");h(d.repeatsEveryYearText)||(d.repeatsEveryYearText="Every Year");h(d.repeatOptionsTitle)||(d.repeatOptionsTitle="Repeat Options");h(d.moreText)||(d.moreText="More");h(d.includeText)||(d.includeText=
"Include:");h(d.holidays)||(d.holidays=[{day:24,month:12,title:"Christmas Eve"},{day:25,month:12,title:"Christmas Day"},{day:26,month:12,title:"Boxing Day"},{day:31,month:12,title:"New Year's Eve"},{day:1,month:1,title:"New Year's Day"}]);h(d.minimizedTooltipText)||(d.minimizedTooltipText="Minimize");h(d.restoreTooltipText)||(d.restoreTooltipText="Restore");h(d.removeAllEventsInSeriesText)||(d.removeAllEventsInSeriesText="Remove All Events In Series");h(d.createdText)||(d.createdText="Created:");
h(d.organizerName)||(d.organizerName="");h(d.organizerEmailAddress)||(d.organizerEmailAddress="");h(d.organizerNameText)||(d.organizerNameText="Organizer:");h(d.organizerEmailAddressText)||(d.organizerEmailAddressText="Organizer Email:");h(d.enableFullScreenTooltipText)||(d.enableFullScreenTooltipText="Turn On Full-Screen Mode");h(d.disableFullScreenTooltipText)||(d.disableFullScreenTooltipText="Turn Off Full-Screen Mode");h(d.idText)||(d.idText="ID:");h(d.spacing)||(d.spacing=10);h(d.expandMonthTooltipText)||
(d.expandMonthTooltipText="Expand Month");h(d.repeatEndsText)||(d.repeatEndsText="Repeat Ends:");J(Wd,!0)})(document,window)};