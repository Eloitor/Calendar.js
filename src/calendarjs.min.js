function calendarJs(jd,kd,ld){function U(a){t=h(a)?a:new Date;var b=(new Date(t.getFullYear(),t.getMonth(),1)).getDay();a=nb(t.getFullYear(),t.getMonth());0===b&&(b=7);fa();if(!ob){var c=ta(Ac);c.className="calendar";c.innerHTML="";md(c);nd(c);od(c);pd(c);var e=f("div","row header-days"),g=d.dayHeaderNames.length;c.appendChild(e);for(var k=0;k<g;k++){var l=d.dayHeaderNames[k],m=f("div","cell");m.innerHTML=l;e.appendChild(m)}for(e=0;6>e;e++)for(g=f("div","row"),c.appendChild(g),k=0;7>k;k++)l=7*e+(k+
    1),m=f("div","cell"),m.id="calendar-day-"+l,g.appendChild(m),0<d.minimumDayHeight&&(m.style.height=d.minimumDayHeight+"px");ob=!0}k=b;if(1<k)for(c=new Date(t),c.setMonth(c.getMonth()-1),e=nb(c.getFullYear(),c.getMonth()),g=1,k=e-k+1;k<e;k++)ac(k+1,g,c.getMonth(),c.getFullYear(),!0),g++;for(e=c=0;e<a;e++)c=b+e,ac(e+1,c,t.getMonth(),t.getFullYear(),!1);if(42>c){b=1;a=new Date(t);a.setMonth(a.getMonth()+1);for(c+=1;43>c;c++)ac(b,c,a.getMonth(),a.getFullYear(),!0),b++;b=nb(a.getFullYear(),a.getMonth());
    b=Math.round(b/2);bc=new Date(a.getFullYear(),a.getMonth(),b)}else bc=null;ha();null===M&&(M=f("div","disabled-background"));null!==ia&&x(p.body,ia);ia=f("div","calendar-dialog event-editor");p.body.appendChild(ia);b=f("div","view");ia.appendChild(b);V=f("div","disabled-area");b.appendChild(V);pb=f("div","title-bar");b.appendChild(pb);a=f("div","contents");b.appendChild(a);b=f("p");b.innerText=d.titleText;a.appendChild(b);b=f("div","input-title-container");a.appendChild(b);ja=f("input",null,"text");
    b.appendChild(ja);c=f("input","select-colors","button");c.value="...";c.onclick=qd;b.appendChild(c);b=f("p");b.innerText=d.fromText.replace(":","")+"/"+d.toText;a.appendChild(b);b=f("div","split");a.appendChild(b);G=f("input");G.onchange=qb;b.appendChild(G);ka(G,"date");N=f("input");b.appendChild(N);ka(N,"time");b=f("div","split");a.appendChild(b);A=f("input");A.onchange=qb;b.appendChild(A);ka(A,"date");O=f("input");b.appendChild(O);ka(O,"time");Ma=S(a,d.isAllDayText,qb);b=f("p");b.innerText=d.repeatsText;
    a.appendChild(b);b=f("div","radioButtonsContainer");a.appendChild(b);la=T(b,d.repeatsNever,"RepeatType",ua);rb=T(b,d.repeatsEveryDayText,"RepeatType",ua);sb=T(b,d.repeatsEveryWeekText,"RepeatType",ua);tb=T(b,d.repeatsEveryMonthText,"RepeatType",ua);ub=T(b,d.repeatsEveryYearText,"RepeatType",ua);va=f("input","days-to-exclude","button");va.value="...";va.onclick=rd;b.appendChild(va);b=f("p");b.innerText=d.locationText;a.appendChild(b);Na=f("input",null,"text");a.appendChild(Na);b=f("p");b.innerText=
    d.descriptionText;a.appendChild(b);Oa=f("textarea","custom-scroll-bars");a.appendChild(Oa);Pa=f("p","error");a.appendChild(Pa);b=f("div","split");a.appendChild(b);wa=f("input","ok","button");wa.value=d.addText;wa.onclick=sd;b.appendChild(wa);c=f("input","cancel","button");c.value=d.cancelText;c.onclick=cc;b.appendChild(c);xa=f("input","remove","button");xa.value=d.removeEventText;xa.onclick=td;a.appendChild(xa);null!==W&&x(p.body,W);W=f("div","calendar-dialog event-editor-colors");p.body.appendChild(W);
    a=f("div","title-bar");a.innerHTML=d.selectColorsText;W.appendChild(a);a=f("div","contents");W.appendChild(a);b=f("p");b.innerText=d.backgroundColorText;a.appendChild(b);ya=f("input");a.appendChild(ya);ka(ya,"color");b=f("p");b.innerText=d.textColorText;a.appendChild(b);za=f("input");a.appendChild(za);ka(za,"color");b=f("p");b.innerText=d.borderColorText;a.appendChild(b);Aa=f("input");a.appendChild(Aa);ka(Aa,"color");b=f("div","split");a.appendChild(b);a=f("input","ok","button");a.value=d.okText;
    a.onclick=ud;b.appendChild(a);a=f("input","cancel","button");a.value=d.cancelText;a.onclick=Bc;b.appendChild(a);null!==X&&x(p.body,X);X=f("div","calendar-dialog event-editor-exclude-days");p.body.appendChild(X);a=f("div","title-bar");a.innerHTML=d.selectDaysToExcludeTitle;X.appendChild(a);b=f("div","contents");X.appendChild(b);vb=S(b,d.dayNames[0]);wb=S(b,d.dayNames[1]);xb=S(b,d.dayNames[2]);yb=S(b,d.dayNames[3]);zb=S(b,d.dayNames[4]);Ab=S(b,d.dayNames[5]);Bb=S(b,d.dayNames[6]);a=f("div","split");
    b.appendChild(a);b=f("input","ok","button");b.value=d.okText;b.onclick=vd;a.appendChild(b);b=f("input","cancel","button");b.value=d.cancelText;b.onclick=Cc;a.appendChild(b);null!==Y&&x(p.body,Y);Y=f("div","calendar-dialog confirmation");p.body.appendChild(Y);dc=f("div","title-bar");Y.appendChild(dc);a=f("div","contents");Y.appendChild(a);ec=f("div","message");a.appendChild(ec);b=f("div","split");a.appendChild(b);Qa=f("input","yes","button");Qa.value=d.yesText;b.appendChild(Qa);Ra=f("input","no","button");
    Ra.value=d.noText;b.appendChild(Ra);null!==Z&&x(p.body,Z);Z=f("div","calendar-dialog select-export-type");p.body.appendChild(Z);a=f("div","title-bar");a.innerHTML=d.selectExportTypeTitle;Z.appendChild(a);b=f("div","contents");Z.appendChild(b);a=f("div","radioButtonsContainer");b.appendChild(a);fc=T(a,"CSV","ExportType");Dc=T(a,"XML","ExportType");Ec=T(a,"JSON","ExportType");Fc=T(a,"TEXT","ExportType");a=f("div","split");b.appendChild(a);b=f("input","ok","button");b.value=d.okText;b.onclick=wd;a.appendChild(b);
    b=f("input","cancel","button");b.value=d.cancelText;b.onclick=Gc;a.appendChild(b);null===D&&x(p.body,D);D=f("div","calendar-dialog search");p.body.appendChild(D);a=f("div","title-bar");a.innerHTML=d.searchEventsTitle;a.onmousedown=xd;a.onmouseup=yd;D.appendChild(a);b=f("div","ib-close");b.onclick=zd;a.appendChild(b);u(b,d.closeTooltipText);a=f("div","contents");D.appendChild(a);b=f("p");b.innerText=d.forText;a.appendChild(b);P=f("input",null,"text");P.oninput=gc;P.onpropertychange=gc;P.onkeypress=
    Ad;a.appendChild(P);Hc=S(a,d.matchCaseText);b=f("div","split");a.appendChild(b);Ba=f("input","previous","button");Ba.value=d.previousText;Ba.onclick=Bd;b.appendChild(Ba);ma=f("input","next","button");ma.value=d.nextText;ma.onclick=Ic;b.appendChild(ma);p.body.addEventListener("mousemove",Cd);null===v&&(v=f("div"),p.body.appendChild(v),hc=f("div","title"),Cb=f("div","date"),Sa=f("div","repeats"),Ta=f("div","description"),Ua=f("div","location"),document.body.addEventListener("mousemove",ic));Dd();Ed();
    Jc||(p.body.addEventListener("click",fa),p.body.addEventListener("contextmenu",fa),Db.addEventListener("resize",fa),Jc=!0);Va.innerHTML=d.monthNames[t.getMonth()]+", "+t.getFullYear()+" \u25be"}function Eb(){var a=[];Fb(function(b){a.push(b)});return a}function Fb(a){for(var b in H)if(H.hasOwnProperty(b))for(var c in H[b])if(H[b].hasOwnProperty(c)){var e=Kc(H[b][c]);if(a(e,b,c))return}}function Wa(a){a=a.sort(function(b,c){return b.from-c.from});return a=a.sort(function(b,c){return Lc(c.isAllDay)-
    Lc(b.isAllDay)})}function pd(a){B=f("div","header-date");a.appendChild(B);d.fullScreenModeEnabled&&(B.ondblclick=function(){Gb(a)});var b=f("div","ib-arrow-left-full");b.onclick=Mc;b.ondblclick=q;B.appendChild(b);u(b,d.previousMonthTooltipText);b=f("div","ib-pin");b.onclick=Nc;b.ondblclick=q;B.appendChild(b);u(b,d.todayTooltipText);b=f("div","ib-refresh");b.onclick=jc;b.ondblclick=q;B.appendChild(b);u(b,d.refreshTooltipText);b=f("div","ib-search");b.onclick=Fd;b.ondblclick=q;B.appendChild(b);u(b,
    d.searchTooltipText);b=f("div","ib-arrow-right-full");b.onclick=Oc;b.ondblclick=q;B.appendChild(b);u(b,d.nextMonthTooltipText);d.manualEditingEnabled&&(b=f("div","ib-plus"),b.onclick=Hb,b.ondblclick=q,B.appendChild(b),u(b,d.addEventTooltipText));d.exportEventsEnabled&&(Ca=f("div","ib-arrow-down-full-line"),Ca.ondblclick=q,B.appendChild(Ca),u(Ca,d.exportEventsTooltipText),Ca.onclick=function(){Ib()});b=f("div","ib-eye");b.ondblclick=q;B.appendChild(b);b.onclick=function(){Pc(!0)};u(b,d.listAllEventsTooltipText);
    b=f("div","ib-hamburger");b.ondblclick=q;B.appendChild(b);b.onclick=function(){Xa(null,!0)};u(b,d.listWeekEventsTooltipText);b=f("div","title-container");B.appendChild(b);Va=f("span");Va.ondblclick=q;b.appendChild(Va);Gd(b)}function Gd(a){var b=new Date(1900,1,1),c=(new Date).getFullYear()-b.getFullYear()+d.extraSelectableYearsAhead;I=f("div","years-drop-down");a.appendChild(I);Jb=f("div","contents custom-scroll-bars");I.appendChild(Jb);for(a=0;a<c;a++)Hd(b.getFullYear()),b.setFullYear(b.getFullYear()+
    1);Va.onclick=Id}function Hd(a){var b=f("div");b.innerText=a.toString();b.id="year-selected-"+a.toString();Jb.appendChild(b);b.onclick=function(){t.setFullYear(a);U(t);Kb()&&(I.style.display="none")}}function Kc(a){a.isAllDay&&(a.from=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),0,0),a.to=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),23,59));return a}function Ya(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate()),e=new Date(b.getFullYear(),b.getMonth(),
    b.getDate());return Math.ceil(Math.abs(e-c)/864E5)}function Id(a){if("block"!==I.style.display){fa();q(a);a=I.getElementsByClassName("current-year-selected");if(1<=a.length)for(var b=a.length,c=0;c<b;c++)a[c].removeAttribute("class");a=ta("year-selected-"+t.getFullYear());null!==a&&(a.className="current-year-selected");I.style.display="block";Jb.scrollTop=a.offsetTop-I.offsetHeight/2}}function Kb(){return null!==I&&"block"===I.style.display}function Za(a){if(null!==d&&kc(d[a]))d[a]()}function Lb(a,
    b){if(null!==d&&kc(d[a]))d[a](b)}function Qc(){for(var a=[],b=0;32>b;b++){8!==b&&12!==b&&16!==b&&20!==b||a.push("-");var c=Math.floor(16*Math.random()).toString(16);a.push(c)}return a.join("")}function Gb(a){0>=a.className.indexOf(" full-screen-view")?(a.className+=" full-screen-view",Rc=a.style.cssText,a.removeAttribute("style")):(a.className=a.className.replace(" full-screen-view",""),a.style.cssText=Rc)}function fa(){lc()&&(C.style.display="none");mc()&&(J.style.display="none");Kb()&&(I.style.display=
    "none");ic()}function ha(){Jd();null!==$a&&0<d.autoRefreshTimerDelay&&(clearTimeout($a),$a=null);for(var a=Wa(Eb()),b=a.length,c=0;c<b;c++){var e=a[c];null!==Mb(e.from)&&Kd(e);var g=aa(e.repeatEvery);0<g&&(1===g?Nb(e,function(k){k.setDate(k.getDate()+1)}):2===g?Nb(e,function(k){k.setDate(k.getDate()+7)}):3===g?Nb(e,function(k){k.setMonth(k.getMonth()+1)}):4===g&&Nb(e,function(k){k.setFullYear(k.getFullYear()+1)}))}d.exportEventsEnabled&&(Ca.style.display=0===b?"none":"inline-block");Ld()}function Nb(a,
    b){for(var c=new Date(a.from),e=Da(a.repeatEveryExcludeDays);c<bc;)b(c),-1===e.indexOf(c.getDay())&&null!==Mb(c)&&nc(c,a)}function Kd(a){nc(a.from,a);if(a.from.getDate()!==a.to.getDate()){var b=Ya(a.from,a.to);if(0<b)for(var c=new Date(a.from),e=0;e<b;e++)c.setDate(c.getDate()+1),null!==Mb(c)&&nc(c,a)}}function nc(a,b){var c=Mb(a);if(null!==c){var e=d.manualEditingEnabled?"event":"event-no-hover";if(c.getElementsByClassName(e).length<d.maximumEventsPerDayDisplay){e=f("div",e);var g=b.title;d.showTimesInMainCalendarEvents&&
    !b.isAllDay&&b.from.getDate()===b.to.getDate()&&(g=ab(b.from,b.to)+": "+g);e.innerHTML=g;c.appendChild(e);Ob(b,e,oc(b,a));e.onmousemove=function(k){Sc(k,b)};d.manualEditingEnabled&&(e.oncontextmenu=function(k){Pb(k,b)});d.manualEditingEnabled&&(e.onclick=function(){ba(b)});d.dragAndDropForEventsEnabled&&d.manualEditingEnabled&&(e.setAttribute("draggable",!0),e.ondragstart=function(){w=b})}else e=c.getElementsByClassName("plus-x-events"),e=0<e.length?e[0]:null,null===e?(e=f("div","plus-x-events"),
    e.setAttribute("events","1"),e.innerHTML="+1 "+d.moreText,c.appendChild(e)):(c=parseInt(e.getAttribute("events"))+1,e.setAttribute("events",c.toString()),e.innerHTML="+"+c+" "+d.moreText)}}function Mb(a){var b=new Date(t.getFullYear(),t.getMonth(),1);var c=new Date(t);var e=new Date(t),g=null,k=0;b=pc(b);c.setMonth(c.getMonth()+1);e.setMonth(e.getMonth()-1);a.getMonth()===c.getMonth()&&a.getFullYear()===c.getFullYear()?(c=b+nb(t.getFullYear(),t.getMonth()),k=a.getDate()+c):a.getMonth()===e.getMonth()&&
    a.getFullYear()===e.getFullYear()?k=b-Ya(a,t)+1:a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear()&&(c=b,k=a.getDate()+c);0<k&&(g=ta("calendar-day-"+k));return g}function Jd(){for(var a=0;6>a;a++)for(var b=0;7>b;b++){var c=ta("calendar-day-"+(7*a+(b+1)));Tc(c,d.manualEditingEnabled?"event":"event-no-hover");Tc(c,"plus-x-events")}}function Tc(a,b){for(var c=a.getElementsByClassName(b);c[0];)c[0].parentNode.removeChild(c[0])}function Ob(a,b,c){h(c)&&c<new Date&&(b.className+=" expired");
    K(a.color)?(b.style.backgroundColor=a.color,K(a.colorText)&&(b.style.color=a.colorText),K(a.colorBorder)&&(b.style.borderLeftColor=a.colorBorder)):a.isAllDay&&(b.className+=" all-day")}function oc(a,b){var c=aa(a.repeatEvery),e=new Date(a.to);0<c&&(c=new Date(b),c.setHours(e.getHours(),e.getMinutes()),e=c);return e}function od(a){na=f("div","full-day-view");a.appendChild(na);var b=f("div","title-bar");na.appendChild(b);d.fullScreenModeEnabled&&(b.ondblclick=function(){Gb(a)});bb=f("div","title");
    b.appendChild(bb);var c=f("div","ib-close");c.ondblclick=q;b.appendChild(c);u(c,d.closeTooltipText);c.onclick=function(){qc(na);Q=null};d.manualEditingEnabled&&(c=f("div","ib-plus"),c.onclick=Hb,c.ondblclick=q,b.appendChild(c),u(c,d.addEventTooltipText));c=f("div","ib-arrow-right-full");c.onclick=Md;c.ondblclick=q;b.appendChild(c);u(c,d.nextDayTooltipText);c=f("div","ib-arrow-left-full");c.onclick=Nd;c.ondblclick=q;b.appendChild(c);u(c,d.previousDayTooltipText);d.exportEventsEnabled&&(Ea=f("div",
    "ib-arrow-down-full-line"),Ea.ondblclick=q,b.appendChild(Ea),u(Ea,d.exportEventsTooltipText),Ea.onclick=function(){Ib(rc)});cb=f("div","contents custom-scroll-bars");na.appendChild(cb)}function db(a,b){b=h(b)?b:!1;bb.innerText="";cb.innerHTML="";Q=a;rc=[];b&&(cb.scrollTop=0);sc(na);oa(bb,a,!1,!0,!0);var c=Uc(a),e=[];if(null!==c){var g=f("span","holiday");g.innerText=" ("+c+")";bb.appendChild(g)}Fb(function(k){for(var l=Ya(k.from,k.to)+1,m=new Date(k.from),r=0;r<l;r++){if(m.getFullYear()===a.getFullYear()&&
    m.getMonth()===a.getMonth()&&m.getDate()===a.getDate()){e.push(k);break}m.setDate(m.getDate()+1)}l=aa(k.repeatEvery);0<l&&(1===l?Qb(k,e,a,function(n){n.setDate(n.getDate()+1)}):2===l?Qb(k,e,a,function(n){n.setDate(n.getDate()+7)}):3===l?Qb(k,e,a,function(n){n.setMonth(n.getMonth()+1)}):4===l&&Qb(k,e,a,function(n){n.setFullYear(n.getFullYear()+1)}))});e=Wa(e);c=e.length;for(g=0;g<c;g++)Od(e[g],a);d.exportEventsEnabled&&(Ea.style.display=0===e.length?"none":"inline-block")}function Qb(a,b,c,e){for(var g=
    new Date(a.from),k=Da(a.repeatEveryExcludeDays);g<c;)if(e(g),-1===k.indexOf(g.getDay())&&g.getFullYear()===c.getFullYear()&&g.getMonth()===c.getMonth()&&g.getDate()===c.getDate()){b.push(a);break}}function Od(a,b){var c=f("div",d.manualEditingEnabled?"event":"event-no-hover");cb.appendChild(c);d.manualEditingEnabled&&(c.oncontextmenu=function(g){Pb(g,a)});Ob(a,c,oc(a,b));var e=f("div","title");e.innerHTML=a.title;c.appendChild(e);e=f("div","date");c.appendChild(e);a.from.getDate()===a.to.getDate()?
    e.innerHTML=a.isAllDay?d.allDayText:ab(a.from,a.to):Rb(e,a.from,a.to);eb(a.repeatEvery)&&0<a.repeatEvery&&(e=f("div","repeats"),e.innerHTML=d.repeatsText.replace(":","")+" "+Fa(a.repeatEvery),c.appendChild(e));K(a.location)&&(e=f("div","location"),e.innerHTML=a.location,c.appendChild(e));K(a.description)&&(e=f("div","description"),e.innerHTML=a.description,c.appendChild(e));d.manualEditingEnabled&&(c.onclick=function(){ba(a)});rc.push(a)}function Nd(){Q.setDate(Q.getDate()-1);db(Q,!0)}function Md(){Q.setDate(Q.getDate()+
    1);db(Q,!0)}function md(a){pa=f("div","list-all-events-view");a.appendChild(pa);var b=f("div","title-bar");pa.appendChild(b);d.fullScreenModeEnabled&&(b.ondblclick=function(){Gb(a)});var c=f("div","title");c.innerHTML=d.allEventsText;b.appendChild(c);c=f("div","ib-close");c.ondblclick=q;b.appendChild(c);u(c,d.closeTooltipText);c.onclick=function(){qc(pa)};d.manualEditingEnabled&&(c=f("div","ib-plus"),c.onclick=Hb,c.ondblclick=q,b.appendChild(c),u(c,d.addEventTooltipText));d.exportEventsEnabled&&(fb=
    f("div","ib-arrow-down-full-line"),fb.ondblclick=q,b.appendChild(fb),u(fb,d.exportEventsTooltipText),fb.onclick=function(){Ib()});gb=f("div","contents custom-scroll-bars");pa.appendChild(gb)}function Pc(a){a=h(a)?a:!1;sc(pa);gb.innerHTML="";a&&(gb.scrollTop=0);a=Wa(Eb());for(var b=a.length,c=0;c<b;c++){var e=a[c],g=e.from,k="month-"+g.getMonth()+"-"+g.getFullYear(),l=ta(k);if(null===l){var m=f("div","month");gb.appendChild(m);l=f("div","header");l.innerHTML=d.monthNames[g.getMonth()]+" "+g.getFullYear();
    m.appendChild(l);l=f("div","events");l.id=k;m.appendChild(l)}Pd(e,l)}}function Pd(a,b){var c=f("div",d.manualEditingEnabled?"event":"event-no-hover");b.appendChild(c);d.manualEditingEnabled&&(c.oncontextmenu=function(g){Pb(g,a)});Ob(a,c);var e=f("div","title");e.innerHTML=a.title;c.appendChild(e);e=f("div","date");c.appendChild(e);a.from.getDate()===a.to.getDate()?a.isAllDay?Sb(e,a.from,null," - "+d.allDayText):Sb(e,a.from,null," - "+ab(a.from,a.to)):Rb(e,a.from,a.to);eb(a.repeatEvery)&&0<a.repeatEvery&&
    (e=f("div","repeats"),e.innerHTML=d.repeatsText.replace(":","")+" "+Fa(a.repeatEvery),c.appendChild(e));K(a.location)&&(e=f("div","location"),e.innerHTML=a.location,c.appendChild(e));K(a.description)&&(e=f("div","description"),e.innerHTML=a.description,c.appendChild(e));d.manualEditingEnabled&&(c.onclick=function(){ba(a)})}function nd(a){qa=f("div","list-all-week-events-view");a.appendChild(qa);var b=f("div","title-bar");qa.appendChild(b);d.fullScreenModeEnabled&&(b.ondblclick=function(){Gb(a)});
    R=f("div","title");b.appendChild(R);var c=f("div","ib-close");c.ondblclick=q;b.appendChild(c);u(c,d.closeTooltipText);c.onclick=function(){qc(qa)};d.manualEditingEnabled&&(c=f("div","ib-plus"),c.onclick=Hb,c.ondblclick=q,b.appendChild(c),u(c,d.addEventTooltipText));c=f("div","ib-arrow-right-full");c.onclick=Qd;c.ondblclick=q;b.appendChild(c);u(c,d.nextWeekTooltipText);c=f("div","ib-arrow-left-full");c.onclick=Rd;c.ondblclick=q;b.appendChild(c);u(c,d.previousWeekTooltipText);d.exportEventsEnabled&&
    (Ga=f("div","ib-arrow-down-full-line"),Ga.ondblclick=q,b.appendChild(Ga),u(Ga,d.exportEventsTooltipText),Ga.onclick=function(){Ib(hb)});ib=f("div","contents custom-scroll-bars");qa.appendChild(ib)}function Xa(a,b){b=h(b)?b:!1;sc(qa);ib.innerHTML="";Ha={};tc={};hb=[];ca=null===a?new Date:a;b&&(ib.scrollTop=0);var c=Sd(a),e=c[0];c=c[1];Td(e,c);for(var g=Wa(Eb()),k=g.length,l=0;l<k;l++){for(var m=g[l],r=Ya(m.from,m.to)+1,n=new Date(m.from),ra=!1,Ia=0;Ia<r;Ia++)n>=e&&n<=c&&(ra=Vc(n),Wc(m,ra,n),ra=!0),
    n.setDate(n.getDate()+1);ra&&hb.push(m);r=aa(m.repeatEvery);n=!1;0<r&&(1===r?n=Tb(m,e,c,function(L){L.setDate(L.getDate()+1)}):2===r?n=Tb(m,e,c,function(L){L.setDate(L.getDate()+7)}):3===r?n=Tb(m,e,c,function(L){L.setMonth(L.getMonth()+1)}):4===r&&(n=Tb(m,e,c,function(L){L.setFullYear(L.getFullYear()+1)})));n&&!ra&&hb.push(m)}for(var Xc in Ha)Ha.hasOwnProperty(Xc)&&ib.appendChild(Ha[Xc]);d.exportEventsEnabled&&(Ga.style.display=0===hb.length?"none":"inline-block")}function Tb(a,b,c,e){for(var g=new Date(a.from),
    k=Da(a.repeatEveryExcludeDays),l=!1;g<c;)e(g),-1===k.indexOf(g.getDay())&&g>=b&&g<=c&&(l=Vc(g),Wc(a,l,g),l=!0);return l}function Td(a,b){R.innerHTML="";if(a.getFullYear()===b.getFullYear()){oa(R,a,!1,!1);var c=f("span");c.innerHTML=" - ";R.appendChild(c);oa(R,b,!1,!1);c=f("span");c.innerHTML=", "+a.getFullYear();R.appendChild(c)}else oa(R,a,!1,!0),c=f("span"),c.innerHTML=" - ",R.appendChild(c),oa(R,b,!1,!0)}function Wc(a,b,c){var e=f("div",d.manualEditingEnabled?"event":"event-no-hover");b.appendChild(e);
    d.manualEditingEnabled&&(e.oncontextmenu=function(g){Pb(g,a)});Ob(a,e,oc(a,c));b=f("div","title");b.innerHTML=a.title;e.appendChild(b);b=f("div","date");e.appendChild(b);a.from.getDate()===a.to.getDate()?b.innerHTML=a.isAllDay?d.allDayText:ab(a.from,a.to):Rb(b,a.from,a.to);eb(a.repeatEvery)&&0<a.repeatEvery&&(b=f("div","repeats"),b.innerHTML=d.repeatsText.replace(":","")+" "+Fa(a.repeatEvery),e.appendChild(b));K(a.location)&&(b=f("div","location"),b.innerHTML=a.location,e.appendChild(b));K(a.description)&&
    (b=f("div","description"),b.innerHTML=a.description,e.appendChild(b));d.manualEditingEnabled&&(e.onclick=function(){ba(a)})}function Vc(a){var b=pc(a),c=a.getFullYear()+a.getMonth()+b;if(Ha.hasOwnProperty(c))a=tc[c];else{var e=f("div","day");Ha[c]=e;var g=f("div","header");e.appendChild(g);Sb(g,a,d.dayNames[b]+", ");a=f("div","events");e.appendChild(a);tc[c]=a}return a}function pc(a){return 0>a.getDay()-1?6:a.getDay()-1}function Sd(a){a=h(a)?a:new Date;var b=0===a.getDay()?7:a.getDay();b=a.getDate()-
    b+1;var c=b+6,e=new Date(a);a=new Date(a);e.setDate(b);e.setHours(0,0,0,0);a.setDate(c);a.setHours(23,59,59,99);return[e,a]}function Rd(){ca.setDate(ca.getDate()-7);Xa(ca,!0)}function Qd(){ca.setDate(ca.getDate()+7);Xa(ca,!0)}function ab(a,b){return uc(a)+" "+d.toTimeText+" "+uc(b)}function uc(a){return E(a.getHours())+":"+E(a.getMinutes())}function Rb(a,b,c){a.innerHTML="";var e=f("span");e.innerText=d.startsOnText+" ";a.appendChild(e);oa(a,b);b=f("span");b.innerText=" "+d.andFinishesOnText+" ";
    a.appendChild(b);oa(a,c)}function oa(a,b,c,e,g){c=h(c)?c:!0;e=h(e)?e:!0;if(g=h(g)?g:!1){g=pc(b);var k=f("span");k.innerText=d.dayNames[g]+", ";a.appendChild(k)}Sb(a,b);g=f("span");g.innerText=" "+d.monthNames[b.getMonth()];a.appendChild(g);e&&(e=f("span"),e.innerText=" "+b.getFullYear(),a.appendChild(e));c&&(c=f("span"),c.innerText=" "+uc(b),a.appendChild(c))}function Sb(a,b,c,e){if(h(c)){var g=f("span");g.innerText=c;a.appendChild(g)}c=f("span");c.innerText=b.getDate();a.appendChild(c);d.showDayNumberOrdinals&&
    (c=f("sup"),c.innerText=Yc(b.getDate()),a.appendChild(c));h(e)&&(b=f("span"),b.innerText=e,a.appendChild(b))}function ac(a,b,c,e,g){var k=new Date;k=a===k.getDate()&&e===k.getFullYear()&&c===k.getMonth();var l=ta("calendar-day-"+b);b=f("span");var m=new Date(e,c,a);l.innerHTML="";b.className=g?"day-muted":"";b.className+=k?" today":"";b.innerText=a;if(6===m.getDay()||0===m.getDay()&&"cell"===l.className)l.className="cell weekend-day";l.oncontextmenu=function(n){Ub=m;fa();q(n);vc(n,C)};d.showDayNumberOrdinals&&
    (g=f("sup"),g.innerText=Yc(a),b.appendChild(g));l.appendChild(b);g=f("div","expand-day");l.appendChild(g);u(g,d.expandDayTooltipText);k=Uc(m);if(null!==k){var r=f("span","holiday");r.innerText=k;b.appendChild(r)}g.onclick=function(){db(m,!0)};d.manualEditingEnabled&&(l.ondblclick=function(){ba(null,m)},d.manualEditingEnabled&&(l.ondragover=function(n){q(n);Zc(l)},l.ondragenter=function(n){q(n);Zc(l)},l.ondragleave=function(n){q(n);$c(l)},l.ondrop=function(n){q(n);if(null!==w){n=Ya(w.from,w.to);var ra=
    new Date(e,c,a,w.from.getHours(),w.from.getMinutes()),Ia=new Date(e,c,a,w.to.getHours(),w.to.getMinutes());0<n&&Ia.setDate(Ia.getDate()+n);Ja.updateEvent(w.id,{from:ra,to:Ia,title:w.title,description:w.description,location:w.location,isAllDay:w.isAllDay,color:w.color,colorText:w.colorText,colorBorder:w.colorBorder,repeatEvery:w.repeatEvery,repeatEveryExcludeDays:w.repeatEveryExcludeDays})}$c(l)}))}function Zc(a){-1===a.className.indexOf(" drag-over")&&(a.className+=" drag-over")}function $c(a){-1<
    a.className.indexOf(" drag-over")&&(a.className=a.className.replace(" drag-over",""))}function nb(a,b){return(new Date(a,b+1,0)).getDate()}function Yc(a){var b=d.thText;if(31===a||21===a||1===a)b=d.stText;else if(22===a||2===a)b=d.ndText;else if(23===a||3===a)b=d.rdText;return b}function Uc(a){for(var b=null,c=[],e=d.holidays.length,g=0;g<e;g++){var k=d.holidays[g];aa(k.day)===a.getDate()&&aa(k.month)===a.getMonth()+1&&(k=y(k.title,null),null!==k&&c.push(k))}0<c.length&&(b=c.join(", "));return b}
    function Dd(){null!==C&&x(p.body,C);C=f("div","calendar-drop-down-menu");p.body.appendChild(C);if(d.manualEditingEnabled){var a=f("div","item");a.innerHTML=d.addEventTitle;C.appendChild(a);a.onclick=function(){ba(null,Ub)};a=f("div","separator");C.appendChild(a)}a=f("div","item");a.innerHTML=d.expandDayTooltipText;C.appendChild(a);a.onclick=function(){db(Ub,!0)};a=f("div","separator");C.appendChild(a);a=f("div","item");a.innerHTML=d.listWeekEventsTooltipText;C.appendChild(a);a.onclick=function(){Xa(Ub,
    !0)}}function Ed(){null!==J&&x(p.body,J);if(d.manualEditingEnabled){J=f("div","calendar-drop-down-menu");p.body.appendChild(J);var a=f("div","item");a.innerHTML=d.removeEventText;J.appendChild(a);a.onclick=function(){Ka(p.body,M);var b=function(){x(p.body,M)};ad(d.confirmEventRemoveTitle,d.confirmEventRemoveMessage,function(){b();h(Vb.id)&&(Ja.removeEvent(Vb.id,!0),Wb())},b)};a=f("div","separator");J.appendChild(a);a=f("div","item");a.innerHTML=d.editEventTitle;J.appendChild(a);a.onclick=function(){ba(Vb)}}}
    function Pb(a,b){Vb=b;fa();q(a);vc(a,J)}function lc(){return null!==C&&"block"===C.style.display}function mc(){return null!==J&&"block"===J.style.display}function ka(a,b){try{a.type=b}catch(c){a.type="text"}}function Hb(){ba(null,Q)}function ua(){va.disabled=la.checked}function qb(){var a=!1;Ma.checked&&(A.value=G.value,N.value="00:00",O.value="23:59",a=!0);A.disabled=a;N.disabled=a;O.disabled=a;a=Xb(G);var b=Xb(A);b>a||b<a?(a=!0,la.checked=!0):a=!1;la.disabled=a;rb.disabled=a;sb.disabled=a;tb.disabled=
    a;ub.disabled=a;va.disabled=a;ua()}function ba(a,b){Ka(p.body,M);if(h(a)){wa.value=d.updateText;xa.style.display="block";pb.innerHTML=d.editEventTitle;z=a;G.value=Yb(a.from,G.type);N.value=Zb(a.from);A.value=Yb(a.to,A.type);O.value=Zb(a.to);Ma.checked=a.isAllDay;ja.value=y(a.title);Oa.value=y(a.description);Na.value=y(a.location);ya.value=y(a.color,"#484848");za.value=y(a.colorText,"#F5F5F5");Aa.value=y(a.colorBorder,"#282828");var c=aa(a.repeatEvery);0===c?la.checked=!0:1===c?rb.checked=!0:2===c?
    sb.checked=!0:3===c?tb.checked=!0:4===c&&(ub.checked=!0);c=Da(a.repeatEveryExcludeDays);vb.checked=-1<c.indexOf(1);wb.checked=-1<c.indexOf(2);xb.checked=-1<c.indexOf(3);yb.checked=-1<c.indexOf(4);zb.checked=-1<c.indexOf(5);Ab.checked=-1<c.indexOf(6);Bb.checked=-1<c.indexOf(0)}else{c=new Date;var e=h(b)?b:c,g=new Date;e.getDate()===g.getDate()&&e.getFullYear()===g.getFullYear()&&e.getMonth()===g.getMonth()&&(e.setHours(c.getHours()),e.setMinutes(c.getMinutes()));wa.value=d.addText;xa.style.display=
    "none";pb.innerHTML=d.addEventTitle;z={};G.value=Yb(e,G.type);N.value=Zb(e);A.value=Yb(e,A.type);O.value=Zb(e);Ma.checked=!1;ja.value="";Oa.value="";Na.value="";ya.value="#484848";za.value="#F5F5F5";Aa.value="#282828";la.checked=!0;vb.checked=!1;wb.checked=!1;xb.checked=!1;yb.checked=!1;zb.checked=!1;Ab.checked=!1;Bb.checked=!1}qb();ia.style.display="block";Pa.style.display="none";ja.focus()}function sd(){var a=Xb(G),b=Xb(A),c=N.value.split(":"),e=O.value.split(":"),g=wc(ja.value),k=wc(Oa.value),
    l=wc(Na.value);2>c.length?$b(d.fromTimeErrorMessage,N):2>e.length?$b(d.toTimeErrorMessage,O):""===g?$b(d.titleErrorMessage,ja):(bd(a,N.value),bd(b,O.value),b<a?$b(d.toSmallerThanFromErrorMessage,A):(cc(),a={from:a,to:b,title:g,description:k,location:l,isAllDay:Ma.checked,color:z.color,colorText:z.colorText,colorBorder:z.colorBorder,repeatEveryExcludeDays:z.repeatEveryExcludeDays},la.checked?a.repeatEvery=0:rb.checked?a.repeatEvery=1:sb.checked?a.repeatEvery=2:tb.checked?a.repeatEvery=3:ub.checked&&
    (a.repeatEvery=4),h(z.id)?Ja.updateEvent(z.id,a,!1):Ja.addEvent(a,!1),ha(),Wb()))}function bd(a,b){var c=0,e=0,g=b.split(":");if(2===g.length){var k=parseInt(g[0]);g=parseInt(g[1]);!isNaN(k)&&2>=k.toString().length&&(c=k);!isNaN(g)&&2>=g.toString().length&&(e=g)}a.setHours(c);a.setMinutes(e)}function Xb(a){var b=new Date;if("date"===a.type)b=new Date(a.value);else if(a=a.value.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/))a=new Date(a[3],a[2]-1,a[1]),a instanceof Date&&!isNaN(a)&&(b=a);return b}function cc(){ia.style.display=
    "none";x(p.body,M)}function td(){V.style.display="block";var a=function(){V.style.display="none"};ad(d.confirmEventRemoveTitle,d.confirmEventRemoveMessage,function(){a();cc();h(z.id)&&(Ja.removeEvent(z.id,!0),Wb())},a)}function Yb(a,b){var c=("0"+a.getDate()).slice(-2),e=("0"+(a.getMonth()+1)).slice(-2);return"date"===b?a.getFullYear()+"-"+e+"-"+c:c+"/"+e+"/"+a.getFullYear()}function Zb(a){return E(a.getHours())+":"+E(a.getMinutes())}function E(a){a=a.toString();return 1===a.length?"0"+a:a}function $b(a,
    b){Pa.innerHTML=a;Pa.style.display="block";b.focus()}function wc(a){return a.replace(/^\s+|\s+$/g,"")}function Wb(){jb(na)&&db(Q);jb(pa)&&Pc();jb(qa)&&Xa(ca)}function ud(){Bc();z.color=ya.value;z.colorText=za.value;z.colorBorder=Aa.value}function Bc(){W.style.display="none";V.style.display="none"}function qd(){W.style.display="block";V.style.display="block"}function vd(){Cc();var a=[];vb.checked&&a.push(1);wb.checked&&a.push(2);xb.checked&&a.push(3);yb.checked&&a.push(4);zb.checked&&a.push(5);Ab.checked&&
    a.push(6);Bb.checked&&a.push(0);z.repeatEveryExcludeDays=a}function Cc(){X.style.display="none";V.style.display="none"}function rd(){X.style.display="block";V.style.display="block"}function ad(a,b,c,e){Y.style.display="block";dc.innerHTML=a;ec.innerHTML=b;Qa.onclick=cd;Ra.onclick=cd;Qa.addEventListener("click",c);kc(e)&&Ra.addEventListener("click",e)}function cd(){Y.style.display="none"}function Ib(a){Ka(p.body,M);Z.style.display="block";kb=a;fc.checked=!0}function Gc(){x(p.body,M);Z.style.display=
    "none"}function wd(){Gc();fc.checked?lb(kb,"csv"):Dc.checked?lb(kb,"xml"):Ec.checked?lb(kb,"json"):Fc.checked&&lb(kb,"text")}function xd(a){mb||(mb=!0,dd=a.pageX-D.offsetLeft,ed=a.pageY-D.offsetTop)}function Cd(a){mb&&(D.style.left=a.pageX-dd+"px",D.style.top=a.pageY-ed+"px")}function yd(){mb&&(mb=!1)}function gc(){Ba.disabled=!0;ma.disabled=""===P.value;sa=[];da=0}function Fd(){sa=[];D.style.display="block";P.value="";P.focus();gc()}function zd(){D.style.display="none"}function Bd(){0<da&&(da--,
    fd(),U(sa[da].from))}function Ad(a){13!==a.keyCode||ma.disabled||Ic()}function Ic(){if(0===sa.length){var a=Hc.checked,b=a?P.value:P.value.toLowerCase(),c={};Fb(function(e){var g=a?e.title:e.title.toLowerCase(),k=a?e.description:e.description.toLowerCase();if(-1<g.indexOf(b)||-1<k.indexOf(b))g=e.from.getMonth()+"-"+e.from.getFullYear(),c.hasOwnProperty(g)||(sa.push(e),c[g]=!0)})}else da++;fd();U(sa[da].from)}function fd(){Ba.disabled=0===da;ma.disabled=da===sa.length-1}function Sc(a,b,c){q(a);null!==
    ea&&(clearTimeout(ea),ea=null);ic();"block"!==v.style.display&&(ea=setTimeout(function(){p.body.contains(M)||Kb()||lc()||mc()||(c=h(c)?c:"",v.className=""===c?"calendar-tooltip-event":"calendar-tooltip",""!==c?v.innerHTML=c:(v.innerHTML="",v.appendChild(hc),v.appendChild(Cb),hc.innerHTML=b.title,eb(b.repeatEvery)&&0<b.repeatEvery?(Sa.innerHTML=d.repeatsText.replace(":","")+" "+Fa(b.repeatEvery),Ka(v,Sa)):(Sa.innerHTML="",x(v,Sa)),K(b.location)?(Ua.innerHTML=b.location,Ka(v,Ua)):(Ua.innerHTML="",x(v,
    Ua)),K(b.description)?(Ta.innerHTML=b.description,Ka(v,Ta)):(Ta.innerHTML="",x(v,Ta)),b.from.getDate()===b.to.getDate()?Cb.innerHTML=b.isAllDay?d.allDayText:ab(b.from,b.to):Rb(Cb,b.from,b.to)),vc(a,v))},d.eventTooltipDelay))}function ic(){null!==ea&&(clearTimeout(ea),ea=null);gd()&&(v.style.display="none")}function gd(){return null!==ea||null!==v&&"block"===v.style.display}function u(a,b){a.onmousemove=function(c){Sc(c,null,b)}}function Ld(){null===$a&&0<d.autoRefreshTimerDelay&&($a=setInterval(function(){jc()},
    d.autoRefreshTimerDelay))}function jc(){gd()||p.body.contains(M)||Kb()||lc()||mc()||(Wb(),ha())}function sc(a){jb(a)||(a.className+=" overlay-shown")}function qc(a){jb(a)&&(a.className=a.className.replace(" overlay-shown",""))}function jb(a){return-1<a.className.indexOf("overlay-shown")}function f(a,b,c){a=a.toLowerCase();var e="text"===a;xc.hasOwnProperty(a)||(xc[a]=e?p.createTextNode(""):p.createElement(a));a=xc[a].cloneNode(!1);h(b)&&(a.className=b);h(c)&&(a.type=c);return a}function ta(a){La.hasOwnProperty(a)&&
    null!==La[a]||(La[a]=p.getElementById(a));p.body.contains(La[a])||(La[a]=p.getElementById(a));return La[a]}function Ka(a,b){try{a.contains(b)||a.appendChild(b)}catch(c){console.warn(c.message)}}function x(a,b){try{a.contains(b)&&a.removeChild(b)}catch(c){console.warn(c.message)}}function q(a){a.preventDefault();a.cancelBubble=!0}function vc(a,b){var c=a.pageX,e=a.pageY;b.style.display="block";c+b.offsetWidth>Db.innerWidth?c-=b.offsetWidth:c++;e+b.offsetHeight>Db.innerHeight?e-=b.offsetHeight:e++;
    b.style.left=c+"px";b.style.top=e+"px"}function T(a,b,c,e){var g=f("div","radioButtonContainer");a.appendChild(g);a=f("label","radioButton");g.appendChild(a);g=f("input",null,"radio");g.name=c;a.appendChild(g);h(e)&&(g.onchange=e);c=f("span","check-mark");a.appendChild(c);c=f("span","text");c.innerText=b;a.appendChild(c);return g}function S(a,b,c){var e=f("div");a.appendChild(e);a=f("label","checkbox");a.innerText=b;e.appendChild(a);b=f("input",null,"checkbox");a.appendChild(b);h(c)&&(b.onchange=
    c);c=f("span","check-mark");a.appendChild(c);return b}function h(a){return void 0!==a&&null!==a&&""!==a}function kc(a){return h(a)&&"function"===typeof a}function hd(a){return h(a)&&"string"===typeof a}function eb(a){return h(a)&&"number"===typeof a}function K(a){return hd(a)&&""!==a}function lb(a,b){b=h(b)?b.toLowerCase():"csv";var c="";var e=[];e=h(a)?e.concat(a):Eb();e=Wa(e);if("csv"===b){var g=[d.fromText,d.toText,d.isAllDayText,d.titleText,d.descriptionText,d.locationText,d.backgroundColorText,
    d.textColorText,d.borderColorText,d.repeatsText,d.repeatDaysToExcludeText],k=g.length;c=[];for(var l=[],m=0;m<k;m++)c.push(F(g[m]));l.push(c.join(","));g=e.length;for(k=0;k<g;k++){c=l;m=e[k];var r=[];r.push(F(yc(m.from)));r.push(F(yc(m.to)));r.push(F(m.isAllDay?d.yesText:d.noText));r.push(F(y(m.title)));r.push(F(y(m.description)));r.push(F(y(m.location)));r.push(F(y(m.color)));r.push(F(y(m.colorText)));r.push(F(y(m.colorBorder)));r.push(F(Fa(m.repeatEvery)));r.push(F(Da(m.repeatEveryExcludeDays).join(",")));
    c.push(r.join(","))}c=l.join("\n")}else if("xml"===b){g=[];g.push('<?xml version="1.0" ?>');g.push("<Events>");k=e.length;for(c=0;c<k;c++){m=e[c];g.push("<Event>");for(l in m)m.hasOwnProperty(l)&&(r=id(l),g.push("<"+r+">"+zc(l,m[l])+"</"+r+">"));g.push("</Event>")}g.push("</Events>");c=g.join("\n")}else if("json"===b){l=[];l.push("{");l.push('"events:": [');k=e.length;for(c=0;c<k;c++){m=e[c];l.push("{");for(g in m)m.hasOwnProperty(g)&&l.push('"'+g+'":"'+zc(g,m[g])+'",');m=l[l.length-1];l[l.length-
    1]=m.substring(0,m.length-1);l.push("},")}l[l.length-1]="}";l.push("]");l.push("}");c=l.join("\n")}else if("text"===b){l=[];g=e.length;for(c=0;c<g;c++){m=e[c];for(k in m)m.hasOwnProperty(k)&&l.push(id(k)+": "+zc(k,m[k]));l.push("")}l.pop();c=l.join("\n")}""!==c&&(e=f("a"),g="text"===b?"plain":b,l="text"===b?"txt":b,e.style.display="none",e.setAttribute("target","_blank"),e.setAttribute("href","data:text/"+g+";charset=utf-8,"+encodeURIComponent(c)),g=e.setAttribute,c=new Date,k=E(c.getDate())+"-"+
    E(c.getMonth())+"-"+c.getFullYear(),c=E(c.getHours())+"-"+E(c.getMinutes()),g.call(e,"download",d.exportStartFilename+k+"_"+c+"."+l),p.body.appendChild(e),e.click(),p.body.removeChild(e),Za("onEventsExported"))}function yc(a){var b=E(a.getDate())+"/"+E(a.getMonth())+"/"+a.getFullYear();a=E(a.getHours())+":"+E(a.getMinutes());return b+" "+a}function y(a,b){b=h(b)?b:"";return hd(a)?a:b}function aa(a,b){b=h(b)?b:0;return eb(a)?a:b}function Lc(a,b){b=h(b)?b:0;return h(a)&&"boolean"===typeof a?a?1:0:b}
    function Da(a,b){b=h(b)?b:[];return h(a)&&"object"===typeof a&&a instanceof Array?a:b}function Fa(a){var b=d.repeatsNever;a=aa(a);1===a?b=d.repeatsEveryDayText:2===a?b=d.repeatsEveryWeekText:3===a?b=d.repeatsEveryMonthText:4===a&&(b=d.repeatsEveryYearText);return b}function id(a){return a.charAt(0).toUpperCase()+a.slice(1)}function zc(a,b){var c=y(b);"boolean"===typeof b?c=b?d.yesText:d.noText:"object"===typeof b&&b instanceof Date?c=yc(b):"object"===typeof b&&b instanceof Array?c=Da(b).join(","):
    "number"===typeof b&&(c="repeatEvery"===a?Fa(b):b.toString());return c}function F(a){a=a.replace(/(\r\n|\n|\r)/gm,"").replace(/(\s\s)/gm," ");a=a.replace(/"/g,'""');return'"'+a+'"'}function Mc(){var a=new Date(t);a.setMonth(a.getMonth()-1);a.setDate(1);U(a);Za("onPreviousMonth")}function Oc(){var a=new Date(t);a.setMonth(a.getMonth()+1);a.setDate(1);U(a);Za("onNextMonth")}function Nc(){var a=new Date;if(t.getMonth()!==a.getMonth()||t.getFullYear()!==a.getFullYear())U(),Za("onToday")}var d={},Ja=this,
    t=null,bc=null,xc={},La={},p=null,Db=null,Ac=null,ob=!1,Jc=!1,H={},$a=null,w=null,Rc=null,B=null,Va=null,I=null,Jb=null,Ca=null,M=null,ia=null,V=null,pb=null,G=null,N=null,A=null,O=null,Ma=null,ja=null,Oa=null,Na=null,la=null,rb=null,sb=null,tb=null,ub=null,va=null,Pa=null,z={},wa=null,xa=null,W=null,ya=null,za=null,Aa=null,X=null,vb=null,wb=null,xb=null,yb=null,zb=null,Ab=null,Bb=null,na=null,bb=null,cb=null,Q=null,rc=[],Ea=null,pa=null,fb=null,gb=null,qa=null,R=null,Ga=null,ib=null,Ha={},tc={},
    hb=[],ca=null,Y=null,dc=null,ec=null,Qa=null,Ra=null,Z=null,fc=null,Dc=null,Ec=null,Fc=null,kb=null,v=null,hc=null,Cb=null,Sa=null,Ta=null,Ua=null,ea=null,C=null,Ub=null,J=null,Vb=null,D=null,P=null,Hc=null,Ba=null,ma=null,mb=!1,dd=0,ed=0,sa=[],da=0;this.moveToPreviousMonth=function(){Mc()};this.moveToNextMonth=function(){Oc()};this.moveToToday=function(){Nc()};this.exportAllEvents=function(a){d.exportEventsEnabled&&(a=h(a)?a:"csv",lb(null,a))};this.refresh=function(){jc()};this.addEvents=function(a,
    b,c){b=h(b)?b:!0;c=h(c)?c:!0;for(var e=a.length,g=0;g<e;g++)this.addEvent(a[g],!1,!1);c&&Lb("onEventAdded",a);b&&ha()};this.addEvent=function(a,b,c){var e=!1;if(a.from<=a.to){var g=a.from;g=g.getFullYear()+"-"+g.getMonth()+"-"+g.getDate();var k=Qc();H.hasOwnProperty(g)||(H[g]={});H[g].hasOwnProperty(k)||(b=h(b)?b:!0,c=h(c)?c:!0,h(a.id)?k=a.id:a.id=k,H[g][k]=Kc(a),e=!0,c&&Lb("onEventAdded",a),b&&ha())}return e};this.updateEvent=function(a,b,c,e){if(a=this.removeEvent(a,!1,!1))c=h(c)?c:!0,e=h(e)?e:
    !0,b.id=Qc(),(a=this.addEvent(b,c,!1))&&e&&Lb("onEventUpdated",b);return a};this.removeEvent=function(a,b,c){var e=!1;Fb(function(g,k,l){if(l===a)return b=h(b)?b:!0,c=h(c)?c:!0,delete H[k][l],e=!0,c&&Lb("onEventRemoved",g),b&&ha(),!0});return e};this.clearEvents=function(a){a=h(a)?a:!0;H={};Za("onEventsCleared");a&&ha()};this.setOptions=function(a){d=null!==a&&"object"===typeof a?a:{};h(d.previousMonthTooltipText)||(d.previousMonthTooltipText="Previous Month");h(d.nextMonthTooltipText)||(d.nextMonthTooltipText=
    "Next Month");h(d.previousDayTooltipText)||(d.previousDayTooltipText="Previous Day");h(d.nextDayTooltipText)||(d.nextDayTooltipText="Next Day");h(d.previousWeekTooltipText)||(d.previousWeekTooltipText="Previous Week");h(d.nextWeekTooltipText)||(d.nextWeekTooltipText="Next Week");h(d.addEventTooltipText)||(d.addEventTooltipText="Add Event");h(d.closeTooltipText)||(d.closeTooltipText="Close");h(d.exportEventsTooltipText)||(d.exportEventsTooltipText="Export Events");h(d.todayTooltipText)||(d.todayTooltipText=
    "Today");h(d.refreshTooltipText)||(d.refreshTooltipText="Refresh");h(d.searchTooltipText)||(d.searchTooltipText="Search");h(d.expandDayTooltipText)||(d.expandDayTooltipText="Expand Day");h(d.listAllEventsTooltipText)||(d.listAllEventsTooltipText="View All Events");h(d.listWeekEventsTooltipText)||(d.listWeekEventsTooltipText="View Current Week Events");h(d.dayHeaderNames)||(d.dayHeaderNames="Mon Tue Wed Thu Fri Sat Sun".split(" "));h(d.dayNames)||(d.dayNames="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "));
    h(d.fromText)||(d.fromText="From:");h(d.toText)||(d.toText="To:");h(d.isAllDayText)||(d.isAllDayText="Is All-Day");h(d.titleText)||(d.titleText="Title:");h(d.descriptionText)||(d.descriptionText="Description:");h(d.locationText)||(d.locationText="Location:");h(d.addText)||(d.addText="Add");h(d.updateText)||(d.updateText="Update");h(d.cancelText)||(d.cancelText="Cancel");h(d.removeEventText)||(d.removeEventText="Remove");h(d.addEventTitle)||(d.addEventTitle="Add Event");h(d.editEventTitle)||(d.editEventTitle=
    "Edit Event");h(d.monthNames)||(d.monthNames="January February March April May June July August September October November December".split(" "));h(d.showDayNumberOrdinals)||(d.showDayNumberOrdinals=!0);h(d.dragAndDropForEventsEnabled)||(d.dragAndDropForEventsEnabled=!0);h(d.exportStartFilename)||(d.exportStartFilename="exported_events_");h(d.fromTimeErrorMessage)||(d.fromTimeErrorMessage="Please select a valid 'From' time.");h(d.toTimeErrorMessage)||(d.toTimeErrorMessage="Please select a valid 'To' time.");
    h(d.toSmallerThanFromErrorMessage)||(d.toSmallerThanFromErrorMessage="Please select a 'To' date that is larger than the 'From' date.");h(d.titleErrorMessage)||(d.titleErrorMessage="Please enter a value in the 'Title' field (no empty space).");h(d.stText)||(d.stText="st");h(d.ndText)||(d.ndText="nd");h(d.rdText)||(d.rdText="rd");h(d.thText)||(d.thText="th");h(d.maximumEventsPerDayDisplay)||(d.maximumEventsPerDayDisplay=3);h(d.yesText)||(d.yesText="Yes");h(d.noText)||(d.noText="No");h(d.extraSelectableYearsAhead)||
    (d.extraSelectableYearsAhead=51);h(d.allDayText)||(d.allDayText="All-Day");h(d.allEventsText)||(d.allEventsText="All Events");h(d.exportEventsEnabled)||(d.exportEventsEnabled=!0);h(d.manualEditingEnabled)||(d.manualEditingEnabled=!0);h(d.showTimesInMainCalendarEvents)||(d.showTimesInMainCalendarEvents=!1);h(d.startsOnText)||(d.startsOnText="Starts on the");h(d.andFinishesOnText)||(d.andFinishesOnText="and finishes on the");h(d.toTimeText)||(d.toTimeText="to");h(d.autoRefreshTimerDelay)||(d.autoRefreshTimerDelay=
    5E3);h(d.confirmEventRemoveTitle)||(d.confirmEventRemoveTitle="Confirm Event Removal");h(d.confirmEventRemoveMessage)||(d.confirmEventRemoveMessage="Removing this event cannot be undone.  Do you want to continue?");h(d.okText)||(d.okText="OK");h(d.selectExportTypeTitle)||(d.selectExportTypeTitle="Select Export Type");h(d.fullScreenModeEnabled)||(d.fullScreenModeEnabled=!0);h(d.eventTooltipDelay)||(d.eventTooltipDelay=1E3);h(d.selectColorsText)||(d.selectColorsText="Select Colors");h(d.backgroundColorText)||
    (d.backgroundColorText="Background Color:");h(d.textColorText)||(d.textColorText="Text Color:");h(d.borderColorText)||(d.borderColorText="Border Color:");h(d.searchEventsTitle)||(d.searchEventsTitle="Search Events");h(d.forText)||(d.forText="For:");h(d.previousText)||(d.previousText="Previous");h(d.nextText)||(d.nextText="Next");h(d.matchCaseText)||(d.matchCaseText="Match Case");h(d.minimumDayHeight)||(d.minimumDayHeight=0);h(d.repeatsText)||(d.repeatsText="Repeats:");h(d.repeatDaysToExcludeText)||
    (d.repeatDaysToExcludeText="Repeat Days To Exclude:");h(d.repeatsNever)||(d.repeatsNever="Never");h(d.repeatsEveryDayText)||(d.repeatsEveryDayText="Every Day");h(d.repeatsEveryWeekText)||(d.repeatsEveryWeekText="Every Week");h(d.repeatsEveryMonthText)||(d.repeatsEveryMonthText="Every Month");h(d.repeatsEveryYearText)||(d.repeatsEveryYearText="Every Year");h(d.selectDaysToExcludeTitle)||(d.selectDaysToExcludeTitle="Select Days To Exclude");h(d.moreText)||(d.moreText="More");h(d.holidays)||(d.holidays=
    []);ob&&(ob=!1,U(t))};(function(a,b){p=a;Db=b;Ac=jd;Ja.setOptions(kd);U(ld)})(document,window)};