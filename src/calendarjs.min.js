function calendarJs(Wd,Xd,Yd){function J(a,b){t=h(a)?a:new Date;b=h(b)?b:!1;t.setDate(1);t.setHours(0,0,0,0);var c=(new Date(t.getFullYear(),t.getMonth(),1)).getDay(),e=Kb(t.getFullYear(),t.getMonth());0===c&&(c=7);ya();if(!Lb){A=Ma(Yc);A.className="calendar";A.innerHTML="";Zd();$d();ae();be();var f=g("div","row header-days"),k=d.dayHeaderNames.length;A.appendChild(f);for(var l=0;l<k;l++){var m=d.dayHeaderNames[l],n=g("div","cell");n.innerHTML=m;f.appendChild(n)}for(f=0;6>f;f++)for(k=g("div","row"),
A.appendChild(k),l=0;7>l;l++)m=7*f+(l+1),n=g("div","cell"),n.id="calendar-day-"+m,k.appendChild(n),0<d.minimumDayHeight&&(n.style.height=d.minimumDayHeight+"px");ce();Lb=!0}m=c;if(1<m)for(f=new Date(t),f.setMonth(f.getMonth()-1),k=Kb(f.getFullYear(),f.getMonth()),l=1,m=k-m+1;m<k;m++)uc(m+1,l,f.getMonth(),f.getFullYear(),!0),l++;for(k=f=0;k<e;k++)f=c+k,uc(k+1,f,t.getMonth(),t.getFullYear(),!1);if(42>f){c=1;e=new Date(t);e.setMonth(e.getMonth()+1);for(f+=1;43>f;f++)uc(c,f,e.getMonth(),e.getFullYear(),
!0),c++;c=Kb(e.getFullYear(),e.getMonth());c=Math.round(c/2);vc=new Date(e.getFullYear(),e.getMonth(),c)}else vc=null;ia();b&&(null===R&&(R=g("div","disabled-background")),null!==za&&B(r.body,za),za=g("div","calendar-dialog event-editor"),r.body.appendChild(za),c=g("div","view"),za.appendChild(c),ja=g("div","disabled-area"),c.appendChild(ja),Mb=g("div","title-bar"),c.appendChild(Mb),e=g("div","contents"),c.appendChild(e),c=g("p"),c.innerText=d.titleText,e.appendChild(c),c=g("div","input-title-container"),
e.appendChild(c),Aa=g("input",null,"text"),c.appendChild(Aa),f=g("input","select-colors","button"),f.value="...",f.onclick=de,c.appendChild(f),c=g("p"),c.innerText=d.fromText.replace(":","")+"/"+d.toText,e.appendChild(c),c=g("div","split"),e.appendChild(c),L=g("input"),L.onchange=Nb,c.appendChild(L),ka(L,"date"),S=g("input"),c.appendChild(S),ka(S,"time"),c=g("div","split"),e.appendChild(c),G=g("input"),G.onchange=Nb,c.appendChild(G),ka(G,"date"),T=g("input"),c.appendChild(T),ka(T,"time"),fb=H(e,d.isAllDayText,
Nb)[0],c=g("p"),c.innerText=d.repeatsText,e.appendChild(c),c=g("div","radioButtonsContainer"),e.appendChild(c),Ba=U(c,d.repeatsNever,"RepeatType",Na),Ob=U(c,d.repeatsEveryDayText,"RepeatType",Na),Pb=U(c,d.repeatsEveryWeekText,"RepeatType",Na),Qb=U(c,d.repeatsEveryMonthText,"RepeatType",Na),Rb=U(c,d.repeatsEveryYearText,"RepeatType",Na),Oa=g("input","repeat-options","button"),Oa.value="...",Oa.onclick=ee,c.appendChild(Oa),c=g("p"),c.innerText=d.locationText,e.appendChild(c),gb=g("input",null,"text"),
e.appendChild(gb),c=g("p"),c.innerText=d.descriptionText,e.appendChild(c),hb=g("textarea","custom-scroll-bars"),e.appendChild(hb),ib=g("p","error"),e.appendChild(ib),c=g("div","split"),e.appendChild(c),Pa=g("input","ok","button"),Pa.value=d.addText,Pa.onclick=fe,c.appendChild(Pa),f=g("input","cancel","button"),f.value=d.cancelText,f.onclick=wc,c.appendChild(f),Qa=g("input","remove","button"),Qa.value=d.removeEventText,Qa.onclick=ge,e.appendChild(Qa),null!==la&&B(r.body,la),la=g("div","calendar-dialog event-editor-colors"),
r.body.appendChild(la),e=g("div","title-bar"),e.innerHTML=d.selectColorsText,la.appendChild(e),e=g("div","contents"),la.appendChild(e),c=g("p"),c.innerText=d.backgroundColorText,e.appendChild(c),Ra=g("input"),e.appendChild(Ra),ka(Ra,"color"),c=g("p"),c.innerText=d.textColorText,e.appendChild(c),Sa=g("input"),e.appendChild(Sa),ka(Sa,"color"),c=g("p"),c.innerText=d.borderColorText,e.appendChild(c),Ta=g("input"),e.appendChild(Ta),ka(Ta,"color"),c=g("div","split"),e.appendChild(c),e=g("input","ok","button"),
e.value=d.okText,e.onclick=he,c.appendChild(e),e=g("input","cancel","button"),e.value=d.cancelText,e.onclick=Zc,c.appendChild(e),null!==ma&&B(r.body,ma),ma=g("div","calendar-dialog event-editor-repeat-options"),r.body.appendChild(ma),e=g("div","title-bar"),e.innerHTML=d.repeatOptionsTitle,ma.appendChild(e),e=g("div","contents"),ma.appendChild(e),c=g("p"),c.innerText=d.daysToExcludeText,e.appendChild(c),Sb=H(e,d.dayNames[0])[0],Tb=H(e,d.dayNames[1])[0],Ub=H(e,d.dayNames[2])[0],Vb=H(e,d.dayNames[3])[0],
Wb=H(e,d.dayNames[4])[0],Xb=H(e,d.dayNames[5])[0],Yb=H(e,d.dayNames[6])[0],c=g("p"),c.innerText=d.repeatEndsText,e.appendChild(c),Ca=g("input"),e.appendChild(Ca),ka(Ca,"date"),c=g("div","split"),e.appendChild(c),e=g("input","ok","button"),e.value=d.okText,e.onclick=ie,c.appendChild(e),e=g("input","cancel","button"),e.value=d.cancelText,e.onclick=$c,c.appendChild(e),null!==na&&B(r.body,na),na=g("div","calendar-dialog confirmation"),r.body.appendChild(na),xc=g("div","title-bar"),na.appendChild(xc),
e=g("div","contents"),na.appendChild(e),yc=g("div","message"),e.appendChild(yc),c=H(e,d.removeAllEventsInSeriesText),Zb=c[0],zc=c[1],c=g("div","split"),e.appendChild(c),jb=g("input","yes","button"),jb.value=d.yesText,c.appendChild(jb),kb=g("input","no","button"),kb.value=d.noText,c.appendChild(kb),null!==oa&&B(r.body,oa),oa=g("div","calendar-dialog select-export-type"),r.body.appendChild(oa),e=g("div","title-bar"),e.innerHTML=d.selectExportTypeTitle,oa.appendChild(e),c=g("div","contents"),oa.appendChild(c),
e=g("div","radioButtonsContainer"),c.appendChild(e),Ac=U(e,"CSV","ExportType"),ad=U(e,"XML","ExportType"),bd=U(e,"JSON","ExportType"),cd=U(e,"TEXT","ExportType"),dd=U(e,"iCAL","ExportType"),e=g("div","split"),c.appendChild(e),c=g("input","ok","button"),c.value=d.okText,c.onclick=je,e.appendChild(c),c=g("input","cancel","button"),c.value=d.cancelText,c.onclick=ed,e.appendChild(c),null!==z&&B(r.body,z),z=g("div","calendar-dialog search"),r.body.appendChild(z),e=g("div","title-bar"),e.innerHTML=d.searchEventsTitle,
e.onmousedown=ke,e.onmouseup=le,z.appendChild(e),c=g("div","ib-close"),c.onclick=me,e.appendChild(c),p(c,d.closeTooltipText),pa=g("div","ib-minus"),pa.onclick=fd,e.appendChild(pa),p(pa,d.minimizedTooltipText),K=g("div","contents"),z.appendChild(K),e=g("p"),e.innerText=d.forText,K.appendChild(e),V=g("input",null,"text"),V.oninput=Da,V.onpropertychange=Da,V.onkeypress=ne,K.appendChild(V),gd=H(K,d.matchCaseText,Da)[0],e=g("p"),e.innerText=d.includeText,K.appendChild(e),e=g("div","checkboxContainer"),
K.appendChild(e),hd=H(e,d.titleText.replace(":",""),Da)[0],id=H(e,d.locationText.replace(":",""),Da)[0],jd=H(e,d.descriptionText.replace(":",""),Da)[0],e=g("div","split"),K.appendChild(e),Ua=g("input","previous","button"),Ua.value=d.previousText,Ua.onclick=oe,e.appendChild(Ua),Ea=g("input","next","button"),Ea.value=d.nextText,Ea.onclick=kd,e.appendChild(Ea),r.body.addEventListener("mousemove",pe),null===w&&(w=g("div"),r.body.appendChild(w),Bc=g("div","title"),$b=g("div","date"),lb=g("div","repeats"),
mb=g("div","description"),nb=g("div","location"),document.body.addEventListener("mousemove",Cc)),qe(),re());ob.innerHTML=d.monthNames[t.getMonth()]+", "+t.getFullYear()+" \u25be"}function pb(){var a=[];qb(function(b){a.push(b)});return a}function qb(a){for(var b in M)if(M.hasOwnProperty(b))for(var c in M[b])if(M[b].hasOwnProperty(c)){var e=ld(M[b][c]);if(a(e,b,c))return}}function Fa(a,b){b=h(b)?b:!0;a=a.sort(function(c,e){return c.from-e.from});b&&(a=a.sort(function(c,e){return md(e.isAllDay)-md(c.isAllDay)}));
return a}function be(){C=g("div","header-date");A.appendChild(C);d.fullScreenModeEnabled&&(C.ondblclick=aa);var a=g("div","ib-arrow-left-full");a.onclick=Dc;a.ondblclick=q;C.appendChild(a);p(a,d.previousMonthTooltipText);a=g("div","ib-pin");a.onclick=Ec;a.ondblclick=q;C.appendChild(a);p(a,d.todayTooltipText);a=g("div","ib-refresh");a.onclick=rb;a.ondblclick=q;C.appendChild(a);p(a,d.refreshTooltipText);a=g("div","ib-search");a.onclick=nd;a.ondblclick=q;C.appendChild(a);p(a,d.searchTooltipText);a=g("div",
"ib-arrow-right-full");a.onclick=Fc;a.ondblclick=q;C.appendChild(a);p(a,d.nextMonthTooltipText);d.manualEditingEnabled&&(a=g("div","ib-plus"),a.onclick=ac,a.ondblclick=q,C.appendChild(a),p(a,d.addEventTooltipText));d.exportEventsEnabled&&(Va=g("div","ib-arrow-down-full-line"),Va.ondblclick=q,C.appendChild(Va),p(Va,d.exportEventsTooltipText),Va.onclick=function(){bc()});a=g("div","ib-eye");a.ondblclick=q;C.appendChild(a);a.onclick=function(){od(!0)};p(a,d.listAllEventsTooltipText);a=g("div","ib-hamburger");
a.ondblclick=q;C.appendChild(a);a.onclick=function(){sb(null,!0)};p(a,d.listWeekEventsTooltipText);d.fullScreenModeEnabled&&(ba=g("div","ib-arrow-expand-left-right"),ba.ondblclick=q,ba.onclick=aa,C.appendChild(ba),p(ba,d.enableFullScreenTooltipText));a=g("div","title-container");C.appendChild(a);ob=g("span");ob.ondblclick=q;a.appendChild(ob);se(a)}function se(a){var b=new Date(1900,1,1),c=(new Date).getFullYear()-b.getFullYear()+d.extraSelectableYearsAhead;N=g("div","years-drop-down");a.appendChild(N);
cc=g("div","contents custom-scroll-bars");N.appendChild(cc);for(a=0;a<c;a++)te(b.getFullYear()),b.setFullYear(b.getFullYear()+1);ob.onclick=ue}function te(a){var b=g("div");b.innerText=a.toString();b.id="year-selected-"+a.toString();cc.appendChild(b);b.onclick=function(){t.setFullYear(a);J(t);dc()&&(N.style.display="none")}}function ld(a){a.isAllDay&&(a.from=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),0,0),a.to=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),
23,59));return a}function ue(a){if("block"!==N.style.display){ya();q(a);a=N.getElementsByClassName("current-year-selected");if(1<=a.length)for(var b=a.length,c=0;c<b;c++)a[c].removeAttribute("class");a=Ma("year-selected-"+t.getFullYear());null!==a&&(a.className="current-year-selected");N.style.display="block";cc.scrollTop=a.offsetTop-N.offsetHeight/2}}function dc(){return null!==N&&"block"===N.style.display}function qa(a){if(null!==d&&Gc(d[a]))d[a]()}function ec(a,b){if(null!==d&&Gc(d[a]))d[a](b)}
function pd(){for(var a=[],b=0;32>b;b++){8!==b&&12!==b&&16!==b&&20!==b||a.push("-");var c=Math.floor(16*Math.random()).toString(16);a.push(c)}return a.join("")}function aa(){Wa?qd():rd()}function rd(){!Wa&&d.fullScreenModeEnabled&&(sd=A.style.cssText,Wa=!0,ba.className="ib-arrow-contract-left-right",ca.className="ib-arrow-contract-left-right",da.className="ib-arrow-contract-left-right",ea.className="ib-arrow-contract-left-right",p(ba,d.disableFullScreenTooltipText),p(ca,d.disableFullScreenTooltipText),
p(da,d.disableFullScreenTooltipText),p(ea,d.disableFullScreenTooltipText),A.className+=" full-screen-view",A.removeAttribute("style"))}function qd(){Wa&&d.fullScreenModeEnabled&&(Wa=!1,ba.className="ib-arrow-expand-left-right",ca.className="ib-arrow-expand-left-right",da.className="ib-arrow-expand-left-right",ea.className="ib-arrow-expand-left-right",p(ba,d.enableFullScreenTooltipText),p(ca,d.enableFullScreenTooltipText),p(da,d.enableFullScreenTooltipText),p(ea,d.enableFullScreenTooltipText),A.className=
A.className.replace(" full-screen-view",""),A.style.cssText=sd)}function ce(){td||(r.body.addEventListener("click",ya),r.body.addEventListener("contextmenu",ya),Ga.addEventListener("resize",ya),Ga.addEventListener("resize",ud),r.addEventListener("keydown",function(a){Wa&&vd()&&(37===a.keyCode&&(a.ctrlKey||a.metaKey)?(a.preventDefault(),wd()):39===a.keyCode&&(a.ctrlKey||a.metaKey)?(a.preventDefault(),xd()):70===a.keyCode&&(a.ctrlKey||a.metaKey)?(a.preventDefault(),nd()):27===a.keyCode?aa():37===a.keyCode?
Dc():39===a.keyCode?Fc():40===a.keyCode?Ec():116===a.keyCode&&rb())}),td=!0)}function ya(){Hc()&&(I.style.display="none");Ic()&&(O.style.display="none");dc()&&(N.style.display="none");Cc()}function fc(a,b){return a.getDate()===b.getDate()&&a.getMonth()===b.getMonth()&&a.getFullYear()===b.getFullYear()}function Jc(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate());c.setHours(0,0,0,0);var e=new Date(b.getFullYear(),b.getMonth(),b.getDate());e.setHours(0,0,0,0);return c<=e}function tb(a,b){var c=
null;if(h(a)){c=("0"+a.getDate()).slice(-2);var e=("0"+(a.getMonth()+1)).slice(-2);c="date"===b?a.getFullYear()+"-"+e+"-"+c:c+"/"+e+"/"+a.getFullYear()}return c}function Xa(a){var b=("0"+a.getDate()).slice(-2),c=("0"+a.getMonth()).slice(-2);return b+"/"+c+"/"+a.getFullYear()}function gc(a){return D(a.getHours())+":"+D(a.getMinutes())}function Kc(a){return 0>a.getDay()-1?6:a.getDay()-1}function ve(a){a=h(a)?a:new Date;var b=0===a.getDay()?7:a.getDay();b=a.getDate()-b+1;var c=b+6,e=new Date(a);a=new Date(a);
e.setDate(b);e.setHours(0,0,0,0);a.setDate(c);a.setHours(23,59,59,99);return[e,a]}function Kb(a,b){return(new Date(a,b+1,0)).getDate()}function yd(a){var b=d.thText;if(31===a||21===a||1===a)b=d.stText;else if(22===a||2===a)b=d.ndText;else if(23===a||3===a)b=d.rdText;return b}function zd(a){var b=a.getHours();a=a.getMinutes();return 60*b+a}function ub(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate()),e=new Date(b.getFullYear(),b.getMonth(),b.getDate());return Math.ceil(Math.abs(e-c)/864E5)}
function ia(){we();Ad();for(var a=Fa(pb()),b=a.length,c=0;c<b;c++){var e=a[c];null!==hc(e.from)&&xe(e);var f=W(e.repeatEvery);0<f&&(1===f?ic(e,function(k){k.setDate(k.getDate()+1)}):2===f?ic(e,function(k){k.setDate(k.getDate()+7)}):3===f?ic(e,function(k){k.setMonth(k.getMonth()+1)}):4===f&&ic(e,function(k){k.setFullYear(k.getFullYear()+1)}))}d.exportEventsEnabled&&(Va.style.display=0===b?"none":"inline-block");Bd()}function ic(a,b){for(var c=new Date(a.from),e=X(a.repeatEveryExcludeDays),f=X(a.seriesIgnoreDates);c<
vc;){b(c);var k=Xa(c),l=!(!h(a.repeatEnds)||Jc(c,a.repeatEnds));-1!==e.indexOf(c.getDay())||-1!==f.indexOf(k)||l||null!==hc(c)&&Lc(c,a)}}function xe(a){Lc(a.from,a);if(a.from.getDate()!==a.to.getDate()){var b=ub(a.from,a.to);if(0<b)for(var c=new Date(a.from),e=0;e<b;e++)c.setDate(c.getDate()+1),null!==hc(c)&&Lc(c,a)}}function Lc(a,b){var c=hc(a);if(null!==c){var e=d.manualEditingEnabled?"event":"event-no-hover";if(c.getElementsByClassName(e).length<d.maximumEventsPerDayDisplay||0>=d.maximumEventsPerDayDisplay){e=
g("div",e);var f=b.title;d.showTimesInMainCalendarEvents&&!b.isAllDay&&b.from.getDate()===b.to.getDate()&&(f=vb(b.from,b.to)+": "+f);e.innerHTML=f;c.appendChild(e);Cd(e,b);jc(e,b,Mc(b,a));e.onmousemove=function(m){Dd(m,b)};if(d.manualEditingEnabled){var k=Xa(a);e.oncontextmenu=function(m){kc(m,b,k)}}d.manualEditingEnabled&&(e.onclick=function(){ra(b)})}else if(e=c.getElementsByClassName("plus-x-events"),e=0<e.length?e[0]:null,null===e){var l=new Date(a);e=g("div","plus-x-events");e.setAttribute("events",
"1");e.innerHTML="+1 "+d.moreText;e.ondblclick=q;c.appendChild(e);e.onclick=function(){Ha(l,!0)}}else c=parseInt(e.getAttribute("events"))+1,e.setAttribute("events",c.toString()),e.innerHTML="+"+c+" "+d.moreText}}function hc(a){var b=new Date(t.getFullYear(),t.getMonth(),1);var c=new Date(t);var e=new Date(t),f=null,k=0;b=Kc(b);c.setMonth(c.getMonth()+1);e.setMonth(e.getMonth()-1);a.getMonth()===c.getMonth()&&a.getFullYear()===c.getFullYear()?(c=b+Kb(t.getFullYear(),t.getMonth()),k=a.getDate()+c):
a.getMonth()===e.getMonth()&&a.getFullYear()===e.getFullYear()?k=b-ub(a,t)+1:a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear()&&(c=b,k=a.getDate()+c);0<k&&(f=Ma("calendar-day-"+k));return f}function we(){for(var a=0;6>a;a++)for(var b=0;7>b;b++){var c=Ma("calendar-day-"+(7*a+(b+1)));lc(c,d.manualEditingEnabled?"event":"event-no-hover");lc(c,"plus-x-events")}}function lc(a,b){for(var c=a.getElementsByClassName(b);c[0];)c[0].parentNode.removeChild(c[0])}function jc(a,b,c){h(c)&&c<new Date&&
(a.className+=" expired");P(b.color)?(a.style.backgroundColor=b.color,P(b.colorText)&&(a.style.color=b.colorText),P(b.colorBorder)&&(a.style.borderLeftColor=b.colorBorder)):b.isAllDay&&(a.className+=" all-day")}function Mc(a,b){var c=W(a.repeatEvery),e=new Date(a.to);0<c&&(c=new Date(b),c.setHours(e.getHours(),e.getMinutes()),e=c);return e}function ae(){Ia=g("div","full-day-view");A.appendChild(Ia);var a=g("div","title-bar");Ia.appendChild(a);d.fullScreenModeEnabled&&(a.ondblclick=aa);wb=g("div",
"title");a.appendChild(wb);var b=g("div","ib-close");b.ondblclick=q;a.appendChild(b);p(b,d.closeTooltipText);b.onclick=function(){mc(Ia);Y=null};d.manualEditingEnabled&&(b=g("div","ib-plus"),b.onclick=ac,b.ondblclick=q,a.appendChild(b),p(b,d.addEventTooltipText));b=g("div","ib-arrow-right-full");b.onclick=ye;b.ondblclick=q;a.appendChild(b);p(b,d.nextDayTooltipText);b=g("div","ib-arrow-left-full");b.onclick=ze;b.ondblclick=q;a.appendChild(b);p(b,d.previousDayTooltipText);d.exportEventsEnabled&&(Ya=
g("div","ib-arrow-down-full-line"),Ya.ondblclick=q,a.appendChild(Ya),p(Ya,d.exportEventsTooltipText),Ya.onclick=function(){bc(Nc)});d.fullScreenModeEnabled&&(ca=g("div","ib-arrow-expand-left-right"),ca.ondblclick=q,ca.onclick=aa,a.appendChild(ca),p(ca,d.enableFullScreenTooltipText));fa=g("div","contents custom-scroll-bars");Ia.appendChild(fa);Ja=g("div","content-events-all-day");fa.appendChild(Ja);a=g("div","all-day-text");a.innerHTML=d.allDayText;Ja.appendChild(a);xb=g("div","contents-events");fa.appendChild(xb);
for(a=0;24>a;a++){b=g("div","hour");xb.appendChild(b);var c=g("div","hour-text");c.innerHTML=D(a)+":00";b.appendChild(c);c=g("div","hour-text");c.innerHTML=D(a)+":30";b.appendChild(c)}}function Ha(a,b){b=h(b)?b:!1;wb.innerText="";Y=new Date(a);Nc=[];Ja.style.display="block";lc(fa,d.manualEditingEnabled?"event":"event-no-hover");Oc(Ia);Ka(wb,a,!1,!0,!0);var c=Ed(a),e=[];if(null!==c){var f=g("span","holiday");f.innerText=" ("+c+")";wb.appendChild(f)}qb(function(m){for(var n=ub(m.from,m.to)+1,v=new Date(m.from),
sa=0;sa<n;sa++){if(fc(v,a)){e.push(m);break}v.setDate(v.getDate()+1)}n=W(m.repeatEvery);0<n&&(1===n?nc(m,e,a,function(E){E.setDate(E.getDate()+1)}):2===n?nc(m,e,a,function(E){E.setDate(E.getDate()+7)}):3===n?nc(m,e,a,function(E){E.setMonth(E.getMonth()+1)}):4===n&&nc(m,e,a,function(E){E.setFullYear(E.getFullYear()+1)}))});e=Fa(e);c=e.length;f=null;for(var k=0;k<c;k++){var l=Ae(e[k],a);null===f&&(f=l)}b&&(fa.scrollTop=f-fa.offsetHeight/2);1>=Ja.offsetHeight&&(Ja.style.display="none");d.exportEventsEnabled&&
(Ya.style.display=0===e.length?"none":"inline-block")}function nc(a,b,c,e){for(var f=new Date(a.from),k=X(a.repeatEveryExcludeDays),l=X(a.seriesIgnoreDates);f<c;){e(f);var m=Xa(f),n=!(!h(a.repeatEnds)||Jc(f,a.repeatEnds));if(-1===k.indexOf(f.getDay())&&-1===l.indexOf(m)&&!n&&fc(f,c)){b.push(a);break}}}function Ae(a,b){var c=g("div",d.manualEditingEnabled?"event":"event-no-hover");a.isAllDay?Ja.appendChild(c):xb.appendChild(c);if(d.manualEditingEnabled){var e=Xa(b);c.oncontextmenu=function(k){kc(k,
a,e)}}jc(c,a,Mc(a,b));var f=g("div","title");f.innerHTML=a.title;c.appendChild(f);f=g("div","date");c.appendChild(f);a.from.getDate()===a.to.getDate()?f.innerHTML=a.isAllDay?d.allDayText:vb(a.from,a.to):oc(f,a.from,a.to);yb(a.repeatEvery)&&0<a.repeatEvery&&(f=g("div","repeats"),f.innerHTML=d.repeatsText.replace(":","")+" "+Za(a.repeatEvery),c.appendChild(f));P(a.location)&&(f=g("div","location"),f.innerHTML=a.location,c.appendChild(f));P(a.description)&&(f=g("div","description"),f.innerHTML=a.description,
c.appendChild(f));d.manualEditingEnabled&&(c.onclick=function(){ra(a)});f=0;a.isAllDay||(f=Be(b,c,a));return f}function Be(a,b,c){var e=xb.offsetHeight,f=e/1440,k=d.spacing,l=null;Nc.push(c);if(!c.isAllDay){l=W(c.repeatEvery);if(fc(c.from,a)||0<l)k=f*zd(c.from);l=fc(c.to,a)?f*zd(c.to)-k:e;l-=2*d.spacing}b.style.top=k+"px";null!==l&&(b.style.height=l+"px");b.offsetTop+b.offsetHeight>e-d.spacing&&(b.style.height=e-b.offsetTop-3*d.spacing+"px");a=k+fa.offsetHeight/2;a<=fa.offsetHeight&&(a=0);return a}
function ze(){Y.setDate(Y.getDate()-1);Ha(Y,!0)}function ye(){Y.setDate(Y.getDate()+1);Ha(Y,!0)}function Zd(){ta=g("div","list-all-events-view");A.appendChild(ta);var a=g("div","title-bar");ta.appendChild(a);d.fullScreenModeEnabled&&(a.ondblclick=aa);var b=g("div","title");b.innerHTML=d.allEventsText;a.appendChild(b);b=g("div","ib-close");b.ondblclick=q;a.appendChild(b);p(b,d.closeTooltipText);b.onclick=function(){mc(ta)};d.manualEditingEnabled&&(b=g("div","ib-plus"),b.onclick=ac,b.ondblclick=q,a.appendChild(b),
p(b,d.addEventTooltipText));d.exportEventsEnabled&&(zb=g("div","ib-arrow-down-full-line"),zb.ondblclick=q,a.appendChild(zb),p(zb,d.exportEventsTooltipText),zb.onclick=function(){bc()});d.fullScreenModeEnabled&&(da=g("div","ib-arrow-expand-left-right"),da.ondblclick=q,da.onclick=aa,a.appendChild(da),p(da,d.enableFullScreenTooltipText));Ab=g("div","contents custom-scroll-bars");ta.appendChild(Ab)}function od(a){a=h(a)?a:!1;Oc(ta);Ab.innerHTML="";a&&(Ab.scrollTop=0);a=Fa(pb());for(var b=a.length,c=0;c<
b;c++){var e=a[c],f=Ce(e.from);De(e,f)}}function De(a,b){var c=g("div",d.manualEditingEnabled?"event":"event-no-hover");b.appendChild(c);d.manualEditingEnabled&&(c.oncontextmenu=function(f){kc(f,a)});jc(c,a);var e=g("div","title");e.innerHTML=a.title;c.appendChild(e);e=g("div","date");c.appendChild(e);a.from.getDate()===a.to.getDate()?a.isAllDay?pc(e,a.from,null," - "+d.allDayText):pc(e,a.from,null," - "+vb(a.from,a.to)):oc(e,a.from,a.to);yb(a.repeatEvery)&&0<a.repeatEvery&&(e=g("div","repeats"),
e.innerHTML=d.repeatsText.replace(":","")+" "+Za(a.repeatEvery),c.appendChild(e));P(a.location)&&(e=g("div","location"),e.innerHTML=a.location,c.appendChild(e));P(a.description)&&(e=g("div","description"),e.innerHTML=a.description,c.appendChild(e));d.manualEditingEnabled&&(c.onclick=function(){ra(a)})}function Ce(a){var b="month-"+a.getMonth()+"-"+a.getFullYear(),c=Ma(b),e=new Date(a);if(null===c){var f=g("div","month");Ab.appendChild(f);c=g("div","header");c.innerHTML=d.monthNames[a.getMonth()]+
" "+a.getFullYear();f.appendChild(c);a=g("div","ib-arrow-expand-left-right");a.ondblclick=q;c.appendChild(a);a.onclick=function(){mc(ta);J(e)};p(a,d.expandMonthTooltipText);c=g("div","events");c.id=b;f.appendChild(c)}return c}function $d(){La=g("div","list-all-week-events-view");A.appendChild(La);var a=g("div","title-bar");La.appendChild(a);d.fullScreenModeEnabled&&(a.ondblclick=aa);Z=g("div","title");a.appendChild(Z);var b=g("div","ib-close");b.ondblclick=q;a.appendChild(b);p(b,d.closeTooltipText);
b.onclick=function(){mc(La)};d.manualEditingEnabled&&(b=g("div","ib-plus"),b.onclick=ac,b.ondblclick=q,a.appendChild(b),p(b,d.addEventTooltipText));b=g("div","ib-arrow-right-full");b.onclick=Ee;b.ondblclick=q;a.appendChild(b);p(b,d.nextWeekTooltipText);b=g("div","ib-arrow-left-full");b.onclick=Fe;b.ondblclick=q;a.appendChild(b);p(b,d.previousWeekTooltipText);d.exportEventsEnabled&&($a=g("div","ib-arrow-down-full-line"),$a.ondblclick=q,a.appendChild($a),p($a,d.exportEventsTooltipText),$a.onclick=function(){bc(Bb)});
d.fullScreenModeEnabled&&(ea=g("div","ib-arrow-expand-left-right"),ea.ondblclick=q,ea.onclick=aa,a.appendChild(ea),p(ea,d.enableFullScreenTooltipText));Cb=g("div","contents custom-scroll-bars");La.appendChild(Cb)}function sb(a,b){b=h(b)?b:!1;Oc(La);Cb.innerHTML="";ab={};Pc={};Bb=[];ua=null===a?new Date:new Date(a);b&&(Cb.scrollTop=0);var c=ve(a),e=c[0];c=c[1];Ge(e,c);He(e,c);for(var f=Fa(pb()),k=f.length,l=0;l<k;l++){for(var m=f[l],n=ub(m.from,m.to)+1,v=new Date(m.from),sa=!1,E=0;E<n;E++)v>=e&&v<=
c&&(sa=Qc(v),Fd(m,sa,v),sa=!0),v.setDate(v.getDate()+1);sa&&Bb.push(m);n=W(m.repeatEvery);v=!1;0<n&&(1===n?v=qc(m,e,c,function(Q){Q.setDate(Q.getDate()+1)}):2===n?v=qc(m,e,c,function(Q){Q.setDate(Q.getDate()+7)}):3===n?v=qc(m,e,c,function(Q){Q.setMonth(Q.getMonth()+1)}):4===n&&(v=qc(m,e,c,function(Q){Q.setFullYear(Q.getFullYear()+1)})));v&&!sa&&Bb.push(m)}for(var Gd in ab)ab.hasOwnProperty(Gd)&&Cb.appendChild(ab[Gd]);d.exportEventsEnabled&&($a.style.display=0===Bb.length?"none":"inline-block")}function qc(a,
b,c,e){for(var f=new Date(a.from),k=X(a.repeatEveryExcludeDays),l=X(a.seriesIgnoreDates),m=!1;f<c;){e(f);var n=Xa(f),v=!(!h(a.repeatEnds)||Jc(f,a.repeatEnds));-1===k.indexOf(f.getDay())&&-1===l.indexOf(n)&&!v&&f>=b&&f<=c&&(m=Qc(f),Fd(a,m,f),m=!0)}return m}function He(a,b){Z.innerHTML="";if(a.getFullYear()===b.getFullYear()){Ka(Z,a,!1,!1);var c=g("span");c.innerHTML=" - ";Z.appendChild(c);Ka(Z,b,!1,!1);c=g("span");c.innerHTML=", "+a.getFullYear();Z.appendChild(c)}else Ka(Z,a,!1,!0),c=g("span"),c.innerHTML=
" - ",Z.appendChild(c),Ka(Z,b,!1,!0)}function Fd(a,b,c){lc(b,"no-events-text");var e=g("div",d.manualEditingEnabled?"event":"event-no-hover");b.appendChild(e);if(d.manualEditingEnabled){var f=Xa(c);e.oncontextmenu=function(k){kc(k,a,f)}}Cd(e,a);jc(e,a,Mc(a,c));b=g("div","title");b.innerHTML=a.title;e.appendChild(b);b=g("div","date");e.appendChild(b);a.from.getDate()===a.to.getDate()?b.innerHTML=a.isAllDay?d.allDayText:vb(a.from,a.to):oc(b,a.from,a.to);yb(a.repeatEvery)&&0<a.repeatEvery&&(b=g("div",
"repeats"),b.innerHTML=d.repeatsText.replace(":","")+" "+Za(a.repeatEvery),e.appendChild(b));P(a.location)&&(b=g("div","location"),b.innerHTML=a.location,e.appendChild(b));P(a.description)&&(b=g("div","description"),b.innerHTML=a.description,e.appendChild(b));d.manualEditingEnabled&&(e.onclick=function(){ra(a)})}function Ge(a,b){var c=new Date(a);do Qc(c),c.setDate(c.getDate()+1);while(c<b)}function Qc(a){var b=Kc(a),c=a.getFullYear()+a.getMonth()+b,e=null,f=new Date(a);if(ab.hasOwnProperty(c))e=
Pc[c];else{var k=g("div","day");ab[c]=k;Hd(k,f.getFullYear(),f.getMonth(),f.getDate());e=g("div","header");k.appendChild(e);pc(e,a,d.dayNames[b]+", ");a=g("div","ib-arrow-expand-left-right");a.ondblclick=q;e.appendChild(a);a.onclick=function(){Ha(f,!0)};p(a,d.expandDayTooltipText);e=g("div","events");k.appendChild(e);k=g("div","no-events-text");k.innerHTML=d.noEventsAvailableText;e.appendChild(k);Pc[c]=e}return e}function Fe(){ua.setDate(ua.getDate()-7);sb(ua,!0)}function Ee(){ua.setDate(ua.getDate()+
7);sb(ua,!0)}function vb(a,b){return Rc(a)+" "+d.toTimeText+" "+Rc(b)}function Rc(a){return D(a.getHours())+":"+D(a.getMinutes())}function oc(a,b,c){a.innerHTML="";var e=g("span");e.innerText=d.startsOnText+" ";a.appendChild(e);Ka(a,b);b=g("span");b.innerText=" "+d.andFinishesOnText+" ";a.appendChild(b);Ka(a,c)}function Ka(a,b,c,e,f){c=h(c)?c:!0;e=h(e)?e:!0;if(f=h(f)?f:!1){f=Kc(b);var k=g("span");k.innerText=d.dayNames[f]+", ";a.appendChild(k)}pc(a,b);f=g("span");f.innerText=" "+d.monthNames[b.getMonth()];
a.appendChild(f);e&&(e=g("span"),e.innerText=" "+b.getFullYear(),a.appendChild(e));c&&(c=g("span"),c.innerText=" "+Rc(b),a.appendChild(c))}function pc(a,b,c,e){if(h(c)){var f=g("span");f.innerText=c;a.appendChild(f)}c=g("span");c.innerText=b.getDate();a.appendChild(c);d.showDayNumberOrdinals&&(c=g("sup"),c.innerText=yd(b.getDate()),a.appendChild(c));h(e)&&(b=g("span"),b.innerText=e,a.appendChild(b))}function uc(a,b,c,e,f){var k=new Date,l=a===k.getDate()&&e===k.getFullYear()&&c===k.getMonth();b=Ma("calendar-day-"+
b);k=g("span");var m=new Date(e,c,a);b.innerHTML="";k.className=f?"day-muted":"";k.className+=l?" today":"";k.innerText=a;if(6===m.getDay()||0===m.getDay()&&"cell"===b.className)b.className="cell weekend-day";b.oncontextmenu=function(v){rc=new Date(m);ya();q(v);Sc(v,I)};d.showDayNumberOrdinals&&(f=g("sup"),f.innerText=yd(a),k.appendChild(f));b.appendChild(k);f=g("div","ib-arrow-top-right");b.appendChild(f);p(f,d.expandDayTooltipText);l=Ed(m);if(null!==l){var n=g("span","holiday");n.innerText=l;k.appendChild(n)}f.onclick=
function(){Ha(m,!0)};d.manualEditingEnabled&&(b.ondblclick=function(){ra(null,m)},Hd(b,e,c,a))}function Ed(a){for(var b=null,c=[],e=d.holidays.length,f=0;f<e;f++){var k=d.holidays[f];W(k.day)===a.getDate()&&W(k.month)===a.getMonth()+1&&(k=u(k.title,null),null!==k&&c.push(k))}0<c.length&&(b=c.join(", "));return b}function Cd(a,b){d.dragAndDropForEventsEnabled&&d.manualEditingEnabled&&(a.setAttribute("draggable",!0),a.ondragstart=function(){x=b})}function Hd(a,b,c,e){d.dragAndDropForEventsEnabled&&
d.manualEditingEnabled&&(a.ondragover=function(f){q(f);Id(a)},a.ondragenter=function(f){q(f);Id(a)},a.ondragleave=function(f){q(f);Jd(a)},a.ondrop=function(f){q(f);if(null!==x){f=ub(x.from,x.to);var k=new Date(b,c,e,x.from.getHours(),x.from.getMinutes()),l=new Date(b,c,e,x.to.getHours(),x.to.getMinutes());0<f&&l.setDate(l.getDate()+f);Db.updateEvent(x.id,{from:k,to:l,title:x.title,description:x.description,location:x.location,isAllDay:x.isAllDay,color:x.color,colorText:x.colorText,colorBorder:x.colorBorder,
repeatEvery:x.repeatEvery,repeatEveryExcludeDays:x.repeatEveryExcludeDays});rb()}Jd(a)})}function Id(a){-1===a.className.indexOf(" drag-over")&&(a.className+=" drag-over")}function Jd(a){-1<a.className.indexOf(" drag-over")&&(a.className=a.className.replace(" drag-over",""))}function qe(){null!==I&&B(r.body,I);I=g("div","calendar-drop-down-menu");r.body.appendChild(I);if(d.manualEditingEnabled){var a=g("div","item");a.innerHTML=d.addEventTitle;I.appendChild(a);a.onclick=function(){ra(null,rc)};a=
g("div","separator");I.appendChild(a)}a=g("div","item");a.innerHTML=d.expandDayTooltipText;I.appendChild(a);a.onclick=function(){Ha(rc,!0)};a=g("div","separator");I.appendChild(a);a=g("div","item");a.innerHTML=d.viewWeekEventsText;I.appendChild(a);a.onclick=function(){sb(rc,!0)}}function re(){null!==O&&B(r.body,O);if(d.manualEditingEnabled){O=g("div","calendar-drop-down-menu");r.body.appendChild(O);var a=g("div","item");a.innerHTML=d.removeEventText;O.appendChild(a);a.onclick=function(){bb(r.body,
R);var b=function(){B(r.body,R)},c=0<W(va.repeatEvery)&&null!==Eb;Kd(d.confirmEventRemoveTitle,d.confirmEventRemoveMessage,function(){b();h(va.id)&&(Zb.checked||null===Eb?Db.removeEvent(va.id,!0):(Tc(va.seriesIgnoreDates)?va.seriesIgnoreDates.push(Eb):va.seriesIgnoreDates=[Eb],ia()),sc())},b,c)};a=g("div","separator");O.appendChild(a);a=g("div","item");a.innerHTML=d.editEventTitle;O.appendChild(a);a.onclick=function(){ra(va)}}}function kc(a,b,c){va=b;Eb=h(c)?c:null;ya();q(a);Sc(a,O)}function Hc(){return null!==
I&&"block"===I.style.display}function Ic(){return null!==O&&"block"===O.style.display}function ka(a,b){try{a.type=b}catch(c){a.type="text"}}function ac(){ra(null,Y)}function Na(){Oa.disabled=Ba.checked}function Nb(){var a=!1;fb.checked&&(G.value=L.value,S.value="00:00",T.value="23:59",a=!0);G.disabled=a;S.disabled=a;T.disabled=a;a=Fb(L);var b=Fb(G);b>a||b<a?(a=!0,Ba.checked=!0):a=!1;Ba.disabled=a;Ob.disabled=a;Pb.disabled=a;Qb.disabled=a;Rb.disabled=a;Oa.disabled=a;Na()}function ra(a,b){bb(r.body,
R);if(h(a)){Pa.value=d.updateText;Qa.style.display="block";Mb.innerHTML=d.editEventTitle;F=a;L.value=tb(a.from,L.type);S.value=gc(a.from);G.value=tb(a.to,G.type);T.value=gc(a.to);fb.checked=a.isAllDay;Aa.value=u(a.title);hb.value=u(a.description);gb.value=u(a.location);Ra.value=u(a.color,"#484848");Sa.value=u(a.colorText,"#F5F5F5");Ta.value=u(a.colorBorder,"#282828");var c=W(a.repeatEvery);0===c?Ba.checked=!0:1===c?Ob.checked=!0:2===c?Pb.checked=!0:3===c?Qb.checked=!0:4===c&&(Rb.checked=!0);c=X(a.repeatEveryExcludeDays);
Sb.checked=-1<c.indexOf(1);Tb.checked=-1<c.indexOf(2);Ub.checked=-1<c.indexOf(3);Vb.checked=-1<c.indexOf(4);Wb.checked=-1<c.indexOf(5);Xb.checked=-1<c.indexOf(6);Yb.checked=-1<c.indexOf(0);Ca.value=tb(a.repeatEnds,Ca.type)}else{c=new Date;var e=h(b)?b:c,f=new Date;e.getDate()===f.getDate()&&e.getFullYear()===f.getFullYear()&&e.getMonth()===f.getMonth()&&(e.setHours(c.getHours()),e.setMinutes(c.getMinutes()));Pa.value=d.addText;Qa.style.display="none";Mb.innerHTML=d.addEventTitle;F={};L.value=tb(e,
L.type);S.value=gc(e);G.value=tb(e,G.type);T.value=gc(e);fb.checked=!1;Aa.value="";hb.value="";gb.value="";Ra.value="#484848";Sa.value="#F5F5F5";Ta.value="#282828";Ba.checked=!0;Sb.checked=!1;Tb.checked=!1;Ub.checked=!1;Vb.checked=!1;Wb.checked=!1;Xb.checked=!1;Yb.checked=!1;Ca.value=null}Nb();za.style.display="block";ib.style.display="none";Aa.focus()}function fe(){var a=Fb(L),b=Fb(G),c=S.value.split(":"),e=T.value.split(":"),f=Uc(Aa.value),k=Uc(hb.value),l=Uc(gb.value),m=Fb(Ca,null);2>c.length?
tc(d.fromTimeErrorMessage,S):2>e.length?tc(d.toTimeErrorMessage,T):""===f?tc(d.titleErrorMessage,Aa):(Ld(a,S.value),Ld(b,T.value),b<a?tc(d.toSmallerThanFromErrorMessage,G):(wc(),c=h(F.id),a={from:a,to:b,title:f,description:k,location:l,isAllDay:fb.checked,color:F.color,colorText:F.colorText,colorBorder:F.colorBorder,repeatEveryExcludeDays:F.repeatEveryExcludeDays,repeatEnds:m},Ba.checked?a.repeatEvery=0:Ob.checked?a.repeatEvery=1:Pb.checked?a.repeatEvery=2:Qb.checked?a.repeatEvery=3:Rb.checked&&(a.repeatEvery=
4),c||(a.organizerName=d.organizerName,a.organizerEmailAddress=d.organizerEmailAddress),c?Db.updateEvent(F.id,a,!1):Db.addEvent(a,!1),ia(),sc()))}function Ld(a,b){var c=0,e=0,f=b.split(":");if(2===f.length){var k=parseInt(f[0]);f=parseInt(f[1]);!isNaN(k)&&2>=k.toString().length&&(c=k);!isNaN(f)&&2>=f.toString().length&&(e=f)}a.setHours(c);a.setMinutes(e)}function Fb(a,b){var c=void 0!==b?b:new Date;if(""!==a.value)if("date"===a.type)c=new Date(a.value);else{var e=a.value.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);
e&&(e=new Date(e[3],e[2]-1,e[1]),e instanceof Date&&!isNaN(e)&&(c=e))}return c}function wc(){za.style.display="none";B(r.body,R)}function ge(){ja.style.display="block";var a=function(){ja.style.display="none"};Kd(d.confirmEventRemoveTitle,d.confirmEventRemoveMessage,function(){a();wc();h(F.id)&&(Db.removeEvent(F.id,!0),sc())},a)}function D(a){a=a.toString();return 1===a.length?"0"+a:a}function tc(a,b){ib.innerHTML=a;ib.style.display="block";b.focus()}function Uc(a){return a.replace(/^\s+|\s+$/g,"")}
function sc(){Gb(Ia)&&Ha(Y);Gb(ta)&&od();Gb(La)&&sb(ua)}function he(){Zc();F.color=Ra.value;F.colorText=Sa.value;F.colorBorder=Ta.value}function Zc(){la.style.display="none";ja.style.display="none"}function de(){la.style.display="block";ja.style.display="block"}function ie(){$c();var a=[];Sb.checked&&a.push(1);Tb.checked&&a.push(2);Ub.checked&&a.push(3);Vb.checked&&a.push(4);Wb.checked&&a.push(5);Xb.checked&&a.push(6);Yb.checked&&a.push(0);F.repeatEveryExcludeDays=a}function $c(){ma.style.display=
"none";ja.style.display="none"}function ee(){ma.style.display="block";ja.style.display="block"}function Kd(a,b,c,e,f){f=h(f)?f:!1;na.style.display="block";xc.innerHTML=a;yc.innerHTML=b;jb.onclick=Md;kb.onclick=Md;jb.addEventListener("click",c);f?(zc.style.display="block",Zb.checked=!1):(zc.style.display="none",Zb.checked=!0);Gc(e)&&kb.addEventListener("click",e)}function Md(){na.style.display="none"}function bc(a){bb(r.body,R);oa.style.display="block";cb=a;Ac.checked=!0}function ed(){B(r.body,R);
oa.style.display="none"}function je(){ed();Ac.checked?db(cb,"csv"):ad.checked?db(cb,"xml"):bd.checked?db(cb,"json"):cd.checked?db(cb,"text"):dd.checked&&db(cb,"ical")}function ke(a){Hb||(Hb=!0,Nd=a.pageX-z.offsetLeft,Od=a.pageY-z.offsetTop)}function pe(a){Hb&&(z.style.left=a.pageX-Nd+"px",z.style.top=a.pageY-Od+"px")}function le(){Hb&&(Hb=!1,Pd=!0)}function Da(){Ua.disabled=!0;Ea.disabled=""===V.value;ha=[];wa=0}function nd(){"block"!==z.style.display&&(ha=[],z.style.display="block",V.value="",ud(),
Da());"block"!==K.style.display&&fd();V.focus()}function ud(){Pd||(z.style.left=Ga.innerWidth/2-z.offsetWidth/2+"px",z.style.top=Ga.innerHeight/2-z.offsetHeight/2+"px")}function me(){z.style.display="none"}function fd(){"block"===K.style.display?(K.style.display="none",pa.className="ib-square-hollow",p(pa,d.restoreTooltipText)):(K.style.display="block",pa.className="ib-minus",p(pa,d.minimizedTooltipText))}function oe(){0<wa&&(wa--,Qd(),J(ha[wa].from))}function ne(a){13!==a.keyCode||Ea.disabled||kd()}
function kd(){if(0===ha.length){var a=gd.checked,b=a?V.value:V.value.toLowerCase(),c={};qb(function(e){var f=u(e.title),k=u(e.location),l=u(e.description),m=!1;a||(f=f.toLowerCase(),l=l.toLowerCase(),k=k.toLowerCase());hd.checked&&-1<f.indexOf(b)?m=!0:id.checked&&-1<k.indexOf(b)?m=!0:jd.checked&&-1<l.indexOf(b)&&(m=!0);m&&(f=e.from.getMonth()+"-"+e.from.getFullYear(),c.hasOwnProperty(f)||(ha.push(e),c[f]=!0))})}else wa++;Qd();0<ha.length&&J(ha[wa].from)}function Qd(){Ua.disabled=0===wa;Ea.disabled=
wa===ha.length-1||0===ha.length}function Dd(a,b,c){q(a);null!==xa&&(clearTimeout(xa),xa=null);Cc();"block"!==w.style.display&&(xa=setTimeout(function(){r.body.contains(R)||dc()||Hc()||Ic()||(c=h(c)?c:"",w.className=""===c?"calendar-tooltip-event":"calendar-tooltip",""!==c?w.innerHTML=c:(w.innerHTML="",w.appendChild(Bc),w.appendChild($b),Bc.innerHTML=b.title,yb(b.repeatEvery)&&0<b.repeatEvery?(lb.innerHTML=d.repeatsText.replace(":","")+" "+Za(b.repeatEvery),bb(w,lb)):(lb.innerHTML="",B(w,lb)),P(b.location)?
(nb.innerHTML=b.location,bb(w,nb)):(nb.innerHTML="",B(w,nb)),P(b.description)?(mb.innerHTML=b.description,bb(w,mb)):(mb.innerHTML="",B(w,mb)),b.from.getDate()===b.to.getDate()?$b.innerHTML=b.isAllDay?d.allDayText:vb(b.from,b.to):oc($b,b.from,b.to)),Sc(a,w))},d.eventTooltipDelay))}function Cc(){null!==xa&&(clearTimeout(xa),xa=null);Rd()&&(w.style.display="none")}function Rd(){return null!==xa||null!==w&&"block"===w.style.display}function p(a,b){a.onmousemove=function(c){Dd(c,null,b)}}function Bd(){null===
Ib&&0<d.autoRefreshTimerDelay&&(Ib=setInterval(function(){rb()},d.autoRefreshTimerDelay))}function Ad(){null!==Ib&&0<d.autoRefreshTimerDelay&&(clearTimeout(Ib),Ib=null)}function rb(){vd()&&(sc(),ia())}function vd(){return!Rd()&&!r.body.contains(R)&&!dc()&&!Hc()&&!Ic()}function Oc(a){Gb(a)||(a.className+=" overlay-shown")}function mc(a){Gb(a)&&(a.className=a.className.replace(" overlay-shown",""))}function Gb(a){return-1<a.className.indexOf("overlay-shown")}function g(a,b,c){a=a.toLowerCase();var e=
"text"===a;Vc.hasOwnProperty(a)||(Vc[a]=e?r.createTextNode(""):r.createElement(a));a=Vc[a].cloneNode(!1);h(b)&&(a.className=b);h(c)&&(a.type=c);return a}function Ma(a){eb.hasOwnProperty(a)&&null!==eb[a]||(eb[a]=r.getElementById(a));r.body.contains(eb[a])||(eb[a]=r.getElementById(a));return eb[a]}function bb(a,b){try{a.contains(b)||a.appendChild(b)}catch(c){console.warn(c.message)}}function B(a,b){try{a.contains(b)&&a.removeChild(b)}catch(c){console.warn(c.message)}}function q(a){a.preventDefault();
a.cancelBubble=!0}function Sc(a,b){var c=a.pageX,e=a.pageY;b.style.display="block";c+b.offsetWidth>Ga.innerWidth?c-=b.offsetWidth:c++;e+b.offsetHeight>Ga.innerHeight?e-=b.offsetHeight:e++;b.style.left=c+"px";b.style.top=e+"px"}function U(a,b,c,e){var f=g("div","radioButtonContainer");a.appendChild(f);a=g("label","radioButton");f.appendChild(a);f=g("input",null,"radio");f.name=c;a.appendChild(f);h(e)&&(f.onchange=e);c=g("span","check-mark");a.appendChild(c);c=g("span","text");c.innerText=b;a.appendChild(c);
return f}function H(a,b,c){var e=g("div");a.appendChild(e);a=g("label","checkbox");a.innerText=b;e.appendChild(a);b=g("input",null,"checkbox");a.appendChild(b);h(c)&&(b.onchange=c);c=g("span","check-mark");a.appendChild(c);return[b,a]}function h(a){return void 0!==a&&null!==a&&""!==a}function Gc(a){return h(a)&&"function"===typeof a}function Sd(a){return h(a)&&"string"===typeof a}function yb(a){return h(a)&&"number"===typeof a}function Tc(a){return h(a)&&"object"===typeof a&&a instanceof Array}function P(a){return Sd(a)&&
""!==a}function db(a,b){b=h(b)?b.toLowerCase():"csv";var c="",e=[];e=h(a)?e.concat(a):pb();e=Fa(e);e=Fa(e,!1);if("csv"===b){var f=[d.idText,d.fromText,d.toText,d.isAllDayText,d.titleText,d.descriptionText,d.locationText,d.backgroundColorText,d.textColorText,d.borderColorText,d.repeatsText,d.repeatEndsText,d.repeatDaysToExcludeText,d.seriesIgnoreDatesText,d.createdText,d.organizerNameText,d.organizerEmailAddressText];c=f.length;for(var k=[],l=[],m=0;m<c;m++)k.push(y(f[m]));l.push(k.join(","));f=e.length;
for(c=0;c<f;c++){k=l;m=e[c];var n=[];n.push(y(u(m.id)));n.push(y(Jb(m.from)));n.push(y(Jb(m.to)));n.push(y(m.isAllDay?d.yesText:d.noText));n.push(y(u(m.title)));n.push(y(u(m.description)));n.push(y(u(m.location)));n.push(y(u(m.color)));n.push(y(u(m.colorText)));n.push(y(u(m.colorBorder)));n.push(y(Za(m.repeatEvery)));n.push(y(Jb(m.repeatEnds)));n.push(y(Td(m.repeatEveryExcludeDays)));n.push(y(X(m.seriesIgnoreDates).join(",")));n.push(y(Jb(m.created)));n.push(y(u(m.organizerName)));n.push(y(u(m.organizerEmailAddress)));
k.push(n.join(","))}c=l.join("\n")}else if("xml"===b){f=[];f.push('<?xml version="1.0" ?>');f.push("<Events>");c=e.length;for(k=0;k<c;k++){m=e[k];f.push("<Event>");for(l in m)m.hasOwnProperty(l)&&null!==m[l]&&(n=Ud(l),f.push("<"+n+">"+Wc(l,m[l])+"</"+n+">"));f.push("</Event>")}f.push("</Events>");c=f.join("\n")}else if("json"===b){l=[];l.push("{");l.push('"events:": [');c=e.length;for(k=0;k<c;k++){m=e[k];l.push("{");for(f in m)m.hasOwnProperty(f)&&null!==m[f]&&l.push('"'+f+'":"'+Wc(f,m[f])+'",');
m=l[l.length-1];l[l.length-1]=m.substring(0,m.length-1);l.push("},")}l[l.length-1]="}";l.push("]");l.push("}");c=l.join("\n")}else if("text"===b){l=[];f=e.length;for(c=0;c<f;c++){m=e[c];for(k in m)m.hasOwnProperty(k)&&null!==m[k]&&l.push(Ud(k)+": "+Wc(k,m[k]));l.push("")}l.pop();c=l.join("\n")}else if("ical"===b){l=[];l.push("BEGIN:VCALENDAR");l.push("VERSION:2.0");l.push("PRODID:-//hacksw/handcal//NONSGML v1.0//EN");f=e.length;for(c=0;c<f;c++)k=e[c],l.push("BEGIN:VEVENT"),l.push("UID:"+u(k.id)),
l.push("DTSTAMP:"+Xc(k.created)),l.push("ORGANIZER;CN="+u(k.organizerName)+":MAILTO:"+u(k.organizerEmailAddress)),l.push("DTSTART:"+Xc(k.from)),l.push("DTEND:"+Xc(k.to)),l.push("SUMMARY:"+u(k.title)),l.push("END:VEVENT");l.push("END:VCALENDAR");c=l.join("\n")}""!==c&&(e=g("a"),l="text",f=k=b,"text"===b?(k="plain",f="txt"):"ical"===b?(k="calendar",f="ics"):"json"===b&&(l="application"),e.style.display="none",e.setAttribute("target","_blank"),e.setAttribute("href","data:"+l+"/"+k+";charset=utf-8,"+
encodeURIComponent(c)),l=e.setAttribute,k=new Date,c=D(k.getDate())+"-"+D(k.getMonth())+"-"+k.getFullYear(),k=D(k.getHours())+"-"+D(k.getMinutes()),l.call(e,"download",d.exportStartFilename+c+"_"+k+"."+f),r.body.appendChild(e),e.click(),r.body.removeChild(e),qa("onEventsExported"))}function Jb(a){var b=d.repeatsNever;h(a)&&(b=D(a.getDate())+"/"+D(a.getMonth())+"/"+a.getFullYear(),a=D(a.getHours())+":"+D(a.getMinutes()),b=b+" "+a);return b}function u(a,b){b=h(b)?b:"";return Sd(a)?a:b}function W(a,
b){b=h(b)?b:0;return yb(a)?a:b}function md(a,b){b=h(b)?b:0;return h(a)&&"boolean"===typeof a?a?1:0:b}function X(a,b){b=h(b)?b:[];return Tc(a)?a:b}function Za(a){var b=d.repeatsNever;a=W(a);1===a?b=d.repeatsEveryDayText:2===a?b=d.repeatsEveryWeekText:3===a?b=d.repeatsEveryMonthText:4===a&&(b=d.repeatsEveryYearText);return b}function Ud(a){return a.charAt(0).toUpperCase()+a.slice(1)}function Wc(a,b){var c=u(b);"boolean"===typeof b?c=b?d.yesText:d.noText:"object"===typeof b&&b instanceof Date?c=Jb(b):
"object"===typeof b&&b instanceof Array?c="repeatEveryExcludeDays"===a?Td(b):X(b).join(","):"number"===typeof b&&(c="repeatEvery"===a?Za(b):b.toString());return c}function Xc(a){var b=[];b.push(a.getFullYear());b.push(a.getMonth());b.push(a.getDate());b.push("T");b.push(a.getHours());b.push(a.getMinutes());b.push("00");b.push("Z");return b.join("")}function Td(a){var b=[];if(Tc(a))for(var c=a.length,e=0;e<c;e++){var f=a[e]-1;-1===f&&(f=6);b.push(d.dayNames[f])}return X(b).join(",")}function y(a){a=
a.replace(/(\r\n|\n|\r)/gm,"").replace(/(\s\s)/gm," ");a=a.replace(/"/g,'""');return'"'+a+'"'}function Dc(){var a=new Date(t);a.setMonth(a.getMonth()-1);J(a);qa("onPreviousMonth")}function Fc(){var a=new Date(t);a.setMonth(a.getMonth()+1);J(a);qa("onNextMonth")}function wd(){var a=new Date(t);a.setFullYear(a.getFullYear()-1);J(a);qa("onPreviousYear")}function xd(){var a=new Date(t);a.setFullYear(a.getFullYear()+1);J(a);qa("onNextYear")}function Ec(){var a=new Date;if(t.getMonth()!==a.getMonth()||
t.getFullYear()!==a.getFullYear())J(),qa("onToday")}function Vd(a){h(a)&&"object"===typeof a||(a={});return a}var d={},Db=this,t=null,vc=null,Vc={},eb={},r=null,Ga=null,Yc=null,Lb=!1,td=!1,M={},Ib=null,x=null,sd=null,Wa=!1,A=null,C=null,ob=null,N=null,cc=null,Va=null,ba=null,R=null,za=null,ja=null,Mb=null,L=null,S=null,G=null,T=null,fb=null,Aa=null,hb=null,gb=null,Ba=null,Ob=null,Pb=null,Qb=null,Rb=null,Oa=null,ib=null,F={},Pa=null,Qa=null,la=null,Ra=null,Sa=null,Ta=null,ma=null,Sb=null,Tb=null,Ub=
null,Vb=null,Wb=null,Xb=null,Yb=null,Ca=null,Ia=null,wb=null,fa=null,Ja=null,xb=null,Y=null,Nc=[],Ya=null,ca=null,ta=null,zb=null,da=null,Ab=null,La=null,Z=null,$a=null,ea=null,Cb=null,ab={},Pc={},Bb=[],ua=null,na=null,xc=null,yc=null,Zb=null,zc=null,jb=null,kb=null,oa=null,Ac=null,ad=null,bd=null,cd=null,dd=null,cb=null,w=null,Bc=null,$b=null,lb=null,mb=null,nb=null,xa=null,I=null,rc=null,O=null,va=null,Eb=null,z=null,pa=null,K=null,V=null,gd=null,hd=null,id=null,jd=null,Ua=null,Ea=null,Hb=!1,Pd=
!1,Nd=0,Od=0,ha=[],wa=0;this.turnOnFullScreen=function(){rd()};this.turnOffFullScreen=function(){qd()};this.startTheAutoRefreshTimer=function(){Bd()};this.stopTheAutoRefreshTimer=function(){Ad()};this.moveToPreviousMonth=function(){Dc()};this.moveToNextMonth=function(){Fc()};this.moveToPreviousYear=function(){wd()};this.moveToNextYear=function(){xd()};this.moveToToday=function(){Ec()};this.getCurrentDisplayDate=function(){return new Date(t)};this.setCurrentDisplayDate=function(a){J(new Date(a));qa("onSetDate")};
this.exportAllEvents=function(a){d.exportEventsEnabled&&(a=h(a)?a:"csv",db(null,a))};this.refresh=function(){rb()};this.addEvents=function(a,b,c){b=h(b)?b:!0;c=h(c)?c:!0;for(var e=a.length,f=0;f<e;f++)this.addEvent(a[f],!1,!1);c&&ec("onEventAdded",a);b&&ia()};this.addEvent=function(a,b,c){var e=!1;if(a.from<=a.to){var f=a.from;f=f.getFullYear()+"-"+f.getMonth()+"-"+f.getDate();var k=pd();M.hasOwnProperty(f)||(M[f]={});M[f].hasOwnProperty(k)||(b=h(b)?b:!0,c=h(c)?c:!0,h(a.id)?k=a.id:a.id=k,h(a.created)||
(a.created=new Date),M[f][k]=ld(a),e=!0,c&&ec("onEventAdded",a),b&&ia())}return e};this.updateEvent=function(a,b,c,e){if(a=this.removeEvent(a,!1,!1))c=h(c)?c:!0,e=h(e)?e:!0,b.id=pd(),(a=this.addEvent(b,c,!1))&&e&&ec("onEventUpdated",b);return a};this.removeEvent=function(a,b,c){var e=!1;qb(function(f,k,l){if(l===a)return b=h(b)?b:!0,c=h(c)?c:!0,delete M[k][l],e=!0,c&&ec("onEventRemoved",f),b&&ia(),!0});return e};this.clearEvents=function(a){a=h(a)?a:!0;M={};qa("onEventsCleared");a&&ia()};this.getEvents=
function(){return Fa(pb())};this.getEvent=function(a){var b=null;qb(function(c,e,f){if(f===a)return b=c,!0});return b};this.setOptions=function(a){a=Vd(a);for(var b in a)a.hasOwnProperty(b)&&(d[b]=a[b]);Lb&&(Lb=!1,J(t,!0))};(function(a,b){r=a;Ga=b;Yc=Wd;d=Vd(Xd);h(d.previousMonthTooltipText)||(d.previousMonthTooltipText="Previous Month");h(d.nextMonthTooltipText)||(d.nextMonthTooltipText="Next Month");h(d.previousDayTooltipText)||(d.previousDayTooltipText="Previous Day");h(d.nextDayTooltipText)||
(d.nextDayTooltipText="Next Day");h(d.previousWeekTooltipText)||(d.previousWeekTooltipText="Previous Week");h(d.nextWeekTooltipText)||(d.nextWeekTooltipText="Next Week");h(d.addEventTooltipText)||(d.addEventTooltipText="Add Event");h(d.closeTooltipText)||(d.closeTooltipText="Close");h(d.exportEventsTooltipText)||(d.exportEventsTooltipText="Export Events");h(d.todayTooltipText)||(d.todayTooltipText="Today");h(d.refreshTooltipText)||(d.refreshTooltipText="Refresh");h(d.searchTooltipText)||(d.searchTooltipText=
"Search");h(d.expandDayTooltipText)||(d.expandDayTooltipText="Expand Day");h(d.listAllEventsTooltipText)||(d.listAllEventsTooltipText="View All Events");h(d.listWeekEventsTooltipText)||(d.listWeekEventsTooltipText="View Current Week Events");h(d.dayHeaderNames)||(d.dayHeaderNames="Mon Tue Wed Thu Fri Sat Sun".split(" "));h(d.dayNames)||(d.dayNames="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "));h(d.fromText)||(d.fromText="From:");h(d.toText)||(d.toText="To:");h(d.isAllDayText)||
(d.isAllDayText="Is All-Day");h(d.titleText)||(d.titleText="Title:");h(d.descriptionText)||(d.descriptionText="Description:");h(d.locationText)||(d.locationText="Location:");h(d.addText)||(d.addText="Add");h(d.updateText)||(d.updateText="Update");h(d.cancelText)||(d.cancelText="Cancel");h(d.removeEventText)||(d.removeEventText="Remove");h(d.addEventTitle)||(d.addEventTitle="Add Event");h(d.editEventTitle)||(d.editEventTitle="Edit Event");h(d.monthNames)||(d.monthNames="January February March April May June July August September October November December".split(" "));
h(d.showDayNumberOrdinals)||(d.showDayNumberOrdinals=!0);h(d.dragAndDropForEventsEnabled)||(d.dragAndDropForEventsEnabled=!0);h(d.exportStartFilename)||(d.exportStartFilename="exported_events_");h(d.fromTimeErrorMessage)||(d.fromTimeErrorMessage="Please select a valid 'From' time.");h(d.toTimeErrorMessage)||(d.toTimeErrorMessage="Please select a valid 'To' time.");h(d.toSmallerThanFromErrorMessage)||(d.toSmallerThanFromErrorMessage="Please select a 'To' date that is larger than the 'From' date.");
h(d.titleErrorMessage)||(d.titleErrorMessage="Please enter a value in the 'Title' field (no empty space).");h(d.stText)||(d.stText="st");h(d.ndText)||(d.ndText="nd");h(d.rdText)||(d.rdText="rd");h(d.thText)||(d.thText="th");h(d.maximumEventsPerDayDisplay)||(d.maximumEventsPerDayDisplay=3);h(d.yesText)||(d.yesText="Yes");h(d.noText)||(d.noText="No");h(d.extraSelectableYearsAhead)||(d.extraSelectableYearsAhead=51);h(d.allDayText)||(d.allDayText="All-Day");h(d.allEventsText)||(d.allEventsText="All Events");
h(d.exportEventsEnabled)||(d.exportEventsEnabled=!0);h(d.manualEditingEnabled)||(d.manualEditingEnabled=!0);h(d.showTimesInMainCalendarEvents)||(d.showTimesInMainCalendarEvents=!1);h(d.startsOnText)||(d.startsOnText="Starts on the");h(d.andFinishesOnText)||(d.andFinishesOnText="and finishes on the");h(d.toTimeText)||(d.toTimeText="to");h(d.autoRefreshTimerDelay)||(d.autoRefreshTimerDelay=5E3);h(d.confirmEventRemoveTitle)||(d.confirmEventRemoveTitle="Confirm Event Removal");h(d.confirmEventRemoveMessage)||
(d.confirmEventRemoveMessage="Removing this event cannot be undone.  Do you want to continue?");h(d.okText)||(d.okText="OK");h(d.selectExportTypeTitle)||(d.selectExportTypeTitle="Select Export Type");h(d.fullScreenModeEnabled)||(d.fullScreenModeEnabled=!0);h(d.eventTooltipDelay)||(d.eventTooltipDelay=1E3);h(d.selectColorsText)||(d.selectColorsText="Select Colors");h(d.backgroundColorText)||(d.backgroundColorText="Background Color:");h(d.textColorText)||(d.textColorText="Text Color:");h(d.borderColorText)||
(d.borderColorText="Border Color:");h(d.searchEventsTitle)||(d.searchEventsTitle="Search Events");h(d.forText)||(d.forText="For:");h(d.previousText)||(d.previousText="Previous");h(d.nextText)||(d.nextText="Next");h(d.matchCaseText)||(d.matchCaseText="Match Case");h(d.minimumDayHeight)||(d.minimumDayHeight=0);h(d.repeatsText)||(d.repeatsText="Repeats:");h(d.repeatDaysToExcludeText)||(d.repeatDaysToExcludeText="Repeat Days To Exclude:");h(d.daysToExcludeText)||(d.daysToExcludeText="Days To Exclude:");
h(d.seriesIgnoreDatesText)||(d.seriesIgnoreDatesText="Series Ignore Dates:");h(d.repeatsNever)||(d.repeatsNever="Never");h(d.repeatsEveryDayText)||(d.repeatsEveryDayText="Every Day");h(d.repeatsEveryWeekText)||(d.repeatsEveryWeekText="Every Week");h(d.repeatsEveryMonthText)||(d.repeatsEveryMonthText="Every Month");h(d.repeatsEveryYearText)||(d.repeatsEveryYearText="Every Year");h(d.repeatOptionsTitle)||(d.repeatOptionsTitle="Repeat Options");h(d.moreText)||(d.moreText="More");h(d.includeText)||(d.includeText=
"Include:");h(d.holidays)||(d.holidays=[{day:24,month:12,title:"Christmas Eve"},{day:25,month:12,title:"Christmas Day"},{day:26,month:12,title:"Boxing Day"},{day:31,month:12,title:"New Year's Eve"},{day:1,month:1,title:"New Year's Day"}]);h(d.minimizedTooltipText)||(d.minimizedTooltipText="Minimize");h(d.restoreTooltipText)||(d.restoreTooltipText="Restore");h(d.removeAllEventsInSeriesText)||(d.removeAllEventsInSeriesText="Remove All Events In Series");h(d.createdText)||(d.createdText="Created:");
h(d.organizerName)||(d.organizerName="");h(d.organizerEmailAddress)||(d.organizerEmailAddress="");h(d.organizerNameText)||(d.organizerNameText="Organizer:");h(d.organizerEmailAddressText)||(d.organizerEmailAddressText="Organizer Email:");h(d.enableFullScreenTooltipText)||(d.enableFullScreenTooltipText="Turn On Full-Screen Mode");h(d.disableFullScreenTooltipText)||(d.disableFullScreenTooltipText="Turn Off Full-Screen Mode");h(d.idText)||(d.idText="ID:");h(d.spacing)||(d.spacing=10);h(d.expandMonthTooltipText)||
(d.expandMonthTooltipText="Expand Month");h(d.repeatEndsText)||(d.repeatEndsText="Repeat Ends:");h(d.noEventsAvailableText)||(d.noEventsAvailableText="No events available");h(d.viewWeekEventsText)||(d.viewWeekEventsText="View Week Events");J(Yd,!0)})(document,window)};