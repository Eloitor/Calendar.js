function calendarJs(qc,rc,sc){function Z(a){p=h(a)?a:new Date;var b=(new Date(p.getFullYear(),p.getMonth(),1)).getDay();a=qb(p.getFullYear(),p.getMonth());0===b&&(b=7);rb();if(!Nb){var c=aa(Ob);c.className="calendar";tc(c);uc(c);vc(c);wc(c);var e=f("div"),g=d.dayHeaderNames.length;e.className="row header-days";c.appendChild(e);for(var k=0;k<g;k++){var l=d.dayHeaderNames[k],m=f("div");m.className="cell";m.innerHTML=l;e.appendChild(m)}for(e=0;6>e;e++)for(g=f("div"),g.className="row",c.appendChild(g),
k=0;7>k;k++)l=7*e+(k+1),m=f("div"),m.className="cell",m.id="calendar-day-"+l,g.appendChild(m),0<d.minimumDayHeight&&(m.style.height=d.minimumDayHeight+"px");Nb=!0}k=b;if(1<k)for(c=new Date(p),c.setMonth(c.getMonth()-1),e=qb(c.getFullYear(),c.getMonth()),g=1,k=e-k+1;k<e;k++)sb(k+1,g,c.getMonth(),c.getFullYear(),!0),g++;for(e=c=0;e<a;e++)c=b+e,sb(e+1,c,p.getMonth(),p.getFullYear(),!1);if(42>c)for(a=1,b=new Date(p),b.setMonth(b.getMonth()+1),c+=1;43>c;c++)sb(a,c,b.getMonth(),b.getFullYear(),!0),a++;
ba();null===L&&(L=f("div"),L.className="disabled-background");null===ca&&(ca=f("div"),ca.className="calendar-dialog event-editor",r.body.appendChild(ca),b=f("div"),b.className="view",ca.appendChild(b),da=f("div"),da.className="disabled-area",b.appendChild(da),Ba=f("div"),Ba.className="title-bar",b.appendChild(Ba),a=f("div"),a.className="contents",b.appendChild(a),b=f("p"),b.innerText=d.titleText,a.appendChild(b),b=f("div"),b.className="input-title-container",a.appendChild(b),Q=f("input"),Q.type="text",
b.appendChild(Q),pa=f("input"),pa.className="select-colors",pa.type="button",pa.value="...",pa.onclick=xc,b.appendChild(pa),b=f("p"),b.innerText=d.fromText,a.appendChild(b),b=f("div"),b.className="split",a.appendChild(b),H=f("input"),H.onchange=tb,b.appendChild(H),ea(H,"date"),I=f("input"),b.appendChild(I),ea(I,"time"),Ca=Pb(a,d.isAllDayEventText,tb),b=f("p"),b.innerText=d.toText,a.appendChild(b),b=f("div"),b.className="split",a.appendChild(b),C=f("input"),b.appendChild(C),ea(C,"date"),J=f("input"),
b.appendChild(J),ea(J,"time"),b=f("p"),b.innerText=d.locationText,a.appendChild(b),qa=f("input"),qa.type="text",a.appendChild(qa),b=f("p"),b.innerText=d.descriptionText,a.appendChild(b),ra=f("textarea"),ra.className="custom-scroll-bars",a.appendChild(ra),sa=f("p"),sa.className="error",a.appendChild(sa),b=f("div"),b.className="split",a.appendChild(b),R=f("input"),R.className="ok",R.type="button",R.value=d.addText,R.onclick=yc,b.appendChild(R),c=f("input"),c.className="cancel",c.type="button",c.value=
d.cancelText,c.onclick=ub,b.appendChild(c),S=f("input"),S.className="remove",S.type="button",S.value=d.removeEventText,S.onclick=zc,a.appendChild(S));null===T&&(T=f("div"),T.className="calendar-dialog event-editor-colors",r.body.appendChild(T),a=f("div"),a.className="title-bar",a.innerHTML=d.selectColorsText,T.appendChild(a),a=f("div"),a.className="contents",T.appendChild(a),b=f("p"),b.innerText=d.backgroundColorText,a.appendChild(b),ta=f("input"),a.appendChild(ta),ea(ta,"color"),b=f("p"),b.innerText=
d.textColorText,a.appendChild(b),ua=f("input"),a.appendChild(ua),ea(ua,"color"),b=f("p"),b.innerText=d.borderColorText,a.appendChild(b),va=f("input"),a.appendChild(va),ea(va,"color"),b=f("div"),b.className="split",a.appendChild(b),a=f("input"),a.className="ok",a.type="button",a.value=d.okText,a.onclick=Ac,b.appendChild(a),a=f("input"),a.className="cancel",a.type="button",a.value=d.cancelText,a.onclick=Qb,b.appendChild(a));null===U&&(U=f("div"),U.className="calendar-dialog confirmation",r.body.appendChild(U),
Va=f("div"),Va.className="title-bar",U.appendChild(Va),a=f("div"),a.className="contents",U.appendChild(a),Wa=f("div"),Wa.className="message",a.appendChild(Wa),b=f("div"),b.className="split",a.appendChild(b),fa=f("input"),fa.className="yes",fa.type="button",fa.value=d.yesText,b.appendChild(fa),ha=f("input"),ha.className="no",ha.type="button",ha.value=d.noText,b.appendChild(ha));null===V&&(V=f("div"),V.className="calendar-dialog select-export-type",r.body.appendChild(V),a=f("div"),a.className="title-bar",
a.innerHTML=d.selectExportTypeTitle,V.appendChild(a),b=f("div"),b.className="contents",V.appendChild(b),vb=Xa(b,"CSV","ExportType"),Rb=Xa(b,"XML","ExportType"),Sb=Xa(b,"JSON","ExportType"),Tb=Xa(b,"TEXT","ExportType"),a=f("div"),a.className="split",b.appendChild(a),b=f("input"),b.className="ok",b.type="button",b.value=d.okText,b.onclick=Bc,a.appendChild(b),b=f("input"),b.className="cancel",b.type="button",b.value=d.cancelText,b.onclick=Ub,a.appendChild(b));null===y&&(y=f("div"),y.className="calendar-dialog search",
r.body.appendChild(y),a=f("div"),a.className="title-bar",a.innerHTML=d.searchEventsTitle,a.onmousedown=Cc,a.onmouseup=Dc,y.appendChild(a),b=f("div"),b.className="ib-close",b.onclick=Ec,a.appendChild(b),u(b,d.closeTooltipText),a=f("div"),a.className="contents",y.appendChild(a),b=f("p"),b.innerText=d.forText,a.appendChild(b),D=f("input"),D.type="text",D.oninput=wb,D.onpropertychange=wb,D.onkeypress=Fc,a.appendChild(D),Vb=Pb(a,d.matchCaseText),b=f("div"),b.className="split",a.appendChild(b),W=f("input"),
W.className="previous",W.type="button",W.value=d.previousText,W.onclick=Gc,b.appendChild(W),M=f("input"),M.className="next",M.type="button",M.value=d.nextText,M.onclick=Wb,b.appendChild(M),r.body.addEventListener("mousemove",Hc));null===v&&(v=f("div"),r.body.appendChild(v),Ya=f("div"),Ya.className="title",Da=f("div"),Da.className="date",wa=f("div"),wa.className="description",xa=f("div"),xa.className="location",document.body.addEventListener("mousemove",xb));Ic();Ea.innerHTML=d.monthNames[p.getMonth()]+
", "+p.getFullYear()+" \u25be"}function wc(a){x=f("div");x.className="header-date";a.appendChild(x);d.fullScreenModeEnabled&&(x.ondblclick=function(){Za(a)});var b=f("div");b.className="ib-arrow-left-full";b.onclick=Xb;b.ondblclick=t;x.appendChild(b);u(b,d.previousMonthTooltipText);b=f("div");b.className="ib-pin";b.onclick=Yb;b.ondblclick=t;x.appendChild(b);u(b,d.todayTooltipText);b=f("div");b.className="ib-refresh";b.onclick=yb;b.ondblclick=t;x.appendChild(b);u(b,d.refreshTooltipText);b=f("div");
b.className="ib-search";b.onclick=Jc;b.ondblclick=t;x.appendChild(b);u(b,d.searchTooltipText);b=f("div");b.className="ib-arrow-right-full";b.onclick=Zb;b.ondblclick=t;x.appendChild(b);u(b,d.nextMonthTooltipText);d.manualEditingEnabled&&(b=f("div"),b.className="ib-plus",b.onclick=$a,b.ondblclick=t,x.appendChild(b),u(b,d.addEventTooltipText));d.exportEventsEnabled&&(ia=f("div"),ia.className="ib-arrow-down-full-line",ia.ondblclick=t,x.appendChild(ia),u(ia,d.exportEventsTooltipText),ia.onclick=function(){ab()});
b=f("div");b.className="ib-eye";b.onclick=$b;b.ondblclick=t;x.appendChild(b);u(b,d.listAllEventsTooltipText);b=f("div");b.className="ib-hamburger";b.ondblclick=t;x.appendChild(b);b.onclick=function(){zb()};u(b,d.listWeekEventsTooltipText);b=f("div");b.className="title-container";x.appendChild(b);Ea=f("span");Ea.ondblclick=t;b.appendChild(Ea);Kc(b)}function Kc(a){if(null===z){var b=new Date(1900,1,1),c=(new Date).getFullYear()-b.getFullYear()+d.extraSelectableYearsAhead;z=f("div");z.className="years-drop-down";
a.appendChild(z);Fa=f("div");Fa.className="contents custom-scroll-bars";z.appendChild(Fa);for(a=0;a<c;a++)Lc(b.getFullYear()),b.setFullYear(b.getFullYear()+1);Ea.onclick=Mc;r.body.addEventListener("click",bb);r.body.addEventListener("contextmenu",bb);cb.addEventListener("resize",bb)}}function Lc(a){var b=f("div");b.innerText=a.toString();b.id="year-selected-"+a.toString();Fa.appendChild(b);b.onclick=function(){p.setFullYear(a);Z(p);rb()}}function Ga(a){a.isAllDayEvent&&(a.from=new Date(a.from.getFullYear(),
a.from.getMonth(),a.from.getDate(),0,0),a.to=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),23,59));return a}function Ha(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate()),e=new Date(b.getFullYear(),b.getMonth(),b.getDate());return Math.ceil(Math.abs(e-c)/864E5)}function Mc(a){if("block"!==z.style.display){t(a);a=z.getElementsByClassName("current-year-selected");if(null!==a&&1<=a.length)for(var b=a.length,c=0;c<b;c++)a[c].removeAttribute("class");a=aa("year-selected-"+
p.getFullYear());null!==a&&(a.className="current-year-selected");z.style.display="block";Fa.scrollTop=a.offsetTop-z.offsetHeight/2}}function rb(){Ab()&&(z.style.display="none")}function Ab(){return null!==z&&"block"===z.style.display}function Ia(a){if(null!==d&&Bb(d[a]))d[a]()}function db(a,b){if(null!==d&&Bb(d[a]))d[a](b)}function ac(){for(var a=[],b=0;32>b;b++){8!==b&&12!==b&&16!==b&&20!==b||a.push("-");var c=Math.floor(16*Math.random()).toString(16);a.push(c)}return a.join("")}function Za(a){0>=
a.className.indexOf(" full-screen-view")?(a.className+=" full-screen-view",bc=a.style.cssText,a.removeAttribute("style")):(a.className=a.className.replace(" full-screen-view",""),a.style.cssText=bc)}function bb(){Cb()&&(E.style.display="none");rb();xb()}function ba(){Nc();null!==Ja&&0<d.autoRefreshTimerDelay&&(clearTimeout(Ja),Ja=null);for(var a in n)if(n.hasOwnProperty(a)){var b=[],c;for(c in n[a])n[a].hasOwnProperty(c)&&b.push(Ga(n[a][c]));b.sort(function(l,m){return l.from-m.from});for(var e=b.length,
g=0;g<e;g++){var k=b[g];null!==Db(k.from)&&Oc(k)}b=[]}Pc();Qc()}function Oc(a){cc(a.from,a);if(a.from.getDate()!==a.to.getDate()){var b=Ha(a.from,a.to);if(0<b)for(var c=new Date(a.from),e=0;e<b;e++)c.setDate(c.getDate()+1),null!==Db(c)&&cc(c,a)}}function cc(a,b){var c=Db(a);if(null!==c&&c.getElementsByClassName(d.manualEditingEnabled?"event":"event-no-hover").length<d.maximumEventsPerDayDisplay){var e=f("div"),g=b.title;d.showTimesInMainCalendarEvents&&!b.isAllDayEvent&&b.from.getDate()===b.to.getDate()&&
(g=Ka(b.from,b.to)+": "+g);e.className=d.manualEditingEnabled?"event":"event-no-hover";e.innerHTML=g;c.appendChild(e);e.onmousemove=function(k){dc(k,b)};eb(b,e);d.manualEditingEnabled&&(e.onclick=function(){ja(b)});d.dragAndDropForEventsEnabled&&d.manualEditingEnabled&&(e.setAttribute("draggable",!0),e.ondragstart=function(){w=b})}}function Pc(){var a=0,b;for(b in n)if(n.hasOwnProperty(b))for(var c in n[b])if(n[b].hasOwnProperty(c)){a++;break}d.exportEventsEnabled&&(ia.style.display=0===a?"none":
"inline-block")}function Db(a){var b=new Date(p.getFullYear(),p.getMonth(),1),c=new Date(p),e=new Date(p),g=null,k=0;c.setMonth(c.getMonth()+1);e.setMonth(e.getMonth()-1);a.getMonth()===c.getMonth()&&a.getFullYear()===c.getFullYear()?(b=b.getDay()+qb(p.getFullYear(),p.getMonth()),k=a.getDate()+b-1):a.getMonth()===e.getMonth()&&a.getFullYear()===e.getFullYear()?k=b.getDay()-Ha(a,p):a.getMonth()===p.getMonth()&&a.getFullYear()===p.getFullYear()&&(b=b.getDay(),k=a.getDate()+b-1);0<k&&(g=aa("calendar-day-"+
k));return g}function Nc(){for(var a=0;6>a;a++)for(var b=0;7>b;b++)for(var c=aa("calendar-day-"+(7*a+(b+1))).getElementsByClassName(d.manualEditingEnabled?"event":"event-no-hover");c[0];)c[0].parentNode.removeChild(c[0])}function eb(a,b){a.to<new Date&&(b.className+=" expired");F(a.color)?(b.style.backgroundColor=a.color,F(a.colorText)&&(b.style.color=a.colorText),F(a.colorBorder)&&(b.style.borderLeftColor=a.colorBorder)):a.isAllDayEvent&&(b.className+=" all-day-event")}function vc(a){if(null===N){N=
f("div");N.className="full-day-view";a.appendChild(N);var b=f("div");b.className="title-bar";N.appendChild(b);d.fullScreenModeEnabled&&(b.ondblclick=function(){Za(a)});La=f("div");La.className="title";b.appendChild(La);var c=f("div");c.className="ib-close";c.ondblclick=t;b.appendChild(c);u(c,d.closeTooltipText);c.onclick=function(){Eb(N);fb=null};d.manualEditingEnabled&&(c=f("div"),c.className="ib-plus",c.onclick=$a,c.ondblclick=t,b.appendChild(c),u(c,d.addEventTooltipText));d.exportEventsEnabled&&
(ka=f("div"),ka.className="ib-arrow-down-full-line",ka.ondblclick=t,b.appendChild(ka),u(ka,d.exportEventsTooltipText),ka.onclick=function(){ab(gb)});Ma=f("div");Ma.className="contents custom-scroll-bars";N.appendChild(Ma)}}function Fb(a){Gb(N);La.innerText="";Ma.innerHTML="";fb=a;gb=[];la(La,a,!1,!0,!0);for(var b in n)if(n.hasOwnProperty(b)){var c=[],e;for(e in n[b])if(n[b].hasOwnProperty(e))for(var g=Ga(n[b][e]),k=Ha(g.from,g.to)+1,l=new Date(g.from),m=0;m<k;m++)l.getFullYear()===a.getFullYear()&&
l.getMonth()===a.getMonth()&&l.getDate()===a.getDate()&&c.push(g),l.setDate(l.getDate()+1);c.sort(function(q,ya){return q.from-ya.from});g=c.length;for(k=0;k<g;k++)Rc(c[k])}d.exportEventsEnabled&&(ka.style.display=0===gb.length?"none":"inline-block")}function Rc(a){var b=f("div");b.className=d.manualEditingEnabled?"event":"event-no-hover";Ma.appendChild(b);var c=f("div");c.className="title";c.innerHTML=a.title;b.appendChild(c);c=f("div");c.className="date";b.appendChild(c);a.from.getDate()===a.to.getDate()?
c.innerHTML=a.isAllDayEvent?d.allDayEventText:Ka(a.from,a.to):hb(c,a.from,a.to);eb(a,b);F(a.location)&&(c=f("div"),c.className="location",c.innerHTML=a.location,b.appendChild(c));F(a.description)&&(c=f("div"),c.className="description",c.innerHTML=a.description,b.appendChild(c));d.manualEditingEnabled&&(b.onclick=function(){ja(a)});gb.push(a)}function tc(a){if(null===O){O=f("div");O.className="list-all-events-view";a.appendChild(O);var b=f("div");b.className="title-bar";O.appendChild(b);d.fullScreenModeEnabled&&
(b.ondblclick=function(){Za(a)});var c=f("div");c.className="title";c.innerHTML=d.allEventsText;b.appendChild(c);c=f("div");c.className="ib-close";c.ondblclick=t;b.appendChild(c);u(c,d.closeTooltipText);c.onclick=function(){Eb(O)};d.manualEditingEnabled&&(c=f("div"),c.className="ib-plus",c.onclick=$a,c.ondblclick=t,b.appendChild(c),u(c,d.addEventTooltipText));d.exportEventsEnabled&&(za=f("div"),za.className="ib-arrow-down-full-line",za.ondblclick=t,b.appendChild(za),u(za,d.exportEventsTooltipText),
za.onclick=function(){ab()});Na=f("div");Na.className="contents custom-scroll-bars";O.appendChild(Na)}}function $b(){Gb(O);Na.innerHTML="";var a=[];for(c in n)if(n.hasOwnProperty(c))for(var b in n[c])n[c].hasOwnProperty(b)&&a.push(Ga(n[c][b]));a.sort(function(k,l){return k.from-l.from});var c=a.length;for(b=0;b<c;b++){var e=a[b],g=Sc(e.from);Tc(e,g)}}function Tc(a,b){var c=f("div");c.className=d.manualEditingEnabled?"event":"event-no-hover";b.appendChild(c);var e=f("div");e.className="title";e.innerHTML=
a.title;c.appendChild(e);e=f("div");e.className="date";c.appendChild(e);a.from.getDate()===a.to.getDate()?a.isAllDayEvent?ib(e,a.from,null," - "+d.allDayEventText):ib(e,a.from,null," - "+Ka(a.from,a.to)):hb(e,a.from,a.to);eb(a,c);F(a.location)&&(e=f("div"),e.className="location",e.innerHTML=a.location,c.appendChild(e));F(a.description)&&(e=f("div"),e.className="description",e.innerHTML=a.description,c.appendChild(e));d.manualEditingEnabled&&(c.onclick=function(){ja(a)})}function Sc(a){var b="month-"+
a.getMonth()+"-"+a.getFullYear(),c=aa(b);if(null===c){var e=f("div");e.className="month";Na.appendChild(e);c=f("div");c.className="header";c.innerHTML=d.monthNames[a.getMonth()]+" "+a.getFullYear();e.appendChild(c);c=f("div");c.id=b;c.className="events";e.appendChild(c)}return c}function uc(a){if(null===P){P=f("div");P.className="list-all-week-events-view";a.appendChild(P);var b=f("div");b.className="title-bar";P.appendChild(b);d.fullScreenModeEnabled&&(b.ondblclick=function(){Za(a)});G=f("div");
G.className="title";b.appendChild(G);var c=f("div");c.className="ib-close";c.ondblclick=t;b.appendChild(c);u(c,d.closeTooltipText);c.onclick=function(){Eb(P)};d.manualEditingEnabled&&(c=f("div"),c.className="ib-plus",c.onclick=$a,c.ondblclick=t,b.appendChild(c),u(c,d.addEventTooltipText));d.exportEventsEnabled&&(ma=f("div"),ma.className="ib-arrow-down-full-line",ma.ondblclick=t,b.appendChild(ma),u(ma,d.exportEventsTooltipText),ma.onclick=function(){ab(jb)});Oa=f("div");Oa.className="contents custom-scroll-bars";
P.appendChild(Oa)}}function zb(a){Gb(P);Oa.innerHTML="";jb=[];ec=a;var b=[],c=Uc(a);a=c[0];c=c[1];Vc(a,c);for(var e in n)if(n.hasOwnProperty(e))for(var g in n[e])n[e].hasOwnProperty(g)&&b.push(Ga(n[e][g]));b.sort(function(Pa,Wc){return Pa.from-Wc.from});e=b.length;for(g=0;g<e;g++){for(var k=b[g],l=Ha(k.from,k.to)+1,m=new Date(k.from),q=!1,ya=0;ya<l;ya++)m>=a&&m<=c&&(q=Xc(m),Yc(k,q),q=!0),m.setDate(m.getDate()+1);q&&jb.push(k)}d.exportEventsEnabled&&(ma.style.display=0===jb.length?"none":"inline-block")}
function Vc(a,b){G.innerHTML="";if(a.getFullYear()===b.getFullYear()){la(G,a,!1,!1);var c=f("span");c.innerHTML=" - ";G.appendChild(c);la(G,b,!1,!1);c=f("span");c.innerHTML=", "+a.getFullYear();G.appendChild(c)}else la(G,a,!1,!0),c=f("span"),c.innerHTML=" - ",G.appendChild(c),la(G,b,!1,!0)}function Yc(a,b){var c=f("div");c.className=d.manualEditingEnabled?"event":"event-no-hover";b.appendChild(c);var e=f("div");e.className="title";e.innerHTML=a.title;c.appendChild(e);e=f("div");e.className="date";
c.appendChild(e);a.from.getDate()===a.to.getDate()?e.innerHTML=a.isAllDayEvent?d.allDayEventText:Ka(a.from,a.to):hb(e,a.from,a.to);eb(a,c);F(a.location)&&(e=f("div"),e.className="location",e.innerHTML=a.location,c.appendChild(e));F(a.description)&&(e=f("div"),e.className="description",e.innerHTML=a.description,c.appendChild(e));d.manualEditingEnabled&&(c.onclick=function(){ja(a)})}function Xc(a){var b=fc(a),c="day-"+b,e=aa(c);if(null===e){var g=f("div");g.className="day";Oa.appendChild(g);e=f("div");
e.className="header";g.appendChild(e);ib(e,a,d.dayNames[b]+", ");e=f("div");e.id=c;e.className="events";g.appendChild(e)}return e}function fc(a){return 0>a.getDay()-1?6:a.getDay()-1}function Uc(a){a=h(a)?a:new Date;var b=0===a.getDay()?7:a.getDay();b=a.getDate()-b+1;var c=b+6,e=new Date(a);a=new Date(a);e.setDate(b);e.setHours(0,0,0,0);a.setDate(c);a.setHours(23,59,59,99);return[e,a]}function Ka(a,b){return Hb(a)+" "+d.toTimeText+" "+Hb(b)}function Hb(a){return A(a.getHours())+":"+A(a.getMinutes())}
function hb(a,b,c){a.innerHTML="";var e=f("span");e.innerText=d.startsOnText+" ";a.appendChild(e);la(a,b);b=f("span");b.innerText=" "+d.andFinishesOnText+" ";a.appendChild(b);la(a,c)}function la(a,b,c,e,g){c=h(c)?c:!0;e=h(e)?e:!0;if(g=h(g)?g:!1){g=fc(b);var k=f("span");k.innerText=d.dayNames[g]+", ";a.appendChild(k)}ib(a,b);g=f("span");g.innerText=" "+d.monthNames[b.getMonth()];a.appendChild(g);e&&(e=f("span"),e.innerText=" "+b.getFullYear(),a.appendChild(e));c&&(c=f("span"),c.innerText=" "+Hb(b),
a.appendChild(c))}function ib(a,b,c,e){if(h(c)){var g=f("span");g.innerText=c;a.appendChild(g)}c=f("span");c.innerText=b.getDate();a.appendChild(c);d.showDayNumberOrdinals&&(c=f("sup"),c.innerText=gc(b.getDate()),a.appendChild(c));h(e)&&(b=f("span"),b.innerText=e,a.appendChild(b))}function sb(a,b,c,e,g){var k=new Date;k=a===k.getDate()&&e===k.getFullYear()&&c===k.getMonth();b=aa("calendar-day-"+b);var l=f("span"),m=new Date(e,c,a);b.innerHTML="";l.className=g?"day-muted":"";l.className+=k?" today":
"";l.innerText=a;if(6===m.getDay()||0===m.getDay())b.className+=" weekend-day";b.oncontextmenu=function(q){kb=m;bb();t(q);hc(q,E)};d.showDayNumberOrdinals&&(g=f("sup"),g.innerText=gc(a),l.appendChild(g));b.appendChild(l);d.fullDayViewEnabled&&(g=f("div"),g.className="expand-day",b.appendChild(g),u(g,d.expandDayTooltipText),g.onclick=function(){Fb(m)});d.manualEditingEnabled&&(b.ondblclick=function(){ja(null,m)},d.manualEditingEnabled&&(b.ondragover=function(q){t(q)},b.ondrop=function(q){t(q);if(null!==
w){q=Ha(w.from,w.to);var ya=new Date(e,c,a,w.from.getHours(),w.from.getMinutes()),Pa=new Date(e,c,a,w.to.getHours(),w.to.getMinutes());0<q&&Pa.setDate(Pa.getDate()+q);Qa.updateEvent(w.id,{from:ya,to:Pa,title:w.title,description:w.description,location:w.location,isAllDayEvent:w.isAllDayEvent,color:w.color,colorText:w.colorText,colorBorder:w.colorBorder})}}))}function qb(a,b){return(new Date(a,b+1,0)).getDate()}function gc(a){var b=d.thText;if(31===a||21===a||1===a)b=d.stText;else if(22===a||2===a)b=
d.ndText;else if(23===a||3===a)b=d.rdText;return b}function Ic(){E=f("div");E.className="calendar-drop-down-menu";r.body.appendChild(E);var a=f("div");a.className="item";a.innerHTML=d.addEventTitle;E.appendChild(a);a.onclick=function(){ja(null,kb)};a=f("div");a.className="separator";E.appendChild(a);a=f("div");a.className="item";a.innerHTML=d.expandDayTooltipText;E.appendChild(a);a.onclick=function(){Fb(kb)};a=f("div");a.className="separator";E.appendChild(a);a=f("div");a.className="item";a.innerHTML=
d.listWeekEventsTooltipText;E.appendChild(a);a.onclick=function(){zb(kb)}}function Cb(){return"block"===E.style.display}function ea(a,b){try{a.type=b}catch(c){a.type="text"}}function $a(){ja(null,fb)}function tb(){var a=!1;Ca.checked&&(C.value=H.value,I.value="00:00",J.value="23:59",a=!0);C.disabled=a;I.disabled=a;J.disabled=a}function ja(a,b){lb(r.body,L);ca.style.display="block";sa.style.display="none";Q.focus();if(h(a))R.value=d.updateText,S.style.display="block",Ba.innerHTML=d.editEventTitle,
B=a,H.value=mb(a.from,H.type),I.value=nb(a.from),C.value=mb(a.to,C.type),J.value=nb(a.to),Ca.checked=a.isAllDayEvent,Q.value=K(a.title),ra.value=K(a.description),qa.value=K(a.location),ta.value=K(a.color,"#484848"),ua.value=K(a.colorText,"#F5F5F5"),va.value=K(a.colorBorder,"#282828");else{var c=new Date,e=h(b)?b:c,g=new Date;e.getDate()===g.getDate()&&e.getFullYear()===g.getFullYear()&&e.getMonth()===g.getMonth()&&(e.setHours(c.getHours()),e.setMinutes(c.getMinutes()));R.value=d.addText;S.style.display=
"none";Ba.innerHTML=d.addEventTitle;B={};H.value=mb(e,H.type);I.value=nb(e);C.value=mb(e,C.type);J.value=nb(e);Ca.checked=!1;Q.value="";ra.value="";qa.value="";ta.value="#484848";ua.value="#F5F5F5";va.value="#282828"}tb()}function yc(){var a=ic(H),b=ic(C),c=I.value.split(":"),e=J.value.split(":"),g=Ib(Q.value),k=Ib(ra.value),l=Ib(qa.value);2>c.length?ob(d.fromTimeErrorMessage,I):2>e.length?ob(d.toTimeErrorMessage,J):b<a?ob(d.toSmallerThanFromErrorMessage,C):""===g?ob(d.titleErrorMessage,Q):(ub(),
jc(a,I.value),jc(b,J.value),a={from:a,to:b,title:g,description:k,location:l,isAllDayEvent:Ca.checked,color:B.color,colorText:B.colorText,colorBorder:B.colorBorder},h(B.id)?Qa.updateEvent(B.id,a,!1):Qa.addEvent(a,!1),ba(),Jb())}function jc(a,b){var c=0,e=0,g=b.split(":");if(2===g.length){var k=parseInt(g[0]);g=parseInt(g[1]);!isNaN(k)&&2>=k.toString().length&&(c=k);!isNaN(g)&&2>=g.toString().length&&(e=g)}a.setHours(c);a.setMinutes(e)}function ic(a){var b=new Date;if("date"===a.type)b=new Date(a.value);
else if(a=a.value.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/))a=new Date(a[3],a[2]-1,a[1]),a instanceof Date&&!isNaN(a)&&(b=a);return b}function ub(){ca.style.display="none";pb(r.body,L)}function zc(){da.style.display="block";var a=function(){da.style.display="none"};Zc(d.confirmEventRemoveTitle,d.confirmEventRemoveMessage,function(){a();ub();h(B.id)&&(Qa.removeEvent(B.id,!0),Jb())},a)}function mb(a,b){var c=("0"+a.getDate()).slice(-2),e=("0"+(a.getMonth()+1)).slice(-2);return"date"===b?a.getFullYear()+
"-"+e+"-"+c:c+"/"+e+"/"+a.getFullYear()}function nb(a){return A(a.getHours())+":"+A(a.getMinutes())}function A(a){a=a.toString();return 1===a.length?"0"+a:a}function ob(a,b){sa.innerHTML=a;sa.style.display="block";b.focus()}function Ib(a){return a.replace(/^\s+|\s+$/g,"")}function Jb(){Ra(N)&&Fb(fb);Ra(O)&&$b();Ra(P)&&zb(ec)}function Ac(){Qb();B.color=ta.value;B.colorText=ua.value;B.colorBorder=va.value}function Qb(){T.style.display="none";da.style.display="none"}function xc(){T.style.display="block";
da.style.display="block"}function Zc(a,b,c,e){U.style.display="block";Va.innerHTML=a;Wa.innerHTML=b;fa.onclick=kc;ha.onclick=kc;fa.addEventListener("click",c);Bb(e)&&ha.addEventListener("click",e)}function kc(){U.style.display="none"}function ab(a){lb(r.body,L);V.style.display="block";Sa=a;vb.checked=!0}function Ub(){pb(r.body,L);V.style.display="none"}function Bc(){Ub();vb.checked?Ta(Sa,"csv"):Rb.checked?Ta(Sa,"xml"):Sb.checked?Ta(Sa,"json"):Tb.checked&&Ta(Sa,"text")}function Cc(a){Ua||(Ua=!0,lc=
a.pageX-y.offsetLeft,mc=a.pageY-y.offsetTop)}function Hc(a){Ua&&(y.style.left=a.pageX-lc+"px",y.style.top=a.pageY-mc+"px")}function Dc(){Ua&&(Ua=!1)}function wb(){W.disabled=!0;M.disabled=""===D.value;na=[];X=0}function Jc(){na=[];y.style.display="block";D.value="";D.focus();wb()}function Ec(){y.style.display="none"}function Gc(){0<X&&(X--,nc(),Z(na[X].from))}function Fc(a){13!==a.keyCode||M.disabled||Wb()}function Wb(){if(0===na.length){var a=Vb.checked,b=a?D.value:D.value.toLowerCase(),c={},e;for(e in n)if(n.hasOwnProperty(e))for(var g in n[e])if(n[e].hasOwnProperty(g)){var k=
n[e][g],l=a?k.title:k.title.toLowerCase(),m=a?k.description:k.description.toLowerCase();if(-1<l.indexOf(b)||-1<m.indexOf(b))l=k.from.getMonth()+"-"+k.from.getFullYear(),c.hasOwnProperty(l)||(na.push(k),c[l]=!0)}}else X++;nc();Z(na[X].from)}function nc(){W.disabled=0===X;M.disabled=X===na.length-1}function dc(a,b,c){t(a);null!==Y&&(clearTimeout(Y),Y=null);xb();"block"!==v.style.display&&(Y=setTimeout(function(){r.body.contains(L)||Ab()||Cb()||(c=h(c)?c:"",v.className=""===c?"calendar-tooltip-event":
"calendar-tooltip",""!==c?v.innerHTML=c:(v.innerHTML="",v.appendChild(Ya),v.appendChild(Da),Ya.innerHTML=b.title,F(b.location)?(xa.innerHTML=b.location,lb(v,xa)):(xa.innerHTML="",pb(v,xa)),F(b.description)?(wa.innerHTML=b.description,lb(v,wa)):(wa.innerHTML="",pb(v,wa)),b.from.getDate()===b.to.getDate()?Da.innerHTML=b.isAllDayEvent?d.allDayEventText:Ka(b.from,b.to):hb(Da,b.from,b.to)),hc(a,v))},d.eventTooltipDelay))}function xb(){null!==Y&&(clearTimeout(Y),Y=null);"none"!==v.style.display&&(v.style.display=
"none")}function u(a,b){a.onmousemove=function(c){dc(c,null,b)}}function Qc(){null===Ja&&0<d.autoRefreshTimerDelay&&(Ja=setInterval(function(){yb()},d.autoRefreshTimerDelay))}function yb(){"block"===v.style.display||null!==Y||r.body.contains(L)||Ab()||Cb()||(Jb(),ba())}function Gb(a){Ra(a)||(a.className+=" overlay-shown")}function Eb(a){Ra(a)&&(a.className=a.className.replace(" overlay-shown",""))}function Ra(a){return-1<a.className.indexOf("overlay-shown")}function f(a){a=a.toLowerCase();var b="text"===
a;Kb.hasOwnProperty(a)||(Kb[a]=b?r.createTextNode(""):r.createElement(a));return Kb[a].cloneNode(!1)}function aa(a){Aa.hasOwnProperty(a)&&null!==Aa[a]||(Aa[a]=r.getElementById(a));r.body.contains(Aa[a])||(Aa[a]=r.getElementById(a));return Aa[a]}function lb(a,b){try{a.contains(b)||a.appendChild(b)}catch(c){console.warn(c.message)}}function pb(a,b){try{a.contains(b)&&a.removeChild(b)}catch(c){console.warn(c.message)}}function t(a){a.preventDefault();a.cancelBubble=!0}function hc(a,b){var c=a.pageX,
e=a.pageY;b.style.display="block";c+b.offsetWidth>cb.innerWidth?c-=b.offsetWidth:c++;e+b.offsetHeight>cb.innerHeight?e-=b.offsetHeight:e++;b.style.left=c+"px";b.style.top=e+"px"}function Xa(a,b,c){var e=f("div");a.appendChild(e);a=f("label");a.className="radioButton";a.innerText=b;e.appendChild(a);b=f("input");b.type="radio";b.name=c;a.appendChild(b);c=f("span");c.className="check-mark";a.appendChild(c);return b}function Pb(a,b,c){var e=f("div");a.appendChild(e);a=f("label");a.className="checkbox";
a.innerText=b;e.appendChild(a);b=f("input");b.type="checkbox";a.appendChild(b);h(c)&&(b.onchange=c);c=f("span");c.className="check-mark";a.appendChild(c);return b}function h(a){return void 0!==a&&null!==a&&""!==a}function Bb(a){return h(a)&&"function"===typeof a}function oc(a){return h(a)&&"string"===typeof a}function F(a){return oc(a)&&""!==a}function Ta(a,b){b=h(b)?b.toLowerCase():"csv";var c="",e=$c(a);if("csv"===b){var g=[d.fromText,d.toText,d.isAllDayEventText,d.titleText,d.descriptionText,d.locationText],
k=g.length;c=[];for(var l=[],m=0;m<k;m++)c.push(oa(g[m]));l.push(c.join(","));g=e.length;for(k=0;k<g;k++){c=l;m=e[k];var q=[];q.push(oa(Lb(m.from)));q.push(oa(Lb(m.to)));q.push(oa(m.isAllDayEvent?d.yesText:d.noText));q.push(oa(K(m.title)));q.push(oa(K(m.description)));q.push(oa(K(m.location)));c.push(q.join(","))}c=l.join("\n")}else if("xml"===b){g=[];g.push('<?xml version="1.0" ?>');g.push("<Events>");k=e.length;for(c=0;c<k;c++){m=e[c];g.push("<Event>");for(l in m)m.hasOwnProperty(l)&&(q=pc(l),g.push("<"+
q+">"+Mb(m[l])+"</"+q+">"));g.push("</Event>")}g.push("</Events>");c=g.join("\n")}else if("json"===b){l=[];l.push("{");l.push('"events:": [');k=e.length;for(c=0;c<k;c++){m=e[c];l.push("{");for(g in m)m.hasOwnProperty(g)&&l.push('"'+g+'":"'+Mb(m[g])+'",');m=l[l.length-1];l[l.length-1]=m.substring(0,m.length-1);l.push("},")}l[l.length-1]="}";l.push("]");l.push("}");c=l.join("\n")}else if("text"===b){l=[];g=e.length;for(c=0;c<g;c++){m=e[c];for(k in m)m.hasOwnProperty(k)&&l.push(pc(k)+": "+Mb(m[k]));
l.push("")}l.pop();c=l.join("\n")}""!==c&&(e=f("a"),g="text"===b?"plain":b,l="text"===b?"txt":b,e.style.display="none",e.setAttribute("target","_blank"),e.setAttribute("href","data:text/"+g+";charset=utf-8,"+encodeURIComponent(c)),g=e.setAttribute,c=new Date,k=A(c.getDate())+"-"+A(c.getMonth())+"-"+c.getFullYear(),c=A(c.getHours())+"-"+A(c.getMinutes()),g.call(e,"download",d.exportStartFilename+k+"_"+c+"."+l),r.body.appendChild(e),e.click(),r.body.removeChild(e),Ia("onEventsExported"))}function $c(a){var b=
[];if(h(a))for(var c=a.length,e=0;e<c;e++)b.push(a[e]);else for(c in n)if(n.hasOwnProperty(c))for(e in n[c])n[c].hasOwnProperty(e)&&b.push(n[c][e]);b.sort(function(g,k){return g.from-k.from});return b}function Lb(a){var b=A(a.getDate())+"/"+A(a.getMonth())+"/"+a.getFullYear();a=A(a.getHours())+":"+A(a.getMinutes());return b+" "+a}function K(a,b){b=h(b)?b:"";return oc(a)?a:b}function pc(a){return a.charAt(0).toUpperCase()+a.slice(1)}function Mb(a){var b=K(a);"boolean"===typeof a?b=a?d.yesText:d.noText:
"object"===typeof a&&(b=Lb(a));return b}function oa(a){a=a.replace(/(\r\n|\n|\r)/gm,"").replace(/(\s\s)/gm," ");a=a.replace(/"/g,'""');return'"'+a+'"'}function Xb(){var a=new Date(p);a.setMonth(a.getMonth()-1);a.setDate(1);Z(a);Ia("onPreviousMonth")}function Zb(){var a=new Date(p);a.setMonth(a.getMonth()+1);a.setDate(1);Z(a);Ia("onNextMonth")}function Yb(){var a=new Date;if(p.getMonth()!==a.getMonth()||p.getFullYear()!==a.getFullYear())Z(),Ia("onToday")}var d={},Qa=this,p,Kb={},Aa={},r=null,cb=null,
Ob=null,Nb=!1,n={},Ja=null,w=null,bc=null,x=null,Ea=null,z=null,Fa=null,ia=null,L=null,ca=null,da=null,Ba=null,H=null,I=null,C=null,J=null,Ca=null,Q=null,pa=null,ra=null,qa=null,sa=null,B={},R=null,S=null,T=null,ta=null,ua=null,va=null,N=null,La=null,Ma=null,fb=null,gb=[],ka=null,O=null,za=null,Na=null,P=null,G=null,ma=null,Oa=null,jb=[],ec=null,U=null,Va=null,Wa=null,fa=null,ha=null,V=null,vb=null,Rb=null,Sb=null,Tb=null,Sa=null,v=null,Ya=null,Da=null,wa=null,xa=null,Y=null,E=null,kb=null,y=null,
D=null,Vb=null,W=null,M=null,Ua=!1,lc=0,mc=0,na=[],X=0;this.moveToPreviousMonth=function(){Xb()};this.moveToNextMonth=function(){Zb()};this.moveToToday=function(){Yb()};this.exportAllEvents=function(a){d.exportEventsEnabled&&(a=h(a)?a:"csv",Ta(null,a))};this.refresh=function(){yb()};this.addEvents=function(a,b,c){b=h(b)?b:!0;c=h(c)?c:!0;for(var e=a.length,g=0;g<e;g++)this.addEvent(a[g],!1,!1);c&&db("onEventAdded",a);b&&ba()};this.addEvent=function(a,b,c){var e=!1;if(a.from<=a.to){var g=a.from;g=g.getFullYear()+
"-"+g.getMonth()+"-"+g.getDate();var k=ac();n.hasOwnProperty(g)||(n[g]={});n[g].hasOwnProperty(k)||(b=h(b)?b:!0,c=h(c)?c:!0,h(a.id)?k=a.id:a.id=k,n[g][k]=Ga(a),e=!0,c&&db("onEventAdded",a),b&&ba())}return e};this.updateEvent=function(a,b,c,e){if(a=this.removeEvent(a,!1,!1))c=h(c)?c:!0,e=h(e)?e:!0,b.id=ac(),(a=this.addEvent(b,c,!1))&&e&&db("onEventUpdated",b);return a};this.removeEvent=function(a,b,c){var e=!1,g;for(g in n)if(n.hasOwnProperty(g))for(var k in n[g])if(n[g].hasOwnProperty(k)&&k===a){b=
h(b)?b:!0;c=h(c)?c:!0;delete n[g][k];e=!0;c&&db("onEventRemoved",n[g][k]);b&&ba();break}return e};this.clearEvents=function(a){a=h(a)?a:!0;n={};Ia("onEventsCleared");a&&ba()};this.setOptions=function(a){d=null!==a&&"object"===typeof a?a:{};h(d.previousMonthTooltipText)||(d.previousMonthTooltipText="Previous Month");h(d.nextMonthTooltipText)||(d.nextMonthTooltipText="Next Month");h(d.addEventTooltipText)||(d.addEventTooltipText="Add Event");h(d.closeTooltipText)||(d.closeTooltipText="Close");h(d.exportEventsTooltipText)||
(d.exportEventsTooltipText="Export Events");h(d.todayTooltipText)||(d.todayTooltipText="Today");h(d.refreshTooltipText)||(d.refreshTooltipText="Refresh");h(d.searchTooltipText)||(d.searchTooltipText="Search");h(d.expandDayTooltipText)||(d.expandDayTooltipText="Expand Day");h(d.listAllEventsTooltipText)||(d.listAllEventsTooltipText="View All Events");h(d.listWeekEventsTooltipText)||(d.listWeekEventsTooltipText="View Current Week Events");h(d.dayHeaderNames)||(d.dayHeaderNames="Mo Tu We Th Fr Sa Su".split(" "));
h(d.dayNames)||(d.dayNames="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "));h(d.fromText)||(d.fromText="From:");h(d.toText)||(d.toText="To:");h(d.isAllDayEventText)||(d.isAllDayEventText="Is All Day Event");h(d.titleText)||(d.titleText="Title:");h(d.descriptionText)||(d.descriptionText="Description:");h(d.locationText)||(d.locationText="Location:");h(d.addText)||(d.addText="Add");h(d.updateText)||(d.updateText="Update");h(d.cancelText)||(d.cancelText="Cancel");h(d.removeEventText)||
(d.removeEventText="Remove Event");h(d.addEventTitle)||(d.addEventTitle="Add Event");h(d.editEventTitle)||(d.editEventTitle="Edit Event");h(d.monthNames)||(d.monthNames="January February March April May June July August September October November December".split(" "));h(d.showDayNumberOrdinals)||(d.showDayNumberOrdinals=!0);h(d.dragAndDropForEventsEnabled)||(d.dragAndDropForEventsEnabled=!0);h(d.exportStartFilename)||(d.exportStartFilename="exported_events_");h(d.fromTimeErrorMessage)||(d.fromTimeErrorMessage=
"Please select a valid 'From' time.");h(d.toTimeErrorMessage)||(d.toTimeErrorMessage="Please select a valid 'To' time.");h(d.toSmallerThanFromErrorMessage)||(d.toSmallerThanFromErrorMessage="Please select a 'To' date that is larger than the 'From' date.");h(d.titleErrorMessage)||(d.titleErrorMessage="Please enter a value in the 'Title' field (no empty space).");h(d.stText)||(d.stText="st");h(d.ndText)||(d.ndText="nd");h(d.rdText)||(d.rdText="rd");h(d.thText)||(d.thText="th");h(d.fullDayViewEnabled)||
(d.fullDayViewEnabled=!0);h(d.maximumEventsPerDayDisplay)||(d.maximumEventsPerDayDisplay=3);h(d.yesText)||(d.yesText="Yes");h(d.noText)||(d.noText="No");h(d.extraSelectableYearsAhead)||(d.extraSelectableYearsAhead=51);h(d.allDayEventText)||(d.allDayEventText="All Day Event");h(d.allEventsText)||(d.allEventsText="All Events");h(d.exportEventsEnabled)||(d.exportEventsEnabled=!0);h(d.manualEditingEnabled)||(d.manualEditingEnabled=!0);h(d.showTimesInMainCalendarEvents)||(d.showTimesInMainCalendarEvents=
!1);h(d.startsOnText)||(d.startsOnText="Starts on the");h(d.andFinishesOnText)||(d.andFinishesOnText="and finishes on the");h(d.toTimeText)||(d.toTimeText="to");h(d.autoRefreshTimerDelay)||(d.autoRefreshTimerDelay=5E3);h(d.confirmEventRemoveTitle)||(d.confirmEventRemoveTitle="Confirm Event Removal");h(d.confirmEventRemoveMessage)||(d.confirmEventRemoveMessage="Removing this event cannot be undone.  Do you want to continue?");h(d.okText)||(d.okText="OK");h(d.selectExportTypeTitle)||(d.selectExportTypeTitle=
"Select Export Type");h(d.fullScreenModeEnabled)||(d.fullScreenModeEnabled=!0);h(d.eventTooltipDelay)||(d.eventTooltipDelay=1E3);h(d.selectColorsText)||(d.selectColorsText="Select Colors");h(d.backgroundColorText)||(d.backgroundColorText="Background Color:");h(d.textColorText)||(d.textColorText="Text Color:");h(d.borderColorText)||(d.borderColorText="Border Color:");h(d.searchEventsTitle)||(d.searchEventsTitle="Search Events");h(d.forText)||(d.forText="For:");h(d.previousText)||(d.previousText="Previous");
h(d.nextText)||(d.nextText="Next");h(d.matchCaseText)||(d.matchCaseText="Match Case");h(d.minimumDayHeight)||(d.minimumDayHeight=0)};(function(a,b){r=a;cb=b;Ob=qc;Qa.setOptions(rc);Z(sc)})(document,window)};