function calendarJs(Ld,Md,Nd){function P(a,d){u=h(a)?a:new Date;d=h(d)?d:!1;var b=(new Date(u.getFullYear(),u.getMonth(),1)).getDay(),e=Db(u.getFullYear(),u.getMonth());0===b&&(b=7);sa();if(!Eb){A=Ia(Pc);A.className="calendar";A.innerHTML="";Od();Pd();Qd();Rd();var f=g("div","row header-days"),k=c.dayHeaderNames.length;A.appendChild(f);for(var l=0;l<k;l++){var m=c.dayHeaderNames[l],n=g("div","cell");n.innerHTML=m;f.appendChild(n)}for(f=0;6>f;f++)for(k=g("div","row"),A.appendChild(k),l=0;7>l;l++)m=
7*f+(l+1),n=g("div","cell"),n.id="calendar-day-"+m,k.appendChild(n),0<c.minimumDayHeight&&(n.style.height=c.minimumDayHeight+"px");Sd();Eb=!0}m=b;if(1<m)for(f=new Date(u),f.setMonth(f.getMonth()-1),k=Db(f.getFullYear(),f.getMonth()),l=1,m=k-m+1;m<k;m++)nc(m+1,l,f.getMonth(),f.getFullYear(),!0),l++;for(k=f=0;k<e;k++)f=b+k,nc(k+1,f,u.getMonth(),u.getFullYear(),!1);if(42>f){b=1;e=new Date(u);e.setMonth(e.getMonth()+1);for(f+=1;43>f;f++)nc(b,f,e.getMonth(),e.getFullYear(),!0),b++;b=Db(e.getFullYear(),
e.getMonth());b=Math.round(b/2);oc=new Date(e.getFullYear(),e.getMonth(),b)}else oc=null;fa();d&&(null===Q&&(Q=g("div","disabled-background")),null!==ta&&B(r.body,ta),ta=g("div","calendar-dialog event-editor"),r.body.appendChild(ta),b=g("div","view"),ta.appendChild(b),ha=g("div","disabled-area"),b.appendChild(ha),Fb=g("div","title-bar"),b.appendChild(Fb),e=g("div","contents"),b.appendChild(e),b=g("p"),b.innerText=c.titleText,e.appendChild(b),b=g("div","input-title-container"),e.appendChild(b),ua=
g("input",null,"text"),b.appendChild(ua),f=g("input","select-colors","button"),f.value="...",f.onclick=Td,b.appendChild(f),b=g("p"),b.innerText=c.fromText.replace(":","")+"/"+c.toText,e.appendChild(b),b=g("div","split"),e.appendChild(b),I=g("input"),I.onchange=Gb,b.appendChild(I),va(I,"date"),R=g("input"),b.appendChild(R),va(R,"time"),b=g("div","split"),e.appendChild(b),E=g("input"),E.onchange=Gb,b.appendChild(E),va(E,"date"),S=g("input"),b.appendChild(S),va(S,"time"),cb=F(e,c.isAllDayText,Gb)[0],
b=g("p"),b.innerText=c.repeatsText,e.appendChild(b),b=g("div","radioButtonsContainer"),e.appendChild(b),wa=T(b,c.repeatsNever,"RepeatType",Ja),Hb=T(b,c.repeatsEveryDayText,"RepeatType",Ja),Ib=T(b,c.repeatsEveryWeekText,"RepeatType",Ja),Jb=T(b,c.repeatsEveryMonthText,"RepeatType",Ja),Kb=T(b,c.repeatsEveryYearText,"RepeatType",Ja),Ka=g("input","days-to-exclude","button"),Ka.value="...",Ka.onclick=Ud,b.appendChild(Ka),b=g("p"),b.innerText=c.locationText,e.appendChild(b),db=g("input",null,"text"),e.appendChild(db),
b=g("p"),b.innerText=c.descriptionText,e.appendChild(b),eb=g("textarea","custom-scroll-bars"),e.appendChild(eb),fb=g("p","error"),e.appendChild(fb),b=g("div","split"),e.appendChild(b),La=g("input","ok","button"),La.value=c.addText,La.onclick=Vd,b.appendChild(La),f=g("input","cancel","button"),f.value=c.cancelText,f.onclick=pc,b.appendChild(f),Ma=g("input","remove","button"),Ma.value=c.removeEventText,Ma.onclick=Wd,e.appendChild(Ma),null!==ia&&B(r.body,ia),ia=g("div","calendar-dialog event-editor-colors"),
r.body.appendChild(ia),e=g("div","title-bar"),e.innerHTML=c.selectColorsText,ia.appendChild(e),e=g("div","contents"),ia.appendChild(e),b=g("p"),b.innerText=c.backgroundColorText,e.appendChild(b),Na=g("input"),e.appendChild(Na),va(Na,"color"),b=g("p"),b.innerText=c.textColorText,e.appendChild(b),Oa=g("input"),e.appendChild(Oa),va(Oa,"color"),b=g("p"),b.innerText=c.borderColorText,e.appendChild(b),Pa=g("input"),e.appendChild(Pa),va(Pa,"color"),b=g("div","split"),e.appendChild(b),e=g("input","ok","button"),
e.value=c.okText,e.onclick=Xd,b.appendChild(e),e=g("input","cancel","button"),e.value=c.cancelText,e.onclick=Qc,b.appendChild(e),null!==ja&&B(r.body,ja),ja=g("div","calendar-dialog event-editor-exclude-days"),r.body.appendChild(ja),e=g("div","title-bar"),e.innerHTML=c.selectDaysToExcludeTitle,ja.appendChild(e),b=g("div","contents"),ja.appendChild(b),Lb=F(b,c.dayNames[0])[0],Mb=F(b,c.dayNames[1])[0],Nb=F(b,c.dayNames[2])[0],Ob=F(b,c.dayNames[3])[0],Pb=F(b,c.dayNames[4])[0],Qb=F(b,c.dayNames[5])[0],
Rb=F(b,c.dayNames[6])[0],e=g("div","split"),b.appendChild(e),b=g("input","ok","button"),b.value=c.okText,b.onclick=Yd,e.appendChild(b),b=g("input","cancel","button"),b.value=c.cancelText,b.onclick=Rc,e.appendChild(b),null!==ka&&B(r.body,ka),ka=g("div","calendar-dialog confirmation"),r.body.appendChild(ka),qc=g("div","title-bar"),ka.appendChild(qc),e=g("div","contents"),ka.appendChild(e),rc=g("div","message"),e.appendChild(rc),b=F(e,c.removeAllEventsInSeriesText),sc=b[0],Sc=b[1],b=g("div","split"),
e.appendChild(b),gb=g("input","yes","button"),gb.value=c.yesText,b.appendChild(gb),hb=g("input","no","button"),hb.value=c.noText,b.appendChild(hb),null!==la&&B(r.body,la),la=g("div","calendar-dialog select-export-type"),r.body.appendChild(la),e=g("div","title-bar"),e.innerHTML=c.selectExportTypeTitle,la.appendChild(e),b=g("div","contents"),la.appendChild(b),e=g("div","radioButtonsContainer"),b.appendChild(e),tc=T(e,"CSV","ExportType"),Tc=T(e,"XML","ExportType"),Uc=T(e,"JSON","ExportType"),Vc=T(e,
"TEXT","ExportType"),Wc=T(e,"iCAL","ExportType"),e=g("div","split"),b.appendChild(e),b=g("input","ok","button"),b.value=c.okText,b.onclick=Zd,e.appendChild(b),b=g("input","cancel","button"),b.value=c.cancelText,b.onclick=Xc,e.appendChild(b),null!==y&&B(r.body,y),y=g("div","calendar-dialog search"),r.body.appendChild(y),e=g("div","title-bar"),e.innerHTML=c.searchEventsTitle,e.onmousedown=$d,e.onmouseup=ae,y.appendChild(e),b=g("div","ib-close"),b.onclick=be,e.appendChild(b),p(b,c.closeTooltipText),
ma=g("div","ib-minus"),ma.onclick=ce,e.appendChild(ma),p(ma,c.minimizedTooltipText),J=g("div","contents"),y.appendChild(J),e=g("p"),e.innerText=c.forText,J.appendChild(e),U=g("input",null,"text"),U.oninput=xa,U.onpropertychange=xa,U.onkeypress=de,J.appendChild(U),Yc=F(J,c.matchCaseText,xa)[0],e=g("p"),e.innerText=c.includeText,J.appendChild(e),e=g("div","checkboxContainer"),J.appendChild(e),Zc=F(e,c.titleText.replace(":",""),xa)[0],$c=F(e,c.locationText.replace(":",""),xa)[0],ad=F(e,c.descriptionText.replace(":",
""),xa)[0],e=g("div","split"),J.appendChild(e),Qa=g("input","previous","button"),Qa.value=c.previousText,Qa.onclick=ee,e.appendChild(Qa),ya=g("input","next","button"),ya.value=c.nextText,ya.onclick=bd,e.appendChild(ya),r.body.addEventListener("mousemove",fe),null===w&&(w=g("div"),r.body.appendChild(w),uc=g("div","title"),Sb=g("div","date"),ib=g("div","repeats"),jb=g("div","description"),kb=g("div","location"),document.body.addEventListener("mousemove",vc)),ge(),he());lb.innerHTML=c.monthNames[u.getMonth()]+
", "+u.getFullYear()+" \u25be"}function mb(){var a=[];nb(function(d){a.push(d)});return a}function nb(a){for(var d in K)if(K.hasOwnProperty(d))for(var b in K[d])if(K[d].hasOwnProperty(b)){var e=cd(K[d][b]);if(a(e,d,b))return}}function za(a,d){d=h(d)?d:!0;a=a.sort(function(b,e){return b.from-e.from});d&&(a=a.sort(function(b,e){return dd(e.isAllDay)-dd(b.isAllDay)}));return a}function Rd(){C=g("div","header-date");A.appendChild(C);c.fullScreenModeEnabled&&(C.ondblclick=function(){Y()});var a=g("div",
"ib-arrow-left-full");a.onclick=wc;a.ondblclick=t;C.appendChild(a);p(a,c.previousMonthTooltipText);a=g("div","ib-pin");a.onclick=xc;a.ondblclick=t;C.appendChild(a);p(a,c.todayTooltipText);a=g("div","ib-refresh");a.onclick=Tb;a.ondblclick=t;C.appendChild(a);p(a,c.refreshTooltipText);a=g("div","ib-search");a.onclick=ed;a.ondblclick=t;C.appendChild(a);p(a,c.searchTooltipText);a=g("div","ib-arrow-right-full");a.onclick=yc;a.ondblclick=t;C.appendChild(a);p(a,c.nextMonthTooltipText);c.manualEditingEnabled&&
(a=g("div","ib-plus"),a.onclick=Ub,a.ondblclick=t,C.appendChild(a),p(a,c.addEventTooltipText));c.exportEventsEnabled&&(Ra=g("div","ib-arrow-down-full-line"),Ra.ondblclick=t,C.appendChild(Ra),p(Ra,c.exportEventsTooltipText),Ra.onclick=function(){Vb()});a=g("div","ib-eye");a.ondblclick=t;C.appendChild(a);a.onclick=function(){fd(!0)};p(a,c.listAllEventsTooltipText);a=g("div","ib-hamburger");a.ondblclick=t;C.appendChild(a);a.onclick=function(){ob(null,!0)};p(a,c.listWeekEventsTooltipText);c.fullScreenModeEnabled&&
(Z=g("div","ib-arrow-expand-left-right"),Z.ondblclick=t,C.appendChild(Z),p(Z,c.enableFullScreenTooltipText),Z.onclick=function(){Y()});a=g("div","title-container");C.appendChild(a);lb=g("span");lb.ondblclick=t;a.appendChild(lb);ie(a)}function ie(a){var d=new Date(1900,1,1),b=(new Date).getFullYear()-d.getFullYear()+c.extraSelectableYearsAhead;L=g("div","years-drop-down");a.appendChild(L);Wb=g("div","contents custom-scroll-bars");L.appendChild(Wb);for(a=0;a<b;a++)je(d.getFullYear()),d.setFullYear(d.getFullYear()+
1);lb.onclick=ke}function je(a){var d=g("div");d.innerText=a.toString();d.id="year-selected-"+a.toString();Wb.appendChild(d);d.onclick=function(){u.setFullYear(a);P(u);Xb()&&(L.style.display="none")}}function cd(a){a.isAllDay&&(a.from=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),0,0),a.to=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),23,59));return a}function pb(a,d){var b=new Date(a.getFullYear(),a.getMonth(),a.getDate()),e=new Date(d.getFullYear(),d.getMonth(),
d.getDate());return Math.ceil(Math.abs(e-b)/864E5)}function ke(a){if("block"!==L.style.display){sa();t(a);a=L.getElementsByClassName("current-year-selected");if(1<=a.length)for(var d=a.length,b=0;b<d;b++)a[b].removeAttribute("class");a=Ia("year-selected-"+u.getFullYear());null!==a&&(a.className="current-year-selected");L.style.display="block";Wb.scrollTop=a.offsetTop-L.offsetHeight/2}}function Xb(){return null!==L&&"block"===L.style.display}function Aa(a){if(null!==c&&zc(c[a]))c[a]()}function Yb(a,
d){if(null!==c&&zc(c[a]))c[a](d)}function gd(){for(var a=[],d=0;32>d;d++){8!==d&&12!==d&&16!==d&&20!==d||a.push("-");var b=Math.floor(16*Math.random()).toString(16);a.push(b)}return a.join("")}function Y(){Sa?hd():id()}function id(){!Sa&&c.fullScreenModeEnabled&&(jd=A.style.cssText,Sa=!0,Z.className="ib-arrow-contract-left-right",aa.className="ib-arrow-contract-left-right",ba.className="ib-arrow-contract-left-right",ca.className="ib-arrow-contract-left-right",p(Z,c.disableFullScreenTooltipText),p(aa,
c.disableFullScreenTooltipText),p(ba,c.disableFullScreenTooltipText),p(ca,c.disableFullScreenTooltipText),A.className+=" full-screen-view",A.removeAttribute("style"))}function hd(){Sa&&c.fullScreenModeEnabled&&(Sa=!1,Z.className="ib-arrow-expand-left-right",aa.className="ib-arrow-expand-left-right",ba.className="ib-arrow-expand-left-right",ca.className="ib-arrow-expand-left-right",p(Z,c.enableFullScreenTooltipText),p(aa,c.enableFullScreenTooltipText),p(ba,c.enableFullScreenTooltipText),p(ca,c.enableFullScreenTooltipText),
A.className=A.className.replace(" full-screen-view",""),A.style.cssText=jd)}function Sd(){kd||(r.body.addEventListener("click",sa),r.body.addEventListener("contextmenu",sa),Ba.addEventListener("resize",sa),Ba.addEventListener("resize",ld),r.addEventListener("keydown",function(a){Sa&&md()&&(37===a.keyCode&&(a.ctrlKey||a.metaKey)?(a.preventDefault(),nd()):39===a.keyCode&&(a.ctrlKey||a.metaKey)?(a.preventDefault(),od()):70===a.keyCode&&(a.ctrlKey||a.metaKey)?(a.preventDefault(),ed()):27===a.keyCode?
Y():37===a.keyCode?wc():39===a.keyCode?yc():40===a.keyCode?xc():116===a.keyCode&&Tb())}),kd=!0)}function sa(){Ac()&&(G.style.display="none");Bc()&&(M.style.display="none");Xb()&&(L.style.display="none");vc()}function fa(){le();pd();for(var a=za(mb()),d=a.length,b=0;b<d;b++){var e=a[b];null!==Zb(e.from)&&me(e);var f=da(e.repeatEvery);0<f&&(1===f?$b(e,function(k){k.setDate(k.getDate()+1)}):2===f?$b(e,function(k){k.setDate(k.getDate()+7)}):3===f?$b(e,function(k){k.setMonth(k.getMonth()+1)}):4===f&&$b(e,
function(k){k.setFullYear(k.getFullYear()+1)}))}c.exportEventsEnabled&&(Ra.style.display=0===d?"none":"inline-block");qd()}function $b(a,d){for(var b=new Date(a.from),e=V(a.repeatEveryExcludeDays),f=V(a.seriesIgnoreDates);b<oc;){d(b);var k=Ca(b);-1===e.indexOf(b.getDay())&&-1===f.indexOf(k)&&null!==Zb(b)&&Cc(b,a)}}function me(a){Cc(a.from,a);if(a.from.getDate()!==a.to.getDate()){var d=pb(a.from,a.to);if(0<d)for(var b=new Date(a.from),e=0;e<d;e++)b.setDate(b.getDate()+1),null!==Zb(b)&&Cc(b,a)}}function Cc(a,
d){var b=Zb(a);if(null!==b){var e=c.manualEditingEnabled?"event":"event-no-hover";if(b.getElementsByClassName(e).length<c.maximumEventsPerDayDisplay){e=g("div",e);var f=d.title;c.showTimesInMainCalendarEvents&&!d.isAllDay&&d.from.getDate()===d.to.getDate()&&(f=qb(d.from,d.to)+": "+f);e.innerHTML=f;b.appendChild(e);ac(d,e,Dc(d,a));e.onmousemove=function(l){rd(l,d)};if(c.manualEditingEnabled){var k=Ca(a);e.oncontextmenu=function(l){bc(l,d,k)}}c.manualEditingEnabled&&(e.onclick=function(){na(d)});c.dragAndDropForEventsEnabled&&
c.manualEditingEnabled&&(e.setAttribute("draggable",!0),e.ondragstart=function(){x=d})}else e=b.getElementsByClassName("plus-x-events"),e=0<e.length?e[0]:null,null===e?(e=g("div","plus-x-events"),e.setAttribute("events","1"),e.innerHTML="+1 "+c.moreText,b.appendChild(e)):(b=parseInt(e.getAttribute("events"))+1,e.setAttribute("events",b.toString()),e.innerHTML="+"+b+" "+c.moreText)}}function Zb(a){var d=new Date(u.getFullYear(),u.getMonth(),1);var b=new Date(u);var e=new Date(u),f=null,k=0;d=Ec(d);
b.setMonth(b.getMonth()+1);e.setMonth(e.getMonth()-1);a.getMonth()===b.getMonth()&&a.getFullYear()===b.getFullYear()?(b=d+Db(u.getFullYear(),u.getMonth()),k=a.getDate()+b):a.getMonth()===e.getMonth()&&a.getFullYear()===e.getFullYear()?k=d-pb(a,u)+1:a.getMonth()===u.getMonth()&&a.getFullYear()===u.getFullYear()&&(b=d,k=a.getDate()+b);0<k&&(f=Ia("calendar-day-"+k));return f}function le(){for(var a=0;6>a;a++)for(var d=0;7>d;d++){var b=Ia("calendar-day-"+(7*a+(d+1)));sd(b,c.manualEditingEnabled?"event":
"event-no-hover");sd(b,"plus-x-events")}}function sd(a,d){for(var b=a.getElementsByClassName(d);b[0];)b[0].parentNode.removeChild(b[0])}function ac(a,d,b){h(b)&&b<new Date&&(d.className+=" expired");N(a.color)?(d.style.backgroundColor=a.color,N(a.colorText)&&(d.style.color=a.colorText),N(a.colorBorder)&&(d.style.borderLeftColor=a.colorBorder)):a.isAllDay&&(d.className+=" all-day")}function Dc(a,d){var b=da(a.repeatEvery),e=new Date(a.to);0<b&&(b=new Date(d),b.setHours(e.getHours(),e.getMinutes()),
e=b);return e}function Qd(){Da=g("div","full-day-view");A.appendChild(Da);var a=g("div","title-bar");Da.appendChild(a);c.fullScreenModeEnabled&&(a.ondblclick=function(){Y()});rb=g("div","title");a.appendChild(rb);var d=g("div","ib-close");d.ondblclick=t;a.appendChild(d);p(d,c.closeTooltipText);d.onclick=function(){Fc(Da);W=null};c.manualEditingEnabled&&(d=g("div","ib-plus"),d.onclick=Ub,d.ondblclick=t,a.appendChild(d),p(d,c.addEventTooltipText));d=g("div","ib-arrow-right-full");d.onclick=ne;d.ondblclick=
t;a.appendChild(d);p(d,c.nextDayTooltipText);d=g("div","ib-arrow-left-full");d.onclick=oe;d.ondblclick=t;a.appendChild(d);p(d,c.previousDayTooltipText);c.exportEventsEnabled&&(Ta=g("div","ib-arrow-down-full-line"),Ta.ondblclick=t,a.appendChild(Ta),p(Ta,c.exportEventsTooltipText),Ta.onclick=function(){Vb(Gc)});c.fullScreenModeEnabled&&(aa=g("div","ib-arrow-expand-left-right"),aa.ondblclick=t,a.appendChild(aa),p(aa,c.enableFullScreenTooltipText),aa.onclick=function(){Y()});sb=g("div","contents custom-scroll-bars");
Da.appendChild(sb)}function tb(a,d){d=h(d)?d:!1;rb.innerText="";sb.innerHTML="";W=a;Gc=[];d&&(sb.scrollTop=0);Hc(Da);Ea(rb,a,!1,!0,!0);var b=td(a),e=[];if(null!==b){var f=g("span","holiday");f.innerText=" ("+b+")";rb.appendChild(f)}nb(function(k){for(var l=pb(k.from,k.to)+1,m=new Date(k.from),n=0;n<l;n++){if(m.getFullYear()===a.getFullYear()&&m.getMonth()===a.getMonth()&&m.getDate()===a.getDate()){e.push(k);break}m.setDate(m.getDate()+1)}l=da(k.repeatEvery);0<l&&(1===l?cc(k,e,a,function(q){q.setDate(q.getDate()+
1)}):2===l?cc(k,e,a,function(q){q.setDate(q.getDate()+7)}):3===l?cc(k,e,a,function(q){q.setMonth(q.getMonth()+1)}):4===l&&cc(k,e,a,function(q){q.setFullYear(q.getFullYear()+1)}))});e=za(e);b=e.length;for(f=0;f<b;f++)pe(e[f],a);c.exportEventsEnabled&&(Ta.style.display=0===e.length?"none":"inline-block")}function cc(a,d,b,e){for(var f=new Date(a.from),k=V(a.repeatEveryExcludeDays),l=V(a.seriesIgnoreDates);f<b;){e(f);var m=Ca(f);if(-1===k.indexOf(f.getDay())&&-1===l.indexOf(m)&&f.getFullYear()===b.getFullYear()&&
f.getMonth()===b.getMonth()&&f.getDate()===b.getDate()){d.push(a);break}}}function pe(a,d){var b=g("div",c.manualEditingEnabled?"event":"event-no-hover");sb.appendChild(b);if(c.manualEditingEnabled){var e=Ca(d);b.oncontextmenu=function(k){bc(k,a,Ca(e))}}ac(a,b,Dc(a,d));var f=g("div","title");f.innerHTML=a.title;b.appendChild(f);f=g("div","date");b.appendChild(f);a.from.getDate()===a.to.getDate()?f.innerHTML=a.isAllDay?c.allDayText:qb(a.from,a.to):dc(f,a.from,a.to);ub(a.repeatEvery)&&0<a.repeatEvery&&
(f=g("div","repeats"),f.innerHTML=c.repeatsText.replace(":","")+" "+Ua(a.repeatEvery),b.appendChild(f));N(a.location)&&(f=g("div","location"),f.innerHTML=a.location,b.appendChild(f));N(a.description)&&(f=g("div","description"),f.innerHTML=a.description,b.appendChild(f));c.manualEditingEnabled&&(b.onclick=function(){na(a)});Gc.push(a)}function oe(){W.setDate(W.getDate()-1);tb(W,!0)}function ne(){W.setDate(W.getDate()+1);tb(W,!0)}function Od(){Fa=g("div","list-all-events-view");A.appendChild(Fa);var a=
g("div","title-bar");Fa.appendChild(a);c.fullScreenModeEnabled&&(a.ondblclick=function(){Y()});var d=g("div","title");d.innerHTML=c.allEventsText;a.appendChild(d);d=g("div","ib-close");d.ondblclick=t;a.appendChild(d);p(d,c.closeTooltipText);d.onclick=function(){Fc(Fa)};c.manualEditingEnabled&&(d=g("div","ib-plus"),d.onclick=Ub,d.ondblclick=t,a.appendChild(d),p(d,c.addEventTooltipText));c.exportEventsEnabled&&(vb=g("div","ib-arrow-down-full-line"),vb.ondblclick=t,a.appendChild(vb),p(vb,c.exportEventsTooltipText),
vb.onclick=function(){Vb()});c.fullScreenModeEnabled&&(ba=g("div","ib-arrow-expand-left-right"),ba.ondblclick=t,a.appendChild(ba),p(ba,c.enableFullScreenTooltipText),ba.onclick=function(){Y()});wb=g("div","contents custom-scroll-bars");Fa.appendChild(wb)}function fd(a){a=h(a)?a:!1;Hc(Fa);wb.innerHTML="";a&&(wb.scrollTop=0);a=za(mb());for(var d=a.length,b=0;b<d;b++){var e=a[b],f=e.from,k="month-"+f.getMonth()+"-"+f.getFullYear(),l=Ia(k);if(null===l){var m=g("div","month");wb.appendChild(m);l=g("div",
"header");l.innerHTML=c.monthNames[f.getMonth()]+" "+f.getFullYear();m.appendChild(l);l=g("div","events");l.id=k;m.appendChild(l)}qe(e,l)}}function qe(a,d){var b=g("div",c.manualEditingEnabled?"event":"event-no-hover");d.appendChild(b);c.manualEditingEnabled&&(b.oncontextmenu=function(f){bc(f,a)});ac(a,b);var e=g("div","title");e.innerHTML=a.title;b.appendChild(e);e=g("div","date");b.appendChild(e);a.from.getDate()===a.to.getDate()?a.isAllDay?ec(e,a.from,null," - "+c.allDayText):ec(e,a.from,null,
" - "+qb(a.from,a.to)):dc(e,a.from,a.to);ub(a.repeatEvery)&&0<a.repeatEvery&&(e=g("div","repeats"),e.innerHTML=c.repeatsText.replace(":","")+" "+Ua(a.repeatEvery),b.appendChild(e));N(a.location)&&(e=g("div","location"),e.innerHTML=a.location,b.appendChild(e));N(a.description)&&(e=g("div","description"),e.innerHTML=a.description,b.appendChild(e));c.manualEditingEnabled&&(b.onclick=function(){na(a)})}function Pd(){Ga=g("div","list-all-week-events-view");A.appendChild(Ga);var a=g("div","title-bar");
Ga.appendChild(a);c.fullScreenModeEnabled&&(a.ondblclick=function(){Y()});X=g("div","title");a.appendChild(X);var d=g("div","ib-close");d.ondblclick=t;a.appendChild(d);p(d,c.closeTooltipText);d.onclick=function(){Fc(Ga)};c.manualEditingEnabled&&(d=g("div","ib-plus"),d.onclick=Ub,d.ondblclick=t,a.appendChild(d),p(d,c.addEventTooltipText));d=g("div","ib-arrow-right-full");d.onclick=re;d.ondblclick=t;a.appendChild(d);p(d,c.nextWeekTooltipText);d=g("div","ib-arrow-left-full");d.onclick=se;d.ondblclick=
t;a.appendChild(d);p(d,c.previousWeekTooltipText);c.exportEventsEnabled&&(Va=g("div","ib-arrow-down-full-line"),Va.ondblclick=t,a.appendChild(Va),p(Va,c.exportEventsTooltipText),Va.onclick=function(){Vb(xb)});c.fullScreenModeEnabled&&(ca=g("div","ib-arrow-expand-left-right"),ca.ondblclick=t,a.appendChild(ca),p(ca,c.enableFullScreenTooltipText),ca.onclick=function(){Y()});yb=g("div","contents custom-scroll-bars");Ga.appendChild(yb)}function ob(a,d){d=h(d)?d:!1;Hc(Ga);yb.innerHTML="";Wa={};Ic={};xb=
[];oa=null===a?new Date:a;d&&(yb.scrollTop=0);var b=te(a),e=b[0];b=b[1];ue(e,b);for(var f=za(mb()),k=f.length,l=0;l<k;l++){for(var m=f[l],n=pb(m.from,m.to)+1,q=new Date(m.from),Ha=!1,Xa=0;Xa<n;Xa++)q>=e&&q<=b&&(Ha=ud(q),vd(m,Ha,q),Ha=!0),q.setDate(q.getDate()+1);Ha&&xb.push(m);n=da(m.repeatEvery);q=!1;0<n&&(1===n?q=fc(m,e,b,function(O){O.setDate(O.getDate()+1)}):2===n?q=fc(m,e,b,function(O){O.setDate(O.getDate()+7)}):3===n?q=fc(m,e,b,function(O){O.setMonth(O.getMonth()+1)}):4===n&&(q=fc(m,e,b,function(O){O.setFullYear(O.getFullYear()+
1)})));q&&!Ha&&xb.push(m)}for(var wd in Wa)Wa.hasOwnProperty(wd)&&yb.appendChild(Wa[wd]);c.exportEventsEnabled&&(Va.style.display=0===xb.length?"none":"inline-block")}function fc(a,d,b,e){for(var f=new Date(a.from),k=V(a.repeatEveryExcludeDays),l=V(a.seriesIgnoreDates),m=!1;f<b;){e(f);var n=Ca(f);-1===k.indexOf(f.getDay())&&-1===l.indexOf(n)&&f>=d&&f<=b&&(m=ud(f),vd(a,m,f),m=!0)}return m}function ue(a,d){X.innerHTML="";if(a.getFullYear()===d.getFullYear()){Ea(X,a,!1,!1);var b=g("span");b.innerHTML=
" - ";X.appendChild(b);Ea(X,d,!1,!1);b=g("span");b.innerHTML=", "+a.getFullYear();X.appendChild(b)}else Ea(X,a,!1,!0),b=g("span"),b.innerHTML=" - ",X.appendChild(b),Ea(X,d,!1,!0)}function vd(a,d,b){var e=g("div",c.manualEditingEnabled?"event":"event-no-hover");d.appendChild(e);if(c.manualEditingEnabled){var f=Ca(b);e.oncontextmenu=function(k){bc(k,a,f)}}ac(a,e,Dc(a,b));d=g("div","title");d.innerHTML=a.title;e.appendChild(d);d=g("div","date");e.appendChild(d);a.from.getDate()===a.to.getDate()?d.innerHTML=
a.isAllDay?c.allDayText:qb(a.from,a.to):dc(d,a.from,a.to);ub(a.repeatEvery)&&0<a.repeatEvery&&(d=g("div","repeats"),d.innerHTML=c.repeatsText.replace(":","")+" "+Ua(a.repeatEvery),e.appendChild(d));N(a.location)&&(d=g("div","location"),d.innerHTML=a.location,e.appendChild(d));N(a.description)&&(d=g("div","description"),d.innerHTML=a.description,e.appendChild(d));c.manualEditingEnabled&&(e.onclick=function(){na(a)})}function ud(a){var d=Ec(a),b=a.getFullYear()+a.getMonth()+d;if(Wa.hasOwnProperty(b))a=
Ic[b];else{var e=g("div","day");Wa[b]=e;var f=g("div","header");e.appendChild(f);ec(f,a,c.dayNames[d]+", ");a=g("div","events");e.appendChild(a);Ic[b]=a}return a}function Ec(a){return 0>a.getDay()-1?6:a.getDay()-1}function te(a){a=h(a)?a:new Date;var d=0===a.getDay()?7:a.getDay();d=a.getDate()-d+1;var b=d+6,e=new Date(a);a=new Date(a);e.setDate(d);e.setHours(0,0,0,0);a.setDate(b);a.setHours(23,59,59,99);return[e,a]}function se(){oa.setDate(oa.getDate()-7);ob(oa,!0)}function re(){oa.setDate(oa.getDate()+
7);ob(oa,!0)}function qb(a,d){return Jc(a)+" "+c.toTimeText+" "+Jc(d)}function Jc(a){return H(a.getHours())+":"+H(a.getMinutes())}function dc(a,d,b){a.innerHTML="";var e=g("span");e.innerText=c.startsOnText+" ";a.appendChild(e);Ea(a,d);d=g("span");d.innerText=" "+c.andFinishesOnText+" ";a.appendChild(d);Ea(a,b)}function Ea(a,d,b,e,f){b=h(b)?b:!0;e=h(e)?e:!0;if(f=h(f)?f:!1){f=Ec(d);var k=g("span");k.innerText=c.dayNames[f]+", ";a.appendChild(k)}ec(a,d);f=g("span");f.innerText=" "+c.monthNames[d.getMonth()];
a.appendChild(f);e&&(e=g("span"),e.innerText=" "+d.getFullYear(),a.appendChild(e));b&&(b=g("span"),b.innerText=" "+Jc(d),a.appendChild(b))}function ec(a,d,b,e){if(h(b)){var f=g("span");f.innerText=b;a.appendChild(f)}b=g("span");b.innerText=d.getDate();a.appendChild(b);c.showDayNumberOrdinals&&(b=g("sup"),b.innerText=xd(d.getDate()),a.appendChild(b));h(e)&&(d=g("span"),d.innerText=e,a.appendChild(d))}function nc(a,d,b,e,f){var k=new Date;k=a===k.getDate()&&e===k.getFullYear()&&b===k.getMonth();var l=
Ia("calendar-day-"+d);d=g("span");var m=new Date(e,b,a);l.innerHTML="";d.className=f?"day-muted":"";d.className+=k?" today":"";d.innerText=a;if(6===m.getDay()||0===m.getDay()&&"cell"===l.className)l.className="cell weekend-day";l.oncontextmenu=function(q){gc=m;sa();t(q);Kc(q,G)};c.showDayNumberOrdinals&&(f=g("sup"),f.innerText=xd(a),d.appendChild(f));l.appendChild(d);f=g("div","expand-day");l.appendChild(f);p(f,c.expandDayTooltipText);k=td(m);if(null!==k){var n=g("span","holiday");n.innerText=k;d.appendChild(n)}f.onclick=
function(){tb(m,!0)};c.manualEditingEnabled&&(l.ondblclick=function(){na(null,m)},c.manualEditingEnabled&&(l.ondragover=function(q){t(q);yd(l)},l.ondragenter=function(q){t(q);yd(l)},l.ondragleave=function(q){t(q);zd(l)},l.ondrop=function(q){t(q);if(null!==x){q=pb(x.from,x.to);var Ha=new Date(e,b,a,x.from.getHours(),x.from.getMinutes()),Xa=new Date(e,b,a,x.to.getHours(),x.to.getMinutes());0<q&&Xa.setDate(Xa.getDate()+q);Ya.updateEvent(x.id,{from:Ha,to:Xa,title:x.title,description:x.description,location:x.location,
isAllDay:x.isAllDay,color:x.color,colorText:x.colorText,colorBorder:x.colorBorder,repeatEvery:x.repeatEvery,repeatEveryExcludeDays:x.repeatEveryExcludeDays})}zd(l)}))}function yd(a){-1===a.className.indexOf(" drag-over")&&(a.className+=" drag-over")}function zd(a){-1<a.className.indexOf(" drag-over")&&(a.className=a.className.replace(" drag-over",""))}function Db(a,d){return(new Date(a,d+1,0)).getDate()}function xd(a){var d=c.thText;if(31===a||21===a||1===a)d=c.stText;else if(22===a||2===a)d=c.ndText;
else if(23===a||3===a)d=c.rdText;return d}function td(a){for(var d=null,b=[],e=c.holidays.length,f=0;f<e;f++){var k=c.holidays[f];da(k.day)===a.getDate()&&da(k.month)===a.getMonth()+1&&(k=v(k.title,null),null!==k&&b.push(k))}0<b.length&&(d=b.join(", "));return d}function ge(){null!==G&&B(r.body,G);G=g("div","calendar-drop-down-menu");r.body.appendChild(G);if(c.manualEditingEnabled){var a=g("div","item");a.innerHTML=c.addEventTitle;G.appendChild(a);a.onclick=function(){na(null,gc)};a=g("div","separator");
G.appendChild(a)}a=g("div","item");a.innerHTML=c.expandDayTooltipText;G.appendChild(a);a.onclick=function(){tb(gc,!0)};a=g("div","separator");G.appendChild(a);a=g("div","item");a.innerHTML=c.listWeekEventsTooltipText;G.appendChild(a);a.onclick=function(){ob(gc,!0)}}function he(){null!==M&&B(r.body,M);if(c.manualEditingEnabled){M=g("div","calendar-drop-down-menu");r.body.appendChild(M);var a=g("div","item");a.innerHTML=c.removeEventText;M.appendChild(a);a.onclick=function(){Za(r.body,Q);var d=function(){B(r.body,
Q)},b=0<da(pa.repeatEvery)&&null!==zb;Ad(c.confirmEventRemoveTitle,c.confirmEventRemoveMessage,function(){d();h(pa.id)&&(sc.checked||null===zb?Ya.removeEvent(pa.id,!0):(Bd(pa.seriesIgnoreDates)?pa.seriesIgnoreDates.push(zb):pa.seriesIgnoreDates=[zb],fa()),hc())},d,b)};a=g("div","separator");M.appendChild(a);a=g("div","item");a.innerHTML=c.editEventTitle;M.appendChild(a);a.onclick=function(){na(pa)}}}function bc(a,d,b){pa=d;zb=h(b)?b:null;sa();t(a);Kc(a,M)}function Ac(){return null!==G&&"block"===
G.style.display}function Bc(){return null!==M&&"block"===M.style.display}function va(a,d){try{a.type=d}catch(b){a.type="text"}}function Ub(){na(null,W)}function Ja(){Ka.disabled=wa.checked}function Gb(){var a=!1;cb.checked&&(E.value=I.value,R.value="00:00",S.value="23:59",a=!0);E.disabled=a;R.disabled=a;S.disabled=a;a=ic(I);var d=ic(E);d>a||d<a?(a=!0,wa.checked=!0):a=!1;wa.disabled=a;Hb.disabled=a;Ib.disabled=a;Jb.disabled=a;Kb.disabled=a;Ka.disabled=a;Ja()}function na(a,d){Za(r.body,Q);if(h(a)){La.value=
c.updateText;Ma.style.display="block";Fb.innerHTML=c.editEventTitle;D=a;I.value=jc(a.from,I.type);R.value=kc(a.from);E.value=jc(a.to,E.type);S.value=kc(a.to);cb.checked=a.isAllDay;ua.value=v(a.title);eb.value=v(a.description);db.value=v(a.location);Na.value=v(a.color,"#484848");Oa.value=v(a.colorText,"#F5F5F5");Pa.value=v(a.colorBorder,"#282828");var b=da(a.repeatEvery);0===b?wa.checked=!0:1===b?Hb.checked=!0:2===b?Ib.checked=!0:3===b?Jb.checked=!0:4===b&&(Kb.checked=!0);b=V(a.repeatEveryExcludeDays);
Lb.checked=-1<b.indexOf(1);Mb.checked=-1<b.indexOf(2);Nb.checked=-1<b.indexOf(3);Ob.checked=-1<b.indexOf(4);Pb.checked=-1<b.indexOf(5);Qb.checked=-1<b.indexOf(6);Rb.checked=-1<b.indexOf(0)}else{b=new Date;var e=h(d)?d:b,f=new Date;e.getDate()===f.getDate()&&e.getFullYear()===f.getFullYear()&&e.getMonth()===f.getMonth()&&(e.setHours(b.getHours()),e.setMinutes(b.getMinutes()));La.value=c.addText;Ma.style.display="none";Fb.innerHTML=c.addEventTitle;D={};I.value=jc(e,I.type);R.value=kc(e);E.value=jc(e,
E.type);S.value=kc(e);cb.checked=!1;ua.value="";eb.value="";db.value="";Na.value="#484848";Oa.value="#F5F5F5";Pa.value="#282828";wa.checked=!0;Lb.checked=!1;Mb.checked=!1;Nb.checked=!1;Ob.checked=!1;Pb.checked=!1;Qb.checked=!1;Rb.checked=!1}Gb();ta.style.display="block";fb.style.display="none";ua.focus()}function Vd(){var a=ic(I),d=ic(E),b=R.value.split(":"),e=S.value.split(":"),f=Lc(ua.value),k=Lc(eb.value),l=Lc(db.value);2>b.length?lc(c.fromTimeErrorMessage,R):2>e.length?lc(c.toTimeErrorMessage,
S):""===f?lc(c.titleErrorMessage,ua):(Cd(a,R.value),Cd(d,S.value),d<a?lc(c.toSmallerThanFromErrorMessage,E):(pc(),b=h(D.id),a={from:a,to:d,title:f,description:k,location:l,isAllDay:cb.checked,color:D.color,colorText:D.colorText,colorBorder:D.colorBorder,repeatEveryExcludeDays:D.repeatEveryExcludeDays},wa.checked?a.repeatEvery=0:Hb.checked?a.repeatEvery=1:Ib.checked?a.repeatEvery=2:Jb.checked?a.repeatEvery=3:Kb.checked&&(a.repeatEvery=4),b||(a.organizerName=c.organizerName,a.organizerEmailAddress=
c.organizerEmailAddress),b?Ya.updateEvent(D.id,a,!1):Ya.addEvent(a,!1),fa(),hc()))}function Cd(a,d){var b=0,e=0,f=d.split(":");if(2===f.length){var k=parseInt(f[0]);f=parseInt(f[1]);!isNaN(k)&&2>=k.toString().length&&(b=k);!isNaN(f)&&2>=f.toString().length&&(e=f)}a.setHours(b);a.setMinutes(e)}function ic(a){var d=new Date;if("date"===a.type)d=new Date(a.value);else if(a=a.value.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/))a=new Date(a[3],a[2]-1,a[1]),a instanceof Date&&!isNaN(a)&&(d=a);return d}function pc(){ta.style.display=
"none";B(r.body,Q)}function Wd(){ha.style.display="block";var a=function(){ha.style.display="none"};Ad(c.confirmEventRemoveTitle,c.confirmEventRemoveMessage,function(){a();pc();h(D.id)&&(Ya.removeEvent(D.id,!0),hc())},a)}function jc(a,d){var b=("0"+a.getDate()).slice(-2),e=("0"+(a.getMonth()+1)).slice(-2);return"date"===d?a.getFullYear()+"-"+e+"-"+b:b+"/"+e+"/"+a.getFullYear()}function Ca(a){var d=("0"+a.getDate()).slice(-2),b=("0"+a.getMonth()).slice(-2);return d+"/"+b+"/"+a.getFullYear()}function kc(a){return H(a.getHours())+
":"+H(a.getMinutes())}function H(a){a=a.toString();return 1===a.length?"0"+a:a}function lc(a,d){fb.innerHTML=a;fb.style.display="block";d.focus()}function Lc(a){return a.replace(/^\s+|\s+$/g,"")}function hc(){Ab(Da)&&tb(W);Ab(Fa)&&fd();Ab(Ga)&&ob(oa)}function Xd(){Qc();D.color=Na.value;D.colorText=Oa.value;D.colorBorder=Pa.value}function Qc(){ia.style.display="none";ha.style.display="none"}function Td(){ia.style.display="block";ha.style.display="block"}function Yd(){Rc();var a=[];Lb.checked&&a.push(1);
Mb.checked&&a.push(2);Nb.checked&&a.push(3);Ob.checked&&a.push(4);Pb.checked&&a.push(5);Qb.checked&&a.push(6);Rb.checked&&a.push(0);D.repeatEveryExcludeDays=a}function Rc(){ja.style.display="none";ha.style.display="none"}function Ud(){ja.style.display="block";ha.style.display="block"}function Ad(a,d,b,e,f){f=h(f)?f:!1;ka.style.display="block";qc.innerHTML=a;rc.innerHTML=d;gb.onclick=Dd;hb.onclick=Dd;gb.addEventListener("click",b);sc.checked=!1;Sc.style.display=f?"block":"none";zc(e)&&hb.addEventListener("click",
e)}function Dd(){ka.style.display="none"}function Vb(a){Za(r.body,Q);la.style.display="block";$a=a;tc.checked=!0}function Xc(){B(r.body,Q);la.style.display="none"}function Zd(){Xc();tc.checked?ab($a,"csv"):Tc.checked?ab($a,"xml"):Uc.checked?ab($a,"json"):Vc.checked?ab($a,"text"):Wc.checked&&ab($a,"ical")}function $d(a){Bb||(Bb=!0,Ed=a.pageX-y.offsetLeft,Fd=a.pageY-y.offsetTop)}function fe(a){Bb&&(y.style.left=a.pageX-Ed+"px",y.style.top=a.pageY-Fd+"px")}function ae(){Bb&&(Bb=!1,Gd=!0)}function xa(){Qa.disabled=
!0;ya.disabled=""===U.value;ea=[];qa=0}function ed(){"block"!==y.style.display&&(ea=[],y.style.display="block",U.value="",ld(),xa());U.focus()}function ld(){Gd||(y.style.left=Ba.innerWidth/2-y.offsetWidth/2+"px",y.style.top=Ba.innerHeight/2-y.offsetHeight/2+"px")}function be(){y.style.display="none"}function ce(){"none"!==J.style.display?(J.style.display="none",ma.className="ib-square-hollow",p(ma,c.restoreTooltipText)):(J.style.display="block",ma.className="ib-minus",p(ma,c.minimizedTooltipText))}
function ee(){0<qa&&(qa--,Hd(),P(ea[qa].from))}function de(a){13!==a.keyCode||ya.disabled||bd()}function bd(){if(0===ea.length){var a=Yc.checked,d=a?U.value:U.value.toLowerCase(),b={};nb(function(e){var f=v(e.title),k=v(e.location),l=v(e.description),m=!1;a||(f=f.toLowerCase(),l=l.toLowerCase(),k=k.toLowerCase());Zc.checked&&-1<f.indexOf(d)?m=!0:$c.checked&&-1<k.indexOf(d)?m=!0:ad.checked&&-1<l.indexOf(d)&&(m=!0);m&&(f=e.from.getMonth()+"-"+e.from.getFullYear(),b.hasOwnProperty(f)||(ea.push(e),b[f]=
!0))})}else qa++;Hd();0<ea.length&&P(ea[qa].from)}function Hd(){Qa.disabled=0===qa;ya.disabled=qa===ea.length-1||0===ea.length}function rd(a,d,b){t(a);null!==ra&&(clearTimeout(ra),ra=null);vc();"block"!==w.style.display&&(ra=setTimeout(function(){r.body.contains(Q)||Xb()||Ac()||Bc()||(b=h(b)?b:"",w.className=""===b?"calendar-tooltip-event":"calendar-tooltip",""!==b?w.innerHTML=b:(w.innerHTML="",w.appendChild(uc),w.appendChild(Sb),uc.innerHTML=d.title,ub(d.repeatEvery)&&0<d.repeatEvery?(ib.innerHTML=
c.repeatsText.replace(":","")+" "+Ua(d.repeatEvery),Za(w,ib)):(ib.innerHTML="",B(w,ib)),N(d.location)?(kb.innerHTML=d.location,Za(w,kb)):(kb.innerHTML="",B(w,kb)),N(d.description)?(jb.innerHTML=d.description,Za(w,jb)):(jb.innerHTML="",B(w,jb)),d.from.getDate()===d.to.getDate()?Sb.innerHTML=d.isAllDay?c.allDayText:qb(d.from,d.to):dc(Sb,d.from,d.to)),Kc(a,w))},c.eventTooltipDelay))}function vc(){null!==ra&&(clearTimeout(ra),ra=null);Id()&&(w.style.display="none")}function Id(){return null!==ra||null!==
w&&"block"===w.style.display}function p(a,d){a.onmousemove=function(b){rd(b,null,d)}}function qd(){null===Cb&&0<c.autoRefreshTimerDelay&&(Cb=setInterval(function(){Tb()},c.autoRefreshTimerDelay))}function pd(){null!==Cb&&0<c.autoRefreshTimerDelay&&(clearTimeout(Cb),Cb=null)}function Tb(){md()&&(hc(),fa())}function md(){return!Id()&&!r.body.contains(Q)&&!Xb()&&!Ac()&&!Bc()}function Hc(a){Ab(a)||(a.className+=" overlay-shown")}function Fc(a){Ab(a)&&(a.className=a.className.replace(" overlay-shown",
""))}function Ab(a){return-1<a.className.indexOf("overlay-shown")}function g(a,d,b){a=a.toLowerCase();var e="text"===a;Mc.hasOwnProperty(a)||(Mc[a]=e?r.createTextNode(""):r.createElement(a));a=Mc[a].cloneNode(!1);h(d)&&(a.className=d);h(b)&&(a.type=b);return a}function Ia(a){bb.hasOwnProperty(a)&&null!==bb[a]||(bb[a]=r.getElementById(a));r.body.contains(bb[a])||(bb[a]=r.getElementById(a));return bb[a]}function Za(a,d){try{a.contains(d)||a.appendChild(d)}catch(b){console.warn(b.message)}}function B(a,
d){try{a.contains(d)&&a.removeChild(d)}catch(b){console.warn(b.message)}}function t(a){a.preventDefault();a.cancelBubble=!0}function Kc(a,d){var b=a.pageX,e=a.pageY;d.style.display="block";b+d.offsetWidth>Ba.innerWidth?b-=d.offsetWidth:b++;e+d.offsetHeight>Ba.innerHeight?e-=d.offsetHeight:e++;d.style.left=b+"px";d.style.top=e+"px"}function T(a,d,b,e){var f=g("div","radioButtonContainer");a.appendChild(f);a=g("label","radioButton");f.appendChild(a);f=g("input",null,"radio");f.name=b;a.appendChild(f);
h(e)&&(f.onchange=e);b=g("span","check-mark");a.appendChild(b);b=g("span","text");b.innerText=d;a.appendChild(b);return f}function F(a,d,b){var e=g("div");a.appendChild(e);a=g("label","checkbox");a.innerText=d;e.appendChild(a);d=g("input",null,"checkbox");a.appendChild(d);h(b)&&(d.onchange=b);b=g("span","check-mark");a.appendChild(b);return[d,a]}function h(a){return void 0!==a&&null!==a&&""!==a}function zc(a){return h(a)&&"function"===typeof a}function Jd(a){return h(a)&&"string"===typeof a}function ub(a){return h(a)&&
"number"===typeof a}function Bd(a){return h(a)&&"object"===typeof a&&a instanceof Array}function N(a){return Jd(a)&&""!==a}function ab(a,d){d=h(d)?d.toLowerCase():"csv";var b="",e=[];e=h(a)?e.concat(a):mb();e=za(e);e=za(e,!1);if("csv"===d){var f=[c.idText,c.fromText,c.toText,c.isAllDayText,c.titleText,c.descriptionText,c.locationText,c.backgroundColorText,c.textColorText,c.borderColorText,c.repeatsText,c.repeatDaysToExcludeText,c.seriesIgnoreDatesText,c.createdText,c.organizerNameText,c.organizerEmailAddressText],
k=f.length;b=[];for(var l=[],m=0;m<k;m++)b.push(z(f[m]));l.push(b.join(","));f=e.length;for(k=0;k<f;k++){b=l;m=e[k];var n=[];n.push(z(v(m.id)));n.push(z(mc(m.from)));n.push(z(mc(m.to)));n.push(z(m.isAllDay?c.yesText:c.noText));n.push(z(v(m.title)));n.push(z(v(m.description)));n.push(z(v(m.location)));n.push(z(v(m.color)));n.push(z(v(m.colorText)));n.push(z(v(m.colorBorder)));n.push(z(Ua(m.repeatEvery)));n.push(z(V(m.repeatEveryExcludeDays).join(",")));n.push(z(V(m.seriesIgnoreDates).join(",")));n.push(z(mc(m.created)));
n.push(z(v(m.organizerName)));n.push(z(v(m.organizerEmailAddress)));b.push(n.join(","))}b=l.join("\n")}else if("xml"===d){f=[];f.push('<?xml version="1.0" ?>');f.push("<Events>");k=e.length;for(b=0;b<k;b++){m=e[b];f.push("<Event>");for(l in m)m.hasOwnProperty(l)&&(n=Kd(l),f.push("<"+n+">"+Nc(l,m[l])+"</"+n+">"));f.push("</Event>")}f.push("</Events>");b=f.join("\n")}else if("json"===d){l=[];l.push("{");l.push('"events:": [');k=e.length;for(b=0;b<k;b++){m=e[b];l.push("{");for(f in m)m.hasOwnProperty(f)&&
l.push('"'+f+'":"'+Nc(f,m[f])+'",');m=l[l.length-1];l[l.length-1]=m.substring(0,m.length-1);l.push("},")}l[l.length-1]="}";l.push("]");l.push("}");b=l.join("\n")}else if("text"===d){l=[];f=e.length;for(b=0;b<f;b++){m=e[b];for(k in m)m.hasOwnProperty(k)&&l.push(Kd(k)+": "+Nc(k,m[k]));l.push("")}l.pop();b=l.join("\n")}else if("ical"===d){l=[];l.push("BEGIN:VCALENDAR");l.push("VERSION:2.0");l.push("PRODID:-//hacksw/handcal//NONSGML v1.0//EN");f=e.length;for(k=0;k<f;k++)b=e[k],l.push("BEGIN:VEVENT"),
l.push("UID:"+v(b.id)),l.push("DTSTAMP:"+Oc(b.created)),l.push("ORGANIZER;CN="+v(b.organizerName)+":MAILTO:"+v(b.organizerEmailAddress)),l.push("DTSTART:"+Oc(b.from)),l.push("DTEND:"+Oc(b.to)),l.push("SUMMARY:"+v(b.title)),l.push("END:VEVENT");l.push("END:VCALENDAR");b=l.join("\n")}""!==b&&(e=g("a"),f=l=d,"text"===d?(l="plain",f="txt"):"ical"===d&&(l="calendar",f="ics"),e.style.display="none",e.setAttribute("target","_blank"),e.setAttribute("href","data:text/"+l+";charset=utf-8,"+encodeURIComponent(b)),
l=e.setAttribute,b=new Date,k=H(b.getDate())+"-"+H(b.getMonth())+"-"+b.getFullYear(),b=H(b.getHours())+"-"+H(b.getMinutes()),l.call(e,"download",c.exportStartFilename+k+"_"+b+"."+f),r.body.appendChild(e),e.click(),r.body.removeChild(e),Aa("onEventsExported"))}function mc(a){var d=H(a.getDate())+"/"+H(a.getMonth())+"/"+a.getFullYear();a=H(a.getHours())+":"+H(a.getMinutes());return d+" "+a}function v(a,d){d=h(d)?d:"";return Jd(a)?a:d}function da(a,d){d=h(d)?d:0;return ub(a)?a:d}function dd(a,d){d=h(d)?
d:0;return h(a)&&"boolean"===typeof a?a?1:0:d}function V(a,d){d=h(d)?d:[];return Bd(a)?a:d}function Ua(a){var d=c.repeatsNever;a=da(a);1===a?d=c.repeatsEveryDayText:2===a?d=c.repeatsEveryWeekText:3===a?d=c.repeatsEveryMonthText:4===a&&(d=c.repeatsEveryYearText);return d}function Kd(a){return a.charAt(0).toUpperCase()+a.slice(1)}function Nc(a,d){var b=v(d);"boolean"===typeof d?b=d?c.yesText:c.noText:"object"===typeof d&&d instanceof Date?b=mc(d):"object"===typeof d&&d instanceof Array?b=V(d).join(","):
"number"===typeof d&&(b="repeatEvery"===a?Ua(d):d.toString());return b}function Oc(a){var d=[];d.push(a.getFullYear());d.push(a.getMonth());d.push(a.getDate());d.push("T");d.push(a.getHours());d.push(a.getMinutes());d.push("00");d.push("Z");return d.join("")}function z(a){a=a.replace(/(\r\n|\n|\r)/gm,"").replace(/(\s\s)/gm," ");a=a.replace(/"/g,'""');return'"'+a+'"'}function wc(){var a=new Date(u);a.setMonth(a.getMonth()-1);a.setDate(1);P(a);Aa("onPreviousMonth")}function yc(){var a=new Date(u);a.setMonth(a.getMonth()+
1);a.setDate(1);P(a);Aa("onNextMonth")}function nd(){var a=new Date(u);a.setFullYear(a.getFullYear()-1);a.setDate(1);P(a);Aa("onPreviousYear")}function od(){var a=new Date(u);a.setFullYear(a.getFullYear()+1);a.setDate(1);P(a);Aa("onNextYear")}function xc(){var a=new Date;if(u.getMonth()!==a.getMonth()||u.getFullYear()!==a.getFullYear())P(),Aa("onToday")}var c={},Ya=this,u=null,oc=null,Mc={},bb={},r=null,Ba=null,Pc=null,Eb=!1,kd=!1,K={},Cb=null,x=null,jd=null,Sa=!1,A=null,C=null,lb=null,L=null,Wb=
null,Ra=null,Z=null,Q=null,ta=null,ha=null,Fb=null,I=null,R=null,E=null,S=null,cb=null,ua=null,eb=null,db=null,wa=null,Hb=null,Ib=null,Jb=null,Kb=null,Ka=null,fb=null,D={},La=null,Ma=null,ia=null,Na=null,Oa=null,Pa=null,ja=null,Lb=null,Mb=null,Nb=null,Ob=null,Pb=null,Qb=null,Rb=null,Da=null,rb=null,sb=null,W=null,Gc=[],Ta=null,aa=null,Fa=null,vb=null,ba=null,wb=null,Ga=null,X=null,Va=null,ca=null,yb=null,Wa={},Ic={},xb=[],oa=null,ka=null,qc=null,rc=null,sc=null,Sc=null,gb=null,hb=null,la=null,tc=
null,Tc=null,Uc=null,Vc=null,Wc=null,$a=null,w=null,uc=null,Sb=null,ib=null,jb=null,kb=null,ra=null,G=null,gc=null,M=null,pa=null,zb=null,y=null,ma=null,J=null,U=null,Yc=null,Zc=null,$c=null,ad=null,Qa=null,ya=null,Bb=!1,Gd=!1,Ed=0,Fd=0,ea=[],qa=0;this.turnOnFullScreen=function(){id()};this.turnOffFullScreen=function(){hd()};this.startTheAutoRefreshTimer=function(){qd()};this.stopTheAutoRefreshTimer=function(){pd()};this.moveToPreviousMonth=function(){wc()};this.moveToNextMonth=function(){yc()};this.moveToPreviousYear=
function(){nd()};this.moveToNextYear=function(){od()};this.moveToToday=function(){xc()};this.exportAllEvents=function(a){c.exportEventsEnabled&&(a=h(a)?a:"csv",ab(null,a))};this.refresh=function(){Tb()};this.addEvents=function(a,d,b){d=h(d)?d:!0;b=h(b)?b:!0;for(var e=a.length,f=0;f<e;f++)this.addEvent(a[f],!1,!1);b&&Yb("onEventAdded",a);d&&fa()};this.addEvent=function(a,d,b){var e=!1;if(a.from<=a.to){var f=a.from;f=f.getFullYear()+"-"+f.getMonth()+"-"+f.getDate();var k=gd();K.hasOwnProperty(f)||(K[f]=
{});K[f].hasOwnProperty(k)||(d=h(d)?d:!0,b=h(b)?b:!0,h(a.id)?k=a.id:a.id=k,h(a.created)||(a.created=new Date),K[f][k]=cd(a),e=!0,b&&Yb("onEventAdded",a),d&&fa())}return e};this.updateEvent=function(a,d,b,e){if(a=this.removeEvent(a,!1,!1))b=h(b)?b:!0,e=h(e)?e:!0,d.id=gd(),(a=this.addEvent(d,b,!1))&&e&&Yb("onEventUpdated",d);return a};this.removeEvent=function(a,d,b){var e=!1;nb(function(f,k,l){if(l===a)return d=h(d)?d:!0,b=h(b)?b:!0,delete K[k][l],e=!0,b&&Yb("onEventRemoved",f),d&&fa(),!0});return e};
this.clearEvents=function(a){a=h(a)?a:!0;K={};Aa("onEventsCleared");a&&fa()};this.getEvents=function(){return za(mb())};this.getEvent=function(a){var d=null;nb(function(b,e,f){if(f===a)return d=b,!0});return d};this.setOptions=function(a){c=null!==a&&"object"===typeof a?a:{};h(c.previousMonthTooltipText)||(c.previousMonthTooltipText="Previous Month");h(c.nextMonthTooltipText)||(c.nextMonthTooltipText="Next Month");h(c.previousDayTooltipText)||(c.previousDayTooltipText="Previous Day");h(c.nextDayTooltipText)||
(c.nextDayTooltipText="Next Day");h(c.previousWeekTooltipText)||(c.previousWeekTooltipText="Previous Week");h(c.nextWeekTooltipText)||(c.nextWeekTooltipText="Next Week");h(c.addEventTooltipText)||(c.addEventTooltipText="Add Event");h(c.closeTooltipText)||(c.closeTooltipText="Close");h(c.exportEventsTooltipText)||(c.exportEventsTooltipText="Export Events");h(c.todayTooltipText)||(c.todayTooltipText="Today");h(c.refreshTooltipText)||(c.refreshTooltipText="Refresh");h(c.searchTooltipText)||(c.searchTooltipText=
"Search");h(c.expandDayTooltipText)||(c.expandDayTooltipText="Expand Day");h(c.listAllEventsTooltipText)||(c.listAllEventsTooltipText="View All Events");h(c.listWeekEventsTooltipText)||(c.listWeekEventsTooltipText="View Current Week Events");h(c.dayHeaderNames)||(c.dayHeaderNames="Mon Tue Wed Thu Fri Sat Sun".split(" "));h(c.dayNames)||(c.dayNames="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "));h(c.fromText)||(c.fromText="From:");h(c.toText)||(c.toText="To:");h(c.isAllDayText)||
(c.isAllDayText="Is All-Day");h(c.titleText)||(c.titleText="Title:");h(c.descriptionText)||(c.descriptionText="Description:");h(c.locationText)||(c.locationText="Location:");h(c.addText)||(c.addText="Add");h(c.updateText)||(c.updateText="Update");h(c.cancelText)||(c.cancelText="Cancel");h(c.removeEventText)||(c.removeEventText="Remove");h(c.addEventTitle)||(c.addEventTitle="Add Event");h(c.editEventTitle)||(c.editEventTitle="Edit Event");h(c.monthNames)||(c.monthNames="January February March April May June July August September October November December".split(" "));
h(c.showDayNumberOrdinals)||(c.showDayNumberOrdinals=!0);h(c.dragAndDropForEventsEnabled)||(c.dragAndDropForEventsEnabled=!0);h(c.exportStartFilename)||(c.exportStartFilename="exported_events_");h(c.fromTimeErrorMessage)||(c.fromTimeErrorMessage="Please select a valid 'From' time.");h(c.toTimeErrorMessage)||(c.toTimeErrorMessage="Please select a valid 'To' time.");h(c.toSmallerThanFromErrorMessage)||(c.toSmallerThanFromErrorMessage="Please select a 'To' date that is larger than the 'From' date.");
h(c.titleErrorMessage)||(c.titleErrorMessage="Please enter a value in the 'Title' field (no empty space).");h(c.stText)||(c.stText="st");h(c.ndText)||(c.ndText="nd");h(c.rdText)||(c.rdText="rd");h(c.thText)||(c.thText="th");h(c.maximumEventsPerDayDisplay)||(c.maximumEventsPerDayDisplay=3);h(c.yesText)||(c.yesText="Yes");h(c.noText)||(c.noText="No");h(c.extraSelectableYearsAhead)||(c.extraSelectableYearsAhead=51);h(c.allDayText)||(c.allDayText="All-Day");h(c.allEventsText)||(c.allEventsText="All Events");
h(c.exportEventsEnabled)||(c.exportEventsEnabled=!0);h(c.manualEditingEnabled)||(c.manualEditingEnabled=!0);h(c.showTimesInMainCalendarEvents)||(c.showTimesInMainCalendarEvents=!1);h(c.startsOnText)||(c.startsOnText="Starts on the");h(c.andFinishesOnText)||(c.andFinishesOnText="and finishes on the");h(c.toTimeText)||(c.toTimeText="to");h(c.autoRefreshTimerDelay)||(c.autoRefreshTimerDelay=5E3);h(c.confirmEventRemoveTitle)||(c.confirmEventRemoveTitle="Confirm Event Removal");h(c.confirmEventRemoveMessage)||
(c.confirmEventRemoveMessage="Removing this event cannot be undone.  Do you want to continue?");h(c.okText)||(c.okText="OK");h(c.selectExportTypeTitle)||(c.selectExportTypeTitle="Select Export Type");h(c.fullScreenModeEnabled)||(c.fullScreenModeEnabled=!0);h(c.eventTooltipDelay)||(c.eventTooltipDelay=1E3);h(c.selectColorsText)||(c.selectColorsText="Select Colors");h(c.backgroundColorText)||(c.backgroundColorText="Background Color:");h(c.textColorText)||(c.textColorText="Text Color:");h(c.borderColorText)||
(c.borderColorText="Border Color:");h(c.searchEventsTitle)||(c.searchEventsTitle="Search Events");h(c.forText)||(c.forText="For:");h(c.previousText)||(c.previousText="Previous");h(c.nextText)||(c.nextText="Next");h(c.matchCaseText)||(c.matchCaseText="Match Case");h(c.minimumDayHeight)||(c.minimumDayHeight=0);h(c.repeatsText)||(c.repeatsText="Repeats:");h(c.repeatDaysToExcludeText)||(c.repeatDaysToExcludeText="Repeat Days To Exclude:");h(c.seriesIgnoreDatesText)||(c.seriesIgnoreDatesText="Series Ignore Dates:");
h(c.repeatsNever)||(c.repeatsNever="Never");h(c.repeatsEveryDayText)||(c.repeatsEveryDayText="Every Day");h(c.repeatsEveryWeekText)||(c.repeatsEveryWeekText="Every Week");h(c.repeatsEveryMonthText)||(c.repeatsEveryMonthText="Every Month");h(c.repeatsEveryYearText)||(c.repeatsEveryYearText="Every Year");h(c.selectDaysToExcludeTitle)||(c.selectDaysToExcludeTitle="Select Days To Exclude");h(c.moreText)||(c.moreText="More");h(c.includeText)||(c.includeText="Include:");h(c.holidays)||(c.holidays=[{day:24,
month:12,title:"Christmas Eve"},{day:25,month:12,title:"Christmas Day"},{day:26,month:12,title:"Boxing Day"},{day:31,month:12,title:"New Year's Eve"},{day:1,month:1,title:"New Year's Day"}]);h(c.minimizedTooltipText)||(c.minimizedTooltipText="Minimize");h(c.restoreTooltipText)||(c.restoreTooltipText="Restore");h(c.removeAllEventsInSeriesText)||(c.removeAllEventsInSeriesText="Remove All Events In Series");h(c.createdText)||(c.createdText="Created:");h(c.organizerName)||(c.organizerName="");h(c.organizerEmailAddress)||
(c.organizerEmailAddress="");h(c.organizerNameText)||(c.organizerNameText="Organizer:");h(c.organizerEmailAddressText)||(c.organizerEmailAddressText="Organizer Email:");h(c.enableFullScreenTooltipText)||(c.enableFullScreenTooltipText="Turn On Full-Screen Mode");h(c.disableFullScreenTooltipText)||(c.disableFullScreenTooltipText="Turn Off Full-Screen Mode");h(c.idText)||(c.idText="ID:");Eb&&(Eb=!1,P(u,!0))};(function(a,d){r=a;Ba=d;Pc=Ld;Ya.setOptions(Md);P(Nd,!0)})(document,window)};