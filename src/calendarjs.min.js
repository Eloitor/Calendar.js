function calendarJs(yd,zd,Ad){function Y(a,c){t=h(a)?a:new Date;c=h(c)?c:!1;var b=(new Date(t.getFullYear(),t.getMonth(),1)).getDay(),e=vb(t.getFullYear(),t.getMonth());0===b&&(b=7);ma();if(!wb){var f=Aa(Jc);f.className="calendar";f.innerHTML="";Bd(f);Cd(f);Dd(f);Ed(f);var k=g("div","row header-days"),l=d.dayHeaderNames.length;f.appendChild(k);for(var m=0;m<l;m++){var p=d.dayHeaderNames[m],n=g("div","cell");n.innerHTML=p;k.appendChild(n)}for(k=0;6>k;k++)for(l=g("div","row"),f.appendChild(l),m=0;7>
m;m++)p=7*k+(m+1),n=g("div","cell"),n.id="calendar-day-"+p,l.appendChild(n),0<d.minimumDayHeight&&(n.style.height=d.minimumDayHeight+"px");Fd(f);wb=!0}m=b;if(1<m)for(f=new Date(t),f.setMonth(f.getMonth()-1),k=vb(f.getFullYear(),f.getMonth()),l=1,m=k-m+1;m<k;m++)hc(m+1,l,f.getMonth(),f.getFullYear(),!0),l++;for(k=f=0;k<e;k++)f=b+k,hc(k+1,f,t.getMonth(),t.getFullYear(),!1);if(42>f){b=1;e=new Date(t);e.setMonth(e.getMonth()+1);for(f+=1;43>f;f++)hc(b,f,e.getMonth(),e.getFullYear(),!0),b++;b=vb(e.getFullYear(),
e.getMonth());b=Math.round(b/2);ic=new Date(e.getFullYear(),e.getMonth(),b)}else ic=null;Z();c&&(null===O&&(O=g("div","disabled-background")),null!==na&&z(q.body,na),na=g("div","calendar-dialog event-editor"),q.body.appendChild(na),b=g("div","view"),na.appendChild(b),aa=g("div","disabled-area"),b.appendChild(aa),xb=g("div","title-bar"),b.appendChild(xb),e=g("div","contents"),b.appendChild(e),b=g("p"),b.innerText=d.titleText,e.appendChild(b),b=g("div","input-title-container"),e.appendChild(b),oa=g("input",
null,"text"),b.appendChild(oa),f=g("input","select-colors","button"),f.value="...",f.onclick=Gd,b.appendChild(f),b=g("p"),b.innerText=d.fromText.replace(":","")+"/"+d.toText,e.appendChild(b),b=g("div","split"),e.appendChild(b),H=g("input"),H.onchange=yb,b.appendChild(H),pa(H,"date"),P=g("input"),b.appendChild(P),pa(P,"time"),b=g("div","split"),e.appendChild(b),C=g("input"),C.onchange=yb,b.appendChild(C),pa(C,"date"),Q=g("input"),b.appendChild(Q),pa(Q,"time"),Sa=D(e,d.isAllDayText,yb)[0],b=g("p"),
b.innerText=d.repeatsText,e.appendChild(b),b=g("div","radioButtonsContainer"),e.appendChild(b),qa=V(b,d.repeatsNever,"RepeatType",Ba),zb=V(b,d.repeatsEveryDayText,"RepeatType",Ba),Ab=V(b,d.repeatsEveryWeekText,"RepeatType",Ba),Bb=V(b,d.repeatsEveryMonthText,"RepeatType",Ba),Cb=V(b,d.repeatsEveryYearText,"RepeatType",Ba),Ca=g("input","days-to-exclude","button"),Ca.value="...",Ca.onclick=Hd,b.appendChild(Ca),b=g("p"),b.innerText=d.locationText,e.appendChild(b),Ta=g("input",null,"text"),e.appendChild(Ta),
b=g("p"),b.innerText=d.descriptionText,e.appendChild(b),Ua=g("textarea","custom-scroll-bars"),e.appendChild(Ua),Va=g("p","error"),e.appendChild(Va),b=g("div","split"),e.appendChild(b),Da=g("input","ok","button"),Da.value=d.addText,Da.onclick=Id,b.appendChild(Da),f=g("input","cancel","button"),f.value=d.cancelText,f.onclick=jc,b.appendChild(f),Ea=g("input","remove","button"),Ea.value=d.removeEventText,Ea.onclick=Jd,e.appendChild(Ea),null!==ba&&z(q.body,ba),ba=g("div","calendar-dialog event-editor-colors"),
q.body.appendChild(ba),e=g("div","title-bar"),e.innerHTML=d.selectColorsText,ba.appendChild(e),e=g("div","contents"),ba.appendChild(e),b=g("p"),b.innerText=d.backgroundColorText,e.appendChild(b),Fa=g("input"),e.appendChild(Fa),pa(Fa,"color"),b=g("p"),b.innerText=d.textColorText,e.appendChild(b),Ga=g("input"),e.appendChild(Ga),pa(Ga,"color"),b=g("p"),b.innerText=d.borderColorText,e.appendChild(b),Ha=g("input"),e.appendChild(Ha),pa(Ha,"color"),b=g("div","split"),e.appendChild(b),e=g("input","ok","button"),
e.value=d.okText,e.onclick=Kd,b.appendChild(e),e=g("input","cancel","button"),e.value=d.cancelText,e.onclick=Kc,b.appendChild(e),null!==ca&&z(q.body,ca),ca=g("div","calendar-dialog event-editor-exclude-days"),q.body.appendChild(ca),e=g("div","title-bar"),e.innerHTML=d.selectDaysToExcludeTitle,ca.appendChild(e),b=g("div","contents"),ca.appendChild(b),Db=D(b,d.dayNames[0])[0],Eb=D(b,d.dayNames[1])[0],Fb=D(b,d.dayNames[2])[0],Gb=D(b,d.dayNames[3])[0],Hb=D(b,d.dayNames[4])[0],Ib=D(b,d.dayNames[5])[0],
Jb=D(b,d.dayNames[6])[0],e=g("div","split"),b.appendChild(e),b=g("input","ok","button"),b.value=d.okText,b.onclick=Ld,e.appendChild(b),b=g("input","cancel","button"),b.value=d.cancelText,b.onclick=Lc,e.appendChild(b),null!==da&&z(q.body,da),da=g("div","calendar-dialog confirmation"),q.body.appendChild(da),kc=g("div","title-bar"),da.appendChild(kc),e=g("div","contents"),da.appendChild(e),lc=g("div","message"),e.appendChild(lc),b=D(e,d.removeAllEventsInSeriesText),mc=b[0],Mc=b[1],b=g("div","split"),
e.appendChild(b),Wa=g("input","yes","button"),Wa.value=d.yesText,b.appendChild(Wa),Xa=g("input","no","button"),Xa.value=d.noText,b.appendChild(Xa),null!==ea&&z(q.body,ea),ea=g("div","calendar-dialog select-export-type"),q.body.appendChild(ea),e=g("div","title-bar"),e.innerHTML=d.selectExportTypeTitle,ea.appendChild(e),b=g("div","contents"),ea.appendChild(b),e=g("div","radioButtonsContainer"),b.appendChild(e),nc=V(e,"CSV","ExportType"),Nc=V(e,"XML","ExportType"),Oc=V(e,"JSON","ExportType"),Pc=V(e,
"TEXT","ExportType"),e=g("div","split"),b.appendChild(e),b=g("input","ok","button"),b.value=d.okText,b.onclick=Md,e.appendChild(b),b=g("input","cancel","button"),b.value=d.cancelText,b.onclick=Qc,e.appendChild(b),null!==x&&z(q.body,x),x=g("div","calendar-dialog search"),q.body.appendChild(x),e=g("div","title-bar"),e.innerHTML=d.searchEventsTitle,e.onmousedown=Nd,e.onmouseup=Od,x.appendChild(e),b=g("div","ib-close"),b.onclick=Pd,e.appendChild(b),u(b,d.closeTooltipText),fa=g("div","ib-minus"),fa.onclick=
Qd,e.appendChild(fa),u(fa,d.minimizedTooltipText),I=g("div","contents"),x.appendChild(I),e=g("p"),e.innerText=d.forText,I.appendChild(e),R=g("input",null,"text"),R.oninput=ra,R.onpropertychange=ra,R.onkeypress=Rd,I.appendChild(R),Rc=D(I,d.matchCaseText,ra)[0],e=g("p"),e.innerText=d.includeText,I.appendChild(e),e=g("div","checkboxContainer"),I.appendChild(e),Sc=D(e,d.titleText.replace(":",""),ra)[0],Tc=D(e,d.locationText.replace(":",""),ra)[0],Uc=D(e,d.descriptionText.replace(":",""),ra)[0],e=g("div",
"split"),I.appendChild(e),Ia=g("input","previous","button"),Ia.value=d.previousText,Ia.onclick=Sd,e.appendChild(Ia),sa=g("input","next","button"),sa.value=d.nextText,sa.onclick=Vc,e.appendChild(sa),q.body.addEventListener("mousemove",Td),null===v&&(v=g("div"),q.body.appendChild(v),oc=g("div","title"),Kb=g("div","date"),Ya=g("div","repeats"),Za=g("div","description"),$a=g("div","location"),document.body.addEventListener("mousemove",pc)),Ud(),Vd());ab.innerHTML=d.monthNames[t.getMonth()]+", "+t.getFullYear()+
" \u25be"}function Lb(){var a=[];Mb(function(c){a.push(c)});return a}function Mb(a){for(var c in J)if(J.hasOwnProperty(c))for(var b in J[c])if(J[c].hasOwnProperty(b)){var e=Wc(J[c][b]);if(a(e,c,b))return}}function bb(a){a=a.sort(function(c,b){return c.from-b.from});return a=a.sort(function(c,b){return Xc(b.isAllDay)-Xc(c.isAllDay)})}function Ed(a){E=g("div","header-date");a.appendChild(E);d.fullScreenModeEnabled&&(E.ondblclick=function(){cb(a)});var c=g("div","ib-arrow-left-full");c.onclick=qc;c.ondblclick=
r;E.appendChild(c);u(c,d.previousMonthTooltipText);c=g("div","ib-pin");c.onclick=rc;c.ondblclick=r;E.appendChild(c);u(c,d.todayTooltipText);c=g("div","ib-refresh");c.onclick=Nb;c.ondblclick=r;E.appendChild(c);u(c,d.refreshTooltipText);c=g("div","ib-search");c.onclick=Yc;c.ondblclick=r;E.appendChild(c);u(c,d.searchTooltipText);c=g("div","ib-arrow-right-full");c.onclick=sc;c.ondblclick=r;E.appendChild(c);u(c,d.nextMonthTooltipText);d.manualEditingEnabled&&(c=g("div","ib-plus"),c.onclick=Ob,c.ondblclick=
r,E.appendChild(c),u(c,d.addEventTooltipText));d.exportEventsEnabled&&(Ja=g("div","ib-arrow-down-full-line"),Ja.ondblclick=r,E.appendChild(Ja),u(Ja,d.exportEventsTooltipText),Ja.onclick=function(){Pb()});c=g("div","ib-eye");c.ondblclick=r;E.appendChild(c);c.onclick=function(){Zc(!0)};u(c,d.listAllEventsTooltipText);c=g("div","ib-hamburger");c.ondblclick=r;E.appendChild(c);c.onclick=function(){db(null,!0)};u(c,d.listWeekEventsTooltipText);c=g("div","title-container");E.appendChild(c);ab=g("span");
ab.ondblclick=r;c.appendChild(ab);Wd(c)}function Wd(a){var c=new Date(1900,1,1),b=(new Date).getFullYear()-c.getFullYear()+d.extraSelectableYearsAhead;K=g("div","years-drop-down");a.appendChild(K);Qb=g("div","contents custom-scroll-bars");K.appendChild(Qb);for(a=0;a<b;a++)Xd(c.getFullYear()),c.setFullYear(c.getFullYear()+1);ab.onclick=Yd}function Xd(a){var c=g("div");c.innerText=a.toString();c.id="year-selected-"+a.toString();Qb.appendChild(c);c.onclick=function(){t.setFullYear(a);Y(t);Rb()&&(K.style.display=
"none")}}function Wc(a){a.isAllDay&&(a.from=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),0,0),a.to=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),23,59));return a}function eb(a,c){var b=new Date(a.getFullYear(),a.getMonth(),a.getDate()),e=new Date(c.getFullYear(),c.getMonth(),c.getDate());return Math.ceil(Math.abs(e-b)/864E5)}function Yd(a){if("block"!==K.style.display){ma();r(a);a=K.getElementsByClassName("current-year-selected");if(1<=a.length)for(var c=a.length,
b=0;b<c;b++)a[b].removeAttribute("class");a=Aa("year-selected-"+t.getFullYear());null!==a&&(a.className="current-year-selected");K.style.display="block";Qb.scrollTop=a.offsetTop-K.offsetHeight/2}}function Rb(){return null!==K&&"block"===K.style.display}function fb(a){if(null!==d&&tc(d[a]))d[a]()}function Sb(a,c){if(null!==d&&tc(d[a]))d[a](c)}function $c(){for(var a=[],c=0;32>c;c++){8!==c&&12!==c&&16!==c&&20!==c||a.push("-");var b=Math.floor(16*Math.random()).toString(16);a.push(b)}return a.join("")}
function cb(a){0>=a.className.indexOf(" full-screen-view")?(ad=a.style.cssText,uc=!0,a.className+=" full-screen-view",a.removeAttribute("style")):(a.className=a.className.replace(" full-screen-view",""),a.style.cssText=ad,uc=!1)}function Fd(a){bd||(q.body.addEventListener("click",ma),q.body.addEventListener("contextmenu",ma),ta.addEventListener("resize",ma),ta.addEventListener("resize",cd),q.addEventListener("keydown",function(c){uc&&dd()&&(27===c.keyCode?cb(a):37===c.keyCode?qc():39===c.keyCode?
sc():40===c.keyCode?rc():70===c.keyCode&&(c.ctrlKey||c.metaKey)?(c.preventDefault(),Yc()):116===c.keyCode&&Nb())}),bd=!0)}function ma(){vc()&&(F.style.display="none");wc()&&(L.style.display="none");Rb()&&(K.style.display="none");pc()}function Z(){Zd();null!==gb&&0<d.autoRefreshTimerDelay&&(clearTimeout(gb),gb=null);for(var a=bb(Lb()),c=a.length,b=0;b<c;b++){var e=a[b];null!==Tb(e.from)&&$d(e);var f=W(e.repeatEvery);0<f&&(1===f?Ub(e,function(k){k.setDate(k.getDate()+1)}):2===f?Ub(e,function(k){k.setDate(k.getDate()+
7)}):3===f?Ub(e,function(k){k.setMonth(k.getMonth()+1)}):4===f&&Ub(e,function(k){k.setFullYear(k.getFullYear()+1)}))}d.exportEventsEnabled&&(Ja.style.display=0===c?"none":"inline-block");ae()}function Ub(a,c){for(var b=new Date(a.from),e=S(a.repeatEveryExcludeDays),f=S(a.seriesIgnoreDates);b<ic;){c(b);var k=ua(b);-1===e.indexOf(b.getDay())&&-1===f.indexOf(k)&&null!==Tb(b)&&xc(b,a)}}function $d(a){xc(a.from,a);if(a.from.getDate()!==a.to.getDate()){var c=eb(a.from,a.to);if(0<c)for(var b=new Date(a.from),
e=0;e<c;e++)b.setDate(b.getDate()+1),null!==Tb(b)&&xc(b,a)}}function xc(a,c){var b=Tb(a);if(null!==b){var e=d.manualEditingEnabled?"event":"event-no-hover";if(b.getElementsByClassName(e).length<d.maximumEventsPerDayDisplay){e=g("div",e);var f=c.title;d.showTimesInMainCalendarEvents&&!c.isAllDay&&c.from.getDate()===c.to.getDate()&&(f=hb(c.from,c.to)+": "+f);e.innerHTML=f;b.appendChild(e);Vb(c,e,yc(c,a));e.onmousemove=function(l){ed(l,c)};if(d.manualEditingEnabled){var k=ua(a);e.oncontextmenu=function(l){Wb(l,
c,k)}}d.manualEditingEnabled&&(e.onclick=function(){ha(c)});d.dragAndDropForEventsEnabled&&d.manualEditingEnabled&&(e.setAttribute("draggable",!0),e.ondragstart=function(){w=c})}else e=b.getElementsByClassName("plus-x-events"),e=0<e.length?e[0]:null,null===e?(e=g("div","plus-x-events"),e.setAttribute("events","1"),e.innerHTML="+1 "+d.moreText,b.appendChild(e)):(b=parseInt(e.getAttribute("events"))+1,e.setAttribute("events",b.toString()),e.innerHTML="+"+b+" "+d.moreText)}}function Tb(a){var c=new Date(t.getFullYear(),
t.getMonth(),1);var b=new Date(t);var e=new Date(t),f=null,k=0;c=zc(c);b.setMonth(b.getMonth()+1);e.setMonth(e.getMonth()-1);a.getMonth()===b.getMonth()&&a.getFullYear()===b.getFullYear()?(b=c+vb(t.getFullYear(),t.getMonth()),k=a.getDate()+b):a.getMonth()===e.getMonth()&&a.getFullYear()===e.getFullYear()?k=c-eb(a,t)+1:a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear()&&(b=c,k=a.getDate()+b);0<k&&(f=Aa("calendar-day-"+k));return f}function Zd(){for(var a=0;6>a;a++)for(var c=0;7>c;c++){var b=
Aa("calendar-day-"+(7*a+(c+1)));fd(b,d.manualEditingEnabled?"event":"event-no-hover");fd(b,"plus-x-events")}}function fd(a,c){for(var b=a.getElementsByClassName(c);b[0];)b[0].parentNode.removeChild(b[0])}function Vb(a,c,b){h(b)&&b<new Date&&(c.className+=" expired");M(a.color)?(c.style.backgroundColor=a.color,M(a.colorText)&&(c.style.color=a.colorText),M(a.colorBorder)&&(c.style.borderLeftColor=a.colorBorder)):a.isAllDay&&(c.className+=" all-day")}function yc(a,c){var b=W(a.repeatEvery),e=new Date(a.to);
0<b&&(b=new Date(c),b.setHours(e.getHours(),e.getMinutes()),e=b);return e}function Dd(a){va=g("div","full-day-view");a.appendChild(va);var c=g("div","title-bar");va.appendChild(c);d.fullScreenModeEnabled&&(c.ondblclick=function(){cb(a)});ib=g("div","title");c.appendChild(ib);var b=g("div","ib-close");b.ondblclick=r;c.appendChild(b);u(b,d.closeTooltipText);b.onclick=function(){Ac(va);T=null};d.manualEditingEnabled&&(b=g("div","ib-plus"),b.onclick=Ob,b.ondblclick=r,c.appendChild(b),u(b,d.addEventTooltipText));
b=g("div","ib-arrow-right-full");b.onclick=be;b.ondblclick=r;c.appendChild(b);u(b,d.nextDayTooltipText);b=g("div","ib-arrow-left-full");b.onclick=ce;b.ondblclick=r;c.appendChild(b);u(b,d.previousDayTooltipText);d.exportEventsEnabled&&(Ka=g("div","ib-arrow-down-full-line"),Ka.ondblclick=r,c.appendChild(Ka),u(Ka,d.exportEventsTooltipText),Ka.onclick=function(){Pb(Bc)});jb=g("div","contents custom-scroll-bars");va.appendChild(jb)}function kb(a,c){c=h(c)?c:!1;ib.innerText="";jb.innerHTML="";T=a;Bc=[];
c&&(jb.scrollTop=0);Cc(va);wa(ib,a,!1,!0,!0);var b=gd(a),e=[];if(null!==b){var f=g("span","holiday");f.innerText=" ("+b+")";ib.appendChild(f)}Mb(function(k){for(var l=eb(k.from,k.to)+1,m=new Date(k.from),p=0;p<l;p++){if(m.getFullYear()===a.getFullYear()&&m.getMonth()===a.getMonth()&&m.getDate()===a.getDate()){e.push(k);break}m.setDate(m.getDate()+1)}l=W(k.repeatEvery);0<l&&(1===l?Xb(k,e,a,function(n){n.setDate(n.getDate()+1)}):2===l?Xb(k,e,a,function(n){n.setDate(n.getDate()+7)}):3===l?Xb(k,e,a,function(n){n.setMonth(n.getMonth()+
1)}):4===l&&Xb(k,e,a,function(n){n.setFullYear(n.getFullYear()+1)}))});e=bb(e);b=e.length;for(f=0;f<b;f++)de(e[f],a);d.exportEventsEnabled&&(Ka.style.display=0===e.length?"none":"inline-block")}function Xb(a,c,b,e){for(var f=new Date(a.from),k=S(a.repeatEveryExcludeDays),l=S(a.seriesIgnoreDates);f<b;){e(f);var m=ua(f);if(-1===k.indexOf(f.getDay())&&-1===l.indexOf(m)&&f.getFullYear()===b.getFullYear()&&f.getMonth()===b.getMonth()&&f.getDate()===b.getDate()){c.push(a);break}}}function de(a,c){var b=
g("div",d.manualEditingEnabled?"event":"event-no-hover");jb.appendChild(b);if(d.manualEditingEnabled){var e=ua(c);b.oncontextmenu=function(k){Wb(k,a,ua(e))}}Vb(a,b,yc(a,c));var f=g("div","title");f.innerHTML=a.title;b.appendChild(f);f=g("div","date");b.appendChild(f);a.from.getDate()===a.to.getDate()?f.innerHTML=a.isAllDay?d.allDayText:hb(a.from,a.to):Yb(f,a.from,a.to);lb(a.repeatEvery)&&0<a.repeatEvery&&(f=g("div","repeats"),f.innerHTML=d.repeatsText.replace(":","")+" "+La(a.repeatEvery),b.appendChild(f));
M(a.location)&&(f=g("div","location"),f.innerHTML=a.location,b.appendChild(f));M(a.description)&&(f=g("div","description"),f.innerHTML=a.description,b.appendChild(f));d.manualEditingEnabled&&(b.onclick=function(){ha(a)});Bc.push(a)}function ce(){T.setDate(T.getDate()-1);kb(T,!0)}function be(){T.setDate(T.getDate()+1);kb(T,!0)}function Bd(a){xa=g("div","list-all-events-view");a.appendChild(xa);var c=g("div","title-bar");xa.appendChild(c);d.fullScreenModeEnabled&&(c.ondblclick=function(){cb(a)});var b=
g("div","title");b.innerHTML=d.allEventsText;c.appendChild(b);b=g("div","ib-close");b.ondblclick=r;c.appendChild(b);u(b,d.closeTooltipText);b.onclick=function(){Ac(xa)};d.manualEditingEnabled&&(b=g("div","ib-plus"),b.onclick=Ob,b.ondblclick=r,c.appendChild(b),u(b,d.addEventTooltipText));d.exportEventsEnabled&&(mb=g("div","ib-arrow-down-full-line"),mb.ondblclick=r,c.appendChild(mb),u(mb,d.exportEventsTooltipText),mb.onclick=function(){Pb()});nb=g("div","contents custom-scroll-bars");xa.appendChild(nb)}
function Zc(a){a=h(a)?a:!1;Cc(xa);nb.innerHTML="";a&&(nb.scrollTop=0);a=bb(Lb());for(var c=a.length,b=0;b<c;b++){var e=a[b],f=e.from,k="month-"+f.getMonth()+"-"+f.getFullYear(),l=Aa(k);if(null===l){var m=g("div","month");nb.appendChild(m);l=g("div","header");l.innerHTML=d.monthNames[f.getMonth()]+" "+f.getFullYear();m.appendChild(l);l=g("div","events");l.id=k;m.appendChild(l)}ee(e,l)}}function ee(a,c){var b=g("div",d.manualEditingEnabled?"event":"event-no-hover");c.appendChild(b);d.manualEditingEnabled&&
(b.oncontextmenu=function(f){Wb(f,a)});Vb(a,b);var e=g("div","title");e.innerHTML=a.title;b.appendChild(e);e=g("div","date");b.appendChild(e);a.from.getDate()===a.to.getDate()?a.isAllDay?Zb(e,a.from,null," - "+d.allDayText):Zb(e,a.from,null," - "+hb(a.from,a.to)):Yb(e,a.from,a.to);lb(a.repeatEvery)&&0<a.repeatEvery&&(e=g("div","repeats"),e.innerHTML=d.repeatsText.replace(":","")+" "+La(a.repeatEvery),b.appendChild(e));M(a.location)&&(e=g("div","location"),e.innerHTML=a.location,b.appendChild(e));
M(a.description)&&(e=g("div","description"),e.innerHTML=a.description,b.appendChild(e));d.manualEditingEnabled&&(b.onclick=function(){ha(a)})}function Cd(a){ya=g("div","list-all-week-events-view");a.appendChild(ya);var c=g("div","title-bar");ya.appendChild(c);d.fullScreenModeEnabled&&(c.ondblclick=function(){cb(a)});U=g("div","title");c.appendChild(U);var b=g("div","ib-close");b.ondblclick=r;c.appendChild(b);u(b,d.closeTooltipText);b.onclick=function(){Ac(ya)};d.manualEditingEnabled&&(b=g("div","ib-plus"),
b.onclick=Ob,b.ondblclick=r,c.appendChild(b),u(b,d.addEventTooltipText));b=g("div","ib-arrow-right-full");b.onclick=fe;b.ondblclick=r;c.appendChild(b);u(b,d.nextWeekTooltipText);b=g("div","ib-arrow-left-full");b.onclick=ge;b.ondblclick=r;c.appendChild(b);u(b,d.previousWeekTooltipText);d.exportEventsEnabled&&(Ma=g("div","ib-arrow-down-full-line"),Ma.ondblclick=r,c.appendChild(Ma),u(Ma,d.exportEventsTooltipText),Ma.onclick=function(){Pb(ob)});pb=g("div","contents custom-scroll-bars");ya.appendChild(pb)}
function db(a,c){c=h(c)?c:!1;Cc(ya);pb.innerHTML="";Na={};Dc={};ob=[];ia=null===a?new Date:a;c&&(pb.scrollTop=0);var b=he(a),e=b[0];b=b[1];ie(e,b);for(var f=bb(Lb()),k=f.length,l=0;l<k;l++){for(var m=f[l],p=eb(m.from,m.to)+1,n=new Date(m.from),za=!1,Oa=0;Oa<p;Oa++)n>=e&&n<=b&&(za=hd(n),id(m,za,n),za=!0),n.setDate(n.getDate()+1);za&&ob.push(m);p=W(m.repeatEvery);n=!1;0<p&&(1===p?n=$b(m,e,b,function(N){N.setDate(N.getDate()+1)}):2===p?n=$b(m,e,b,function(N){N.setDate(N.getDate()+7)}):3===p?n=$b(m,e,
b,function(N){N.setMonth(N.getMonth()+1)}):4===p&&(n=$b(m,e,b,function(N){N.setFullYear(N.getFullYear()+1)})));n&&!za&&ob.push(m)}for(var jd in Na)Na.hasOwnProperty(jd)&&pb.appendChild(Na[jd]);d.exportEventsEnabled&&(Ma.style.display=0===ob.length?"none":"inline-block")}function $b(a,c,b,e){for(var f=new Date(a.from),k=S(a.repeatEveryExcludeDays),l=S(a.seriesIgnoreDates),m=!1;f<b;){e(f);var p=ua(f);-1===k.indexOf(f.getDay())&&-1===l.indexOf(p)&&f>=c&&f<=b&&(m=hd(f),id(a,m,f),m=!0)}return m}function ie(a,
c){U.innerHTML="";if(a.getFullYear()===c.getFullYear()){wa(U,a,!1,!1);var b=g("span");b.innerHTML=" - ";U.appendChild(b);wa(U,c,!1,!1);b=g("span");b.innerHTML=", "+a.getFullYear();U.appendChild(b)}else wa(U,a,!1,!0),b=g("span"),b.innerHTML=" - ",U.appendChild(b),wa(U,c,!1,!0)}function id(a,c,b){var e=g("div",d.manualEditingEnabled?"event":"event-no-hover");c.appendChild(e);if(d.manualEditingEnabled){var f=ua(b);e.oncontextmenu=function(k){Wb(k,a,f)}}Vb(a,e,yc(a,b));c=g("div","title");c.innerHTML=
a.title;e.appendChild(c);c=g("div","date");e.appendChild(c);a.from.getDate()===a.to.getDate()?c.innerHTML=a.isAllDay?d.allDayText:hb(a.from,a.to):Yb(c,a.from,a.to);lb(a.repeatEvery)&&0<a.repeatEvery&&(c=g("div","repeats"),c.innerHTML=d.repeatsText.replace(":","")+" "+La(a.repeatEvery),e.appendChild(c));M(a.location)&&(c=g("div","location"),c.innerHTML=a.location,e.appendChild(c));M(a.description)&&(c=g("div","description"),c.innerHTML=a.description,e.appendChild(c));d.manualEditingEnabled&&(e.onclick=
function(){ha(a)})}function hd(a){var c=zc(a),b=a.getFullYear()+a.getMonth()+c;if(Na.hasOwnProperty(b))a=Dc[b];else{var e=g("div","day");Na[b]=e;var f=g("div","header");e.appendChild(f);Zb(f,a,d.dayNames[c]+", ");a=g("div","events");e.appendChild(a);Dc[b]=a}return a}function zc(a){return 0>a.getDay()-1?6:a.getDay()-1}function he(a){a=h(a)?a:new Date;var c=0===a.getDay()?7:a.getDay();c=a.getDate()-c+1;var b=c+6,e=new Date(a);a=new Date(a);e.setDate(c);e.setHours(0,0,0,0);a.setDate(b);a.setHours(23,
59,59,99);return[e,a]}function ge(){ia.setDate(ia.getDate()-7);db(ia,!0)}function fe(){ia.setDate(ia.getDate()+7);db(ia,!0)}function hb(a,c){return Ec(a)+" "+d.toTimeText+" "+Ec(c)}function Ec(a){return G(a.getHours())+":"+G(a.getMinutes())}function Yb(a,c,b){a.innerHTML="";var e=g("span");e.innerText=d.startsOnText+" ";a.appendChild(e);wa(a,c);c=g("span");c.innerText=" "+d.andFinishesOnText+" ";a.appendChild(c);wa(a,b)}function wa(a,c,b,e,f){b=h(b)?b:!0;e=h(e)?e:!0;if(f=h(f)?f:!1){f=zc(c);var k=
g("span");k.innerText=d.dayNames[f]+", ";a.appendChild(k)}Zb(a,c);f=g("span");f.innerText=" "+d.monthNames[c.getMonth()];a.appendChild(f);e&&(e=g("span"),e.innerText=" "+c.getFullYear(),a.appendChild(e));b&&(b=g("span"),b.innerText=" "+Ec(c),a.appendChild(b))}function Zb(a,c,b,e){if(h(b)){var f=g("span");f.innerText=b;a.appendChild(f)}b=g("span");b.innerText=c.getDate();a.appendChild(b);d.showDayNumberOrdinals&&(b=g("sup"),b.innerText=kd(c.getDate()),a.appendChild(b));h(e)&&(c=g("span"),c.innerText=
e,a.appendChild(c))}function hc(a,c,b,e,f){var k=new Date;k=a===k.getDate()&&e===k.getFullYear()&&b===k.getMonth();var l=Aa("calendar-day-"+c);c=g("span");var m=new Date(e,b,a);l.innerHTML="";c.className=f?"day-muted":"";c.className+=k?" today":"";c.innerText=a;if(6===m.getDay()||0===m.getDay()&&"cell"===l.className)l.className="cell weekend-day";l.oncontextmenu=function(n){ac=m;ma();r(n);Fc(n,F)};d.showDayNumberOrdinals&&(f=g("sup"),f.innerText=kd(a),c.appendChild(f));l.appendChild(c);f=g("div",
"expand-day");l.appendChild(f);u(f,d.expandDayTooltipText);k=gd(m);if(null!==k){var p=g("span","holiday");p.innerText=k;c.appendChild(p)}f.onclick=function(){kb(m,!0)};d.manualEditingEnabled&&(l.ondblclick=function(){ha(null,m)},d.manualEditingEnabled&&(l.ondragover=function(n){r(n);ld(l)},l.ondragenter=function(n){r(n);ld(l)},l.ondragleave=function(n){r(n);md(l)},l.ondrop=function(n){r(n);if(null!==w){n=eb(w.from,w.to);var za=new Date(e,b,a,w.from.getHours(),w.from.getMinutes()),Oa=new Date(e,b,
a,w.to.getHours(),w.to.getMinutes());0<n&&Oa.setDate(Oa.getDate()+n);Pa.updateEvent(w.id,{from:za,to:Oa,title:w.title,description:w.description,location:w.location,isAllDay:w.isAllDay,color:w.color,colorText:w.colorText,colorBorder:w.colorBorder,repeatEvery:w.repeatEvery,repeatEveryExcludeDays:w.repeatEveryExcludeDays})}md(l)}))}function ld(a){-1===a.className.indexOf(" drag-over")&&(a.className+=" drag-over")}function md(a){-1<a.className.indexOf(" drag-over")&&(a.className=a.className.replace(" drag-over",
""))}function vb(a,c){return(new Date(a,c+1,0)).getDate()}function kd(a){var c=d.thText;if(31===a||21===a||1===a)c=d.stText;else if(22===a||2===a)c=d.ndText;else if(23===a||3===a)c=d.rdText;return c}function gd(a){for(var c=null,b=[],e=d.holidays.length,f=0;f<e;f++){var k=d.holidays[f];W(k.day)===a.getDate()&&W(k.month)===a.getMonth()+1&&(k=y(k.title,null),null!==k&&b.push(k))}0<b.length&&(c=b.join(", "));return c}function Ud(){null!==F&&z(q.body,F);F=g("div","calendar-drop-down-menu");q.body.appendChild(F);
if(d.manualEditingEnabled){var a=g("div","item");a.innerHTML=d.addEventTitle;F.appendChild(a);a.onclick=function(){ha(null,ac)};a=g("div","separator");F.appendChild(a)}a=g("div","item");a.innerHTML=d.expandDayTooltipText;F.appendChild(a);a.onclick=function(){kb(ac,!0)};a=g("div","separator");F.appendChild(a);a=g("div","item");a.innerHTML=d.listWeekEventsTooltipText;F.appendChild(a);a.onclick=function(){db(ac,!0)}}function Vd(){null!==L&&z(q.body,L);if(d.manualEditingEnabled){L=g("div","calendar-drop-down-menu");
q.body.appendChild(L);var a=g("div","item");a.innerHTML=d.removeEventText;L.appendChild(a);a.onclick=function(){Qa(q.body,O);var c=function(){z(q.body,O)},b=0<W(ja.repeatEvery)&&null!==qb;nd(d.confirmEventRemoveTitle,d.confirmEventRemoveMessage,function(){c();h(ja.id)&&(mc.checked||null===qb?Pa.removeEvent(ja.id,!0):(od(ja.seriesIgnoreDates)?ja.seriesIgnoreDates.push(qb):ja.seriesIgnoreDates=[qb],Z()),bc())},c,b)};a=g("div","separator");L.appendChild(a);a=g("div","item");a.innerHTML=d.editEventTitle;
L.appendChild(a);a.onclick=function(){ha(ja)}}}function Wb(a,c,b){ja=c;qb=h(b)?b:null;ma();r(a);Fc(a,L)}function vc(){return null!==F&&"block"===F.style.display}function wc(){return null!==L&&"block"===L.style.display}function pa(a,c){try{a.type=c}catch(b){a.type="text"}}function Ob(){ha(null,T)}function Ba(){Ca.disabled=qa.checked}function yb(){var a=!1;Sa.checked&&(C.value=H.value,P.value="00:00",Q.value="23:59",a=!0);C.disabled=a;P.disabled=a;Q.disabled=a;a=cc(H);var c=cc(C);c>a||c<a?(a=!0,qa.checked=
!0):a=!1;qa.disabled=a;zb.disabled=a;Ab.disabled=a;Bb.disabled=a;Cb.disabled=a;Ca.disabled=a;Ba()}function ha(a,c){Qa(q.body,O);if(h(a)){Da.value=d.updateText;Ea.style.display="block";xb.innerHTML=d.editEventTitle;A=a;H.value=dc(a.from,H.type);P.value=ec(a.from);C.value=dc(a.to,C.type);Q.value=ec(a.to);Sa.checked=a.isAllDay;oa.value=y(a.title);Ua.value=y(a.description);Ta.value=y(a.location);Fa.value=y(a.color,"#484848");Ga.value=y(a.colorText,"#F5F5F5");Ha.value=y(a.colorBorder,"#282828");var b=
W(a.repeatEvery);0===b?qa.checked=!0:1===b?zb.checked=!0:2===b?Ab.checked=!0:3===b?Bb.checked=!0:4===b&&(Cb.checked=!0);b=S(a.repeatEveryExcludeDays);Db.checked=-1<b.indexOf(1);Eb.checked=-1<b.indexOf(2);Fb.checked=-1<b.indexOf(3);Gb.checked=-1<b.indexOf(4);Hb.checked=-1<b.indexOf(5);Ib.checked=-1<b.indexOf(6);Jb.checked=-1<b.indexOf(0)}else{b=new Date;var e=h(c)?c:b,f=new Date;e.getDate()===f.getDate()&&e.getFullYear()===f.getFullYear()&&e.getMonth()===f.getMonth()&&(e.setHours(b.getHours()),e.setMinutes(b.getMinutes()));
Da.value=d.addText;Ea.style.display="none";xb.innerHTML=d.addEventTitle;A={};H.value=dc(e,H.type);P.value=ec(e);C.value=dc(e,C.type);Q.value=ec(e);Sa.checked=!1;oa.value="";Ua.value="";Ta.value="";Fa.value="#484848";Ga.value="#F5F5F5";Ha.value="#282828";qa.checked=!0;Db.checked=!1;Eb.checked=!1;Fb.checked=!1;Gb.checked=!1;Hb.checked=!1;Ib.checked=!1;Jb.checked=!1}yb();na.style.display="block";Va.style.display="none";oa.focus()}function Id(){var a=cc(H),c=cc(C),b=P.value.split(":"),e=Q.value.split(":"),
f=Gc(oa.value),k=Gc(Ua.value),l=Gc(Ta.value);2>b.length?fc(d.fromTimeErrorMessage,P):2>e.length?fc(d.toTimeErrorMessage,Q):""===f?fc(d.titleErrorMessage,oa):(pd(a,P.value),pd(c,Q.value),c<a?fc(d.toSmallerThanFromErrorMessage,C):(jc(),a={from:a,to:c,title:f,description:k,location:l,isAllDay:Sa.checked,color:A.color,colorText:A.colorText,colorBorder:A.colorBorder,repeatEveryExcludeDays:A.repeatEveryExcludeDays},qa.checked?a.repeatEvery=0:zb.checked?a.repeatEvery=1:Ab.checked?a.repeatEvery=2:Bb.checked?
a.repeatEvery=3:Cb.checked&&(a.repeatEvery=4),h(A.id)?Pa.updateEvent(A.id,a,!1):Pa.addEvent(a,!1),Z(),bc()))}function pd(a,c){var b=0,e=0,f=c.split(":");if(2===f.length){var k=parseInt(f[0]);f=parseInt(f[1]);!isNaN(k)&&2>=k.toString().length&&(b=k);!isNaN(f)&&2>=f.toString().length&&(e=f)}a.setHours(b);a.setMinutes(e)}function cc(a){var c=new Date;if("date"===a.type)c=new Date(a.value);else if(a=a.value.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/))a=new Date(a[3],a[2]-1,a[1]),a instanceof Date&&!isNaN(a)&&
(c=a);return c}function jc(){na.style.display="none";z(q.body,O)}function Jd(){aa.style.display="block";var a=function(){aa.style.display="none"};nd(d.confirmEventRemoveTitle,d.confirmEventRemoveMessage,function(){a();jc();h(A.id)&&(Pa.removeEvent(A.id,!0),bc())},a)}function dc(a,c){var b=("0"+a.getDate()).slice(-2),e=("0"+(a.getMonth()+1)).slice(-2);return"date"===c?a.getFullYear()+"-"+e+"-"+b:b+"/"+e+"/"+a.getFullYear()}function ua(a){var c=("0"+a.getDate()).slice(-2),b=("0"+a.getMonth()).slice(-2);
return c+"/"+b+"/"+a.getFullYear()}function ec(a){return G(a.getHours())+":"+G(a.getMinutes())}function G(a){a=a.toString();return 1===a.length?"0"+a:a}function fc(a,c){Va.innerHTML=a;Va.style.display="block";c.focus()}function Gc(a){return a.replace(/^\s+|\s+$/g,"")}function bc(){rb(va)&&kb(T);rb(xa)&&Zc();rb(ya)&&db(ia)}function Kd(){Kc();A.color=Fa.value;A.colorText=Ga.value;A.colorBorder=Ha.value}function Kc(){ba.style.display="none";aa.style.display="none"}function Gd(){ba.style.display="block";
aa.style.display="block"}function Ld(){Lc();var a=[];Db.checked&&a.push(1);Eb.checked&&a.push(2);Fb.checked&&a.push(3);Gb.checked&&a.push(4);Hb.checked&&a.push(5);Ib.checked&&a.push(6);Jb.checked&&a.push(0);A.repeatEveryExcludeDays=a}function Lc(){ca.style.display="none";aa.style.display="none"}function Hd(){ca.style.display="block";aa.style.display="block"}function nd(a,c,b,e,f){f=h(f)?f:!1;da.style.display="block";kc.innerHTML=a;lc.innerHTML=c;Wa.onclick=qd;Xa.onclick=qd;Wa.addEventListener("click",
b);mc.checked=!1;Mc.style.display=f?"block":"none";tc(e)&&Xa.addEventListener("click",e)}function qd(){da.style.display="none"}function Pb(a){Qa(q.body,O);ea.style.display="block";sb=a;nc.checked=!0}function Qc(){z(q.body,O);ea.style.display="none"}function Md(){Qc();nc.checked?tb(sb,"csv"):Nc.checked?tb(sb,"xml"):Oc.checked?tb(sb,"json"):Pc.checked&&tb(sb,"text")}function Nd(a){ub||(ub=!0,rd=a.pageX-x.offsetLeft,sd=a.pageY-x.offsetTop)}function Td(a){ub&&(x.style.left=a.pageX-rd+"px",x.style.top=
a.pageY-sd+"px")}function Od(){ub&&(ub=!1,td=!0)}function ra(){Ia.disabled=!0;sa.disabled=""===R.value;X=[];ka=0}function Yc(){"block"!==x.style.display&&(X=[],x.style.display="block",R.value="",cd(),ra());R.focus()}function cd(){td||(x.style.left=ta.innerWidth/2-x.offsetWidth/2+"px",x.style.top=ta.innerHeight/2-x.offsetHeight/2+"px")}function Pd(){x.style.display="none"}function Qd(){"none"!==I.style.display?(I.style.display="none",fa.className="ib-square-hollow",u(fa,d.restoreTooltipText)):(I.style.display=
"block",fa.className="ib-minus",u(fa,d.minimizedTooltipText))}function Sd(){0<ka&&(ka--,ud(),Y(X[ka].from))}function Rd(a){13!==a.keyCode||sa.disabled||Vc()}function Vc(){if(0===X.length){var a=Rc.checked,c=a?R.value:R.value.toLowerCase(),b={};Mb(function(e){var f=y(e.title),k=y(e.location),l=y(e.description),m=!1;a||(f=f.toLowerCase(),l=l.toLowerCase(),k=k.toLowerCase());Sc.checked&&-1<f.indexOf(c)?m=!0:Tc.checked&&-1<k.indexOf(c)?m=!0:Uc.checked&&-1<l.indexOf(c)&&(m=!0);m&&(f=e.from.getMonth()+
"-"+e.from.getFullYear(),b.hasOwnProperty(f)||(X.push(e),b[f]=!0))})}else ka++;ud();0<X.length&&Y(X[ka].from)}function ud(){Ia.disabled=0===ka;sa.disabled=ka===X.length-1||0===X.length}function ed(a,c,b){r(a);null!==la&&(clearTimeout(la),la=null);pc();"block"!==v.style.display&&(la=setTimeout(function(){q.body.contains(O)||Rb()||vc()||wc()||(b=h(b)?b:"",v.className=""===b?"calendar-tooltip-event":"calendar-tooltip",""!==b?v.innerHTML=b:(v.innerHTML="",v.appendChild(oc),v.appendChild(Kb),oc.innerHTML=
c.title,lb(c.repeatEvery)&&0<c.repeatEvery?(Ya.innerHTML=d.repeatsText.replace(":","")+" "+La(c.repeatEvery),Qa(v,Ya)):(Ya.innerHTML="",z(v,Ya)),M(c.location)?($a.innerHTML=c.location,Qa(v,$a)):($a.innerHTML="",z(v,$a)),M(c.description)?(Za.innerHTML=c.description,Qa(v,Za)):(Za.innerHTML="",z(v,Za)),c.from.getDate()===c.to.getDate()?Kb.innerHTML=c.isAllDay?d.allDayText:hb(c.from,c.to):Yb(Kb,c.from,c.to)),Fc(a,v))},d.eventTooltipDelay))}function pc(){null!==la&&(clearTimeout(la),la=null);vd()&&(v.style.display=
"none")}function vd(){return null!==la||null!==v&&"block"===v.style.display}function u(a,c){a.onmousemove=function(b){ed(b,null,c)}}function ae(){null===gb&&0<d.autoRefreshTimerDelay&&(gb=setInterval(function(){Nb()},d.autoRefreshTimerDelay))}function Nb(){dd()&&(bc(),Z())}function dd(){return!vd()&&!q.body.contains(O)&&!Rb()&&!vc()&&!wc()}function Cc(a){rb(a)||(a.className+=" overlay-shown")}function Ac(a){rb(a)&&(a.className=a.className.replace(" overlay-shown",""))}function rb(a){return-1<a.className.indexOf("overlay-shown")}
function g(a,c,b){a=a.toLowerCase();var e="text"===a;Hc.hasOwnProperty(a)||(Hc[a]=e?q.createTextNode(""):q.createElement(a));a=Hc[a].cloneNode(!1);h(c)&&(a.className=c);h(b)&&(a.type=b);return a}function Aa(a){Ra.hasOwnProperty(a)&&null!==Ra[a]||(Ra[a]=q.getElementById(a));q.body.contains(Ra[a])||(Ra[a]=q.getElementById(a));return Ra[a]}function Qa(a,c){try{a.contains(c)||a.appendChild(c)}catch(b){console.warn(b.message)}}function z(a,c){try{a.contains(c)&&a.removeChild(c)}catch(b){console.warn(b.message)}}
function r(a){a.preventDefault();a.cancelBubble=!0}function Fc(a,c){var b=a.pageX,e=a.pageY;c.style.display="block";b+c.offsetWidth>ta.innerWidth?b-=c.offsetWidth:b++;e+c.offsetHeight>ta.innerHeight?e-=c.offsetHeight:e++;c.style.left=b+"px";c.style.top=e+"px"}function V(a,c,b,e){var f=g("div","radioButtonContainer");a.appendChild(f);a=g("label","radioButton");f.appendChild(a);f=g("input",null,"radio");f.name=b;a.appendChild(f);h(e)&&(f.onchange=e);b=g("span","check-mark");a.appendChild(b);b=g("span",
"text");b.innerText=c;a.appendChild(b);return f}function D(a,c,b){var e=g("div");a.appendChild(e);a=g("label","checkbox");a.innerText=c;e.appendChild(a);c=g("input",null,"checkbox");a.appendChild(c);h(b)&&(c.onchange=b);b=g("span","check-mark");a.appendChild(b);return[c,a]}function h(a){return void 0!==a&&null!==a&&""!==a}function tc(a){return h(a)&&"function"===typeof a}function wd(a){return h(a)&&"string"===typeof a}function lb(a){return h(a)&&"number"===typeof a}function od(a){return h(a)&&"object"===
typeof a&&a instanceof Array}function M(a){return wd(a)&&""!==a}function tb(a,c){c=h(c)?c.toLowerCase():"csv";var b="";var e=[];e=h(a)?e.concat(a):Lb();e=bb(e);if("csv"===c){var f=[d.fromText,d.toText,d.isAllDayText,d.titleText,d.descriptionText,d.locationText,d.backgroundColorText,d.textColorText,d.borderColorText,d.repeatsText,d.repeatDaysToExcludeText,d.seriesIgnoreDatesText,d.createdText],k=f.length;b=[];for(var l=[],m=0;m<k;m++)b.push(B(f[m]));l.push(b.join(","));f=e.length;for(k=0;k<f;k++){b=
l;m=e[k];var p=[];p.push(B(gc(m.from)));p.push(B(gc(m.to)));p.push(B(m.isAllDay?d.yesText:d.noText));p.push(B(y(m.title)));p.push(B(y(m.description)));p.push(B(y(m.location)));p.push(B(y(m.color)));p.push(B(y(m.colorText)));p.push(B(y(m.colorBorder)));p.push(B(La(m.repeatEvery)));p.push(B(S(m.repeatEveryExcludeDays).join(",")));p.push(B(S(m.seriesIgnoreDates).join(",")));p.push(B(gc(m.created)));b.push(p.join(","))}b=l.join("\n")}else if("xml"===c){f=[];f.push('<?xml version="1.0" ?>');f.push("<Events>");
k=e.length;for(b=0;b<k;b++){m=e[b];f.push("<Event>");for(l in m)m.hasOwnProperty(l)&&(p=xd(l),f.push("<"+p+">"+Ic(l,m[l])+"</"+p+">"));f.push("</Event>")}f.push("</Events>");b=f.join("\n")}else if("json"===c){l=[];l.push("{");l.push('"events:": [');k=e.length;for(b=0;b<k;b++){m=e[b];l.push("{");for(f in m)m.hasOwnProperty(f)&&l.push('"'+f+'":"'+Ic(f,m[f])+'",');m=l[l.length-1];l[l.length-1]=m.substring(0,m.length-1);l.push("},")}l[l.length-1]="}";l.push("]");l.push("}");b=l.join("\n")}else if("text"===
c){l=[];f=e.length;for(b=0;b<f;b++){m=e[b];for(k in m)m.hasOwnProperty(k)&&l.push(xd(k)+": "+Ic(k,m[k]));l.push("")}l.pop();b=l.join("\n")}""!==b&&(e=g("a"),f="text"===c?"plain":c,l="text"===c?"txt":c,e.style.display="none",e.setAttribute("target","_blank"),e.setAttribute("href","data:text/"+f+";charset=utf-8,"+encodeURIComponent(b)),f=e.setAttribute,b=new Date,k=G(b.getDate())+"-"+G(b.getMonth())+"-"+b.getFullYear(),b=G(b.getHours())+"-"+G(b.getMinutes()),f.call(e,"download",d.exportStartFilename+
k+"_"+b+"."+l),q.body.appendChild(e),e.click(),q.body.removeChild(e),fb("onEventsExported"))}function gc(a){var c=G(a.getDate())+"/"+G(a.getMonth())+"/"+a.getFullYear();a=G(a.getHours())+":"+G(a.getMinutes());return c+" "+a}function y(a,c){c=h(c)?c:"";return wd(a)?a:c}function W(a,c){c=h(c)?c:0;return lb(a)?a:c}function Xc(a,c){c=h(c)?c:0;return h(a)&&"boolean"===typeof a?a?1:0:c}function S(a,c){c=h(c)?c:[];return od(a)?a:c}function La(a){var c=d.repeatsNever;a=W(a);1===a?c=d.repeatsEveryDayText:
2===a?c=d.repeatsEveryWeekText:3===a?c=d.repeatsEveryMonthText:4===a&&(c=d.repeatsEveryYearText);return c}function xd(a){return a.charAt(0).toUpperCase()+a.slice(1)}function Ic(a,c){var b=y(c);"boolean"===typeof c?b=c?d.yesText:d.noText:"object"===typeof c&&c instanceof Date?b=gc(c):"object"===typeof c&&c instanceof Array?b=S(c).join(","):"number"===typeof c&&(b="repeatEvery"===a?La(c):c.toString());return b}function B(a){a=a.replace(/(\r\n|\n|\r)/gm,"").replace(/(\s\s)/gm," ");a=a.replace(/"/g,'""');
return'"'+a+'"'}function qc(){var a=new Date(t);a.setMonth(a.getMonth()-1);a.setDate(1);Y(a);fb("onPreviousMonth")}function sc(){var a=new Date(t);a.setMonth(a.getMonth()+1);a.setDate(1);Y(a);fb("onNextMonth")}function rc(){var a=new Date;if(t.getMonth()!==a.getMonth()||t.getFullYear()!==a.getFullYear())Y(),fb("onToday")}var d={},Pa=this,t=null,ic=null,Hc={},Ra={},q=null,ta=null,Jc=null,wb=!1,bd=!1,J={},gb=null,w=null,ad=null,uc=!1,E=null,ab=null,K=null,Qb=null,Ja=null,O=null,na=null,aa=null,xb=null,
H=null,P=null,C=null,Q=null,Sa=null,oa=null,Ua=null,Ta=null,qa=null,zb=null,Ab=null,Bb=null,Cb=null,Ca=null,Va=null,A={},Da=null,Ea=null,ba=null,Fa=null,Ga=null,Ha=null,ca=null,Db=null,Eb=null,Fb=null,Gb=null,Hb=null,Ib=null,Jb=null,va=null,ib=null,jb=null,T=null,Bc=[],Ka=null,xa=null,mb=null,nb=null,ya=null,U=null,Ma=null,pb=null,Na={},Dc={},ob=[],ia=null,da=null,kc=null,lc=null,mc=null,Mc=null,Wa=null,Xa=null,ea=null,nc=null,Nc=null,Oc=null,Pc=null,sb=null,v=null,oc=null,Kb=null,Ya=null,Za=null,
$a=null,la=null,F=null,ac=null,L=null,ja=null,qb=null,x=null,fa=null,I=null,R=null,Rc=null,Sc=null,Tc=null,Uc=null,Ia=null,sa=null,ub=!1,td=!1,rd=0,sd=0,X=[],ka=0;this.moveToPreviousMonth=function(){qc()};this.moveToNextMonth=function(){sc()};this.moveToToday=function(){rc()};this.exportAllEvents=function(a){d.exportEventsEnabled&&(a=h(a)?a:"csv",tb(null,a))};this.refresh=function(){Nb()};this.addEvents=function(a,c,b){c=h(c)?c:!0;b=h(b)?b:!0;for(var e=a.length,f=0;f<e;f++)this.addEvent(a[f],!1,!1);
b&&Sb("onEventAdded",a);c&&Z()};this.addEvent=function(a,c,b){var e=!1;if(a.from<=a.to){var f=a.from;f=f.getFullYear()+"-"+f.getMonth()+"-"+f.getDate();var k=$c();J.hasOwnProperty(f)||(J[f]={});J[f].hasOwnProperty(k)||(c=h(c)?c:!0,b=h(b)?b:!0,h(a.id)?k=a.id:a.id=k,h(a.created)||(a.created=new Date),J[f][k]=Wc(a),e=!0,b&&Sb("onEventAdded",a),c&&Z())}return e};this.updateEvent=function(a,c,b,e){if(a=this.removeEvent(a,!1,!1))b=h(b)?b:!0,e=h(e)?e:!0,c.id=$c(),(a=this.addEvent(c,b,!1))&&e&&Sb("onEventUpdated",
c);return a};this.removeEvent=function(a,c,b){var e=!1;Mb(function(f,k,l){if(l===a)return c=h(c)?c:!0,b=h(b)?b:!0,delete J[k][l],e=!0,b&&Sb("onEventRemoved",f),c&&Z(),!0});return e};this.clearEvents=function(a){a=h(a)?a:!0;J={};fb("onEventsCleared");a&&Z()};this.setOptions=function(a){d=null!==a&&"object"===typeof a?a:{};h(d.previousMonthTooltipText)||(d.previousMonthTooltipText="Previous Month");h(d.nextMonthTooltipText)||(d.nextMonthTooltipText="Next Month");h(d.previousDayTooltipText)||(d.previousDayTooltipText=
"Previous Day");h(d.nextDayTooltipText)||(d.nextDayTooltipText="Next Day");h(d.previousWeekTooltipText)||(d.previousWeekTooltipText="Previous Week");h(d.nextWeekTooltipText)||(d.nextWeekTooltipText="Next Week");h(d.addEventTooltipText)||(d.addEventTooltipText="Add Event");h(d.closeTooltipText)||(d.closeTooltipText="Close");h(d.exportEventsTooltipText)||(d.exportEventsTooltipText="Export Events");h(d.todayTooltipText)||(d.todayTooltipText="Today");h(d.refreshTooltipText)||(d.refreshTooltipText="Refresh");
h(d.searchTooltipText)||(d.searchTooltipText="Search");h(d.expandDayTooltipText)||(d.expandDayTooltipText="Expand Day");h(d.listAllEventsTooltipText)||(d.listAllEventsTooltipText="View All Events");h(d.listWeekEventsTooltipText)||(d.listWeekEventsTooltipText="View Current Week Events");h(d.dayHeaderNames)||(d.dayHeaderNames="Mon Tue Wed Thu Fri Sat Sun".split(" "));h(d.dayNames)||(d.dayNames="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "));h(d.fromText)||(d.fromText="From:");
h(d.toText)||(d.toText="To:");h(d.isAllDayText)||(d.isAllDayText="Is All-Day");h(d.titleText)||(d.titleText="Title:");h(d.descriptionText)||(d.descriptionText="Description:");h(d.locationText)||(d.locationText="Location:");h(d.addText)||(d.addText="Add");h(d.updateText)||(d.updateText="Update");h(d.cancelText)||(d.cancelText="Cancel");h(d.removeEventText)||(d.removeEventText="Remove");h(d.addEventTitle)||(d.addEventTitle="Add Event");h(d.editEventTitle)||(d.editEventTitle="Edit Event");h(d.monthNames)||
(d.monthNames="January February March April May June July August September October November December".split(" "));h(d.showDayNumberOrdinals)||(d.showDayNumberOrdinals=!0);h(d.dragAndDropForEventsEnabled)||(d.dragAndDropForEventsEnabled=!0);h(d.exportStartFilename)||(d.exportStartFilename="exported_events_");h(d.fromTimeErrorMessage)||(d.fromTimeErrorMessage="Please select a valid 'From' time.");h(d.toTimeErrorMessage)||(d.toTimeErrorMessage="Please select a valid 'To' time.");h(d.toSmallerThanFromErrorMessage)||
(d.toSmallerThanFromErrorMessage="Please select a 'To' date that is larger than the 'From' date.");h(d.titleErrorMessage)||(d.titleErrorMessage="Please enter a value in the 'Title' field (no empty space).");h(d.stText)||(d.stText="st");h(d.ndText)||(d.ndText="nd");h(d.rdText)||(d.rdText="rd");h(d.thText)||(d.thText="th");h(d.maximumEventsPerDayDisplay)||(d.maximumEventsPerDayDisplay=3);h(d.yesText)||(d.yesText="Yes");h(d.noText)||(d.noText="No");h(d.extraSelectableYearsAhead)||(d.extraSelectableYearsAhead=
51);h(d.allDayText)||(d.allDayText="All-Day");h(d.allEventsText)||(d.allEventsText="All Events");h(d.exportEventsEnabled)||(d.exportEventsEnabled=!0);h(d.manualEditingEnabled)||(d.manualEditingEnabled=!0);h(d.showTimesInMainCalendarEvents)||(d.showTimesInMainCalendarEvents=!1);h(d.startsOnText)||(d.startsOnText="Starts on the");h(d.andFinishesOnText)||(d.andFinishesOnText="and finishes on the");h(d.toTimeText)||(d.toTimeText="to");h(d.autoRefreshTimerDelay)||(d.autoRefreshTimerDelay=5E3);h(d.confirmEventRemoveTitle)||
(d.confirmEventRemoveTitle="Confirm Event Removal");h(d.confirmEventRemoveMessage)||(d.confirmEventRemoveMessage="Removing this event cannot be undone.  Do you want to continue?");h(d.okText)||(d.okText="OK");h(d.selectExportTypeTitle)||(d.selectExportTypeTitle="Select Export Type");h(d.fullScreenModeEnabled)||(d.fullScreenModeEnabled=!0);h(d.eventTooltipDelay)||(d.eventTooltipDelay=1E3);h(d.selectColorsText)||(d.selectColorsText="Select Colors");h(d.backgroundColorText)||(d.backgroundColorText="Background Color:");
h(d.textColorText)||(d.textColorText="Text Color:");h(d.borderColorText)||(d.borderColorText="Border Color:");h(d.searchEventsTitle)||(d.searchEventsTitle="Search Events");h(d.forText)||(d.forText="For:");h(d.previousText)||(d.previousText="Previous");h(d.nextText)||(d.nextText="Next");h(d.matchCaseText)||(d.matchCaseText="Match Case");h(d.minimumDayHeight)||(d.minimumDayHeight=0);h(d.repeatsText)||(d.repeatsText="Repeats:");h(d.repeatDaysToExcludeText)||(d.repeatDaysToExcludeText="Repeat Days To Exclude:");
h(d.seriesIgnoreDatesText)||(d.seriesIgnoreDatesText="Series Ignore Dates:");h(d.repeatsNever)||(d.repeatsNever="Never");h(d.repeatsEveryDayText)||(d.repeatsEveryDayText="Every Day");h(d.repeatsEveryWeekText)||(d.repeatsEveryWeekText="Every Week");h(d.repeatsEveryMonthText)||(d.repeatsEveryMonthText="Every Month");h(d.repeatsEveryYearText)||(d.repeatsEveryYearText="Every Year");h(d.selectDaysToExcludeTitle)||(d.selectDaysToExcludeTitle="Select Days To Exclude");h(d.moreText)||(d.moreText="More");
h(d.includeText)||(d.includeText="Include:");h(d.holidays)||(d.holidays=[{day:24,month:12,title:"Christmas Eve"},{day:25,month:12,title:"Christmas Day"},{day:26,month:12,title:"Boxing Day"},{day:31,month:12,title:"New Year's Eve"},{day:1,month:1,title:"New Year's Day"}]);h(d.minimizedTooltipText)||(d.minimizedTooltipText="Minimize");h(d.restoreTooltipText)||(d.restoreTooltipText="Restore");h(d.removeAllEventsInSeriesText)||(d.removeAllEventsInSeriesText="Remove All Events In Series");h(d.createdText)||
(d.createdText="Created:");wb&&(wb=!1,Y(t,!0))};(function(a,c){q=a;ta=c;Jc=yd;Pa.setOptions(zd);Y(Ad,!0)})(document,window)};