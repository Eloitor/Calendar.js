function calendarJs(Rd,Sd,Td){function J(a,c){t=h(a)?a:new Date;c=h(c)?c:!1;t.setDate(1);t.setHours(0,0,0,0);var b=(new Date(t.getFullYear(),t.getMonth(),1)).getDay(),e=Fb(t.getFullYear(),t.getMonth());0===b&&(b=7);xa();if(!Gb){B=Ka(Vc);B.className="calendar";B.innerHTML="";Ud();Vd();Wd();Xd();var f=g("div","row header-days"),k=d.dayHeaderNames.length;B.appendChild(f);for(var l=0;l<k;l++){var m=d.dayHeaderNames[l],n=g("div","cell");n.innerHTML=m;f.appendChild(n)}for(f=0;6>f;f++)for(k=g("div","row"),
B.appendChild(k),l=0;7>l;l++)m=7*f+(l+1),n=g("div","cell"),n.id="calendar-day-"+m,k.appendChild(n),0<d.minimumDayHeight&&(n.style.height=d.minimumDayHeight+"px");Yd();Gb=!0}m=b;if(1<m)for(f=new Date(t),f.setMonth(f.getMonth()-1),k=Fb(f.getFullYear(),f.getMonth()),l=1,m=k-m+1;m<k;m++)sc(m+1,l,f.getMonth(),f.getFullYear(),!0),l++;for(k=f=0;k<e;k++)f=b+k,sc(k+1,f,t.getMonth(),t.getFullYear(),!1);if(42>f){b=1;e=new Date(t);e.setMonth(e.getMonth()+1);for(f+=1;43>f;f++)sc(b,f,e.getMonth(),e.getFullYear(),
!0),b++;b=Fb(e.getFullYear(),e.getMonth());b=Math.round(b/2);tc=new Date(e.getFullYear(),e.getMonth(),b)}else tc=null;ja();c&&(null===R&&(R=g("div","disabled-background")),null!==ya&&C(q.body,ya),ya=g("div","calendar-dialog event-editor"),q.body.appendChild(ya),b=g("div","view"),ya.appendChild(b),ka=g("div","disabled-area"),b.appendChild(ka),Hb=g("div","title-bar"),b.appendChild(Hb),e=g("div","contents"),b.appendChild(e),b=g("p"),b.innerText=d.titleText,e.appendChild(b),b=g("div","input-title-container"),
e.appendChild(b),za=g("input",null,"text"),b.appendChild(za),f=g("input","select-colors","button"),f.value="...",f.onclick=Zd,b.appendChild(f),b=g("p"),b.innerText=d.fromText.replace(":","")+"/"+d.toText,e.appendChild(b),b=g("div","split"),e.appendChild(b),K=g("input"),K.onchange=Ib,b.appendChild(K),Aa(K,"date"),S=g("input"),b.appendChild(S),Aa(S,"time"),b=g("div","split"),e.appendChild(b),G=g("input"),G.onchange=Ib,b.appendChild(G),Aa(G,"date"),T=g("input"),b.appendChild(T),Aa(T,"time"),eb=H(e,d.isAllDayText,
Ib)[0],b=g("p"),b.innerText=d.repeatsText,e.appendChild(b),b=g("div","radioButtonsContainer"),e.appendChild(b),Ba=U(b,d.repeatsNever,"RepeatType",La),Jb=U(b,d.repeatsEveryDayText,"RepeatType",La),Kb=U(b,d.repeatsEveryWeekText,"RepeatType",La),Lb=U(b,d.repeatsEveryMonthText,"RepeatType",La),Mb=U(b,d.repeatsEveryYearText,"RepeatType",La),Ma=g("input","repeat-options","button"),Ma.value="...",Ma.onclick=$d,b.appendChild(Ma),b=g("p"),b.innerText=d.locationText,e.appendChild(b),fb=g("input",null,"text"),
e.appendChild(fb),b=g("p"),b.innerText=d.descriptionText,e.appendChild(b),gb=g("textarea","custom-scroll-bars"),e.appendChild(gb),hb=g("p","error"),e.appendChild(hb),b=g("div","split"),e.appendChild(b),Na=g("input","ok","button"),Na.value=d.addText,Na.onclick=ae,b.appendChild(Na),f=g("input","cancel","button"),f.value=d.cancelText,f.onclick=uc,b.appendChild(f),Oa=g("input","remove","button"),Oa.value=d.removeEventText,Oa.onclick=be,e.appendChild(Oa),null!==la&&C(q.body,la),la=g("div","calendar-dialog event-editor-colors"),
q.body.appendChild(la),e=g("div","title-bar"),e.innerHTML=d.selectColorsText,la.appendChild(e),e=g("div","contents"),la.appendChild(e),b=g("p"),b.innerText=d.backgroundColorText,e.appendChild(b),Pa=g("input"),e.appendChild(Pa),Aa(Pa,"color"),b=g("p"),b.innerText=d.textColorText,e.appendChild(b),Qa=g("input"),e.appendChild(Qa),Aa(Qa,"color"),b=g("p"),b.innerText=d.borderColorText,e.appendChild(b),Ra=g("input"),e.appendChild(Ra),Aa(Ra,"color"),b=g("div","split"),e.appendChild(b),e=g("input","ok","button"),
e.value=d.okText,e.onclick=ce,b.appendChild(e),e=g("input","cancel","button"),e.value=d.cancelText,e.onclick=Wc,b.appendChild(e),null!==ma&&C(q.body,ma),ma=g("div","calendar-dialog event-editor-repeat-options"),q.body.appendChild(ma),e=g("div","title-bar"),e.innerHTML=d.repeatOptionsTitle,ma.appendChild(e),b=g("div","contents"),ma.appendChild(b),e=g("p"),e.innerText=d.daysToExcludeText,b.appendChild(e),Nb=H(b,d.dayNames[0])[0],Ob=H(b,d.dayNames[1])[0],Pb=H(b,d.dayNames[2])[0],Qb=H(b,d.dayNames[3])[0],
Rb=H(b,d.dayNames[4])[0],Sb=H(b,d.dayNames[5])[0],Tb=H(b,d.dayNames[6])[0],e=g("div","split"),b.appendChild(e),b=g("input","ok","button"),b.value=d.okText,b.onclick=de,e.appendChild(b),b=g("input","cancel","button"),b.value=d.cancelText,b.onclick=Xc,e.appendChild(b),null!==na&&C(q.body,na),na=g("div","calendar-dialog confirmation"),q.body.appendChild(na),vc=g("div","title-bar"),na.appendChild(vc),e=g("div","contents"),na.appendChild(e),wc=g("div","message"),e.appendChild(wc),b=H(e,d.removeAllEventsInSeriesText),
Ub=b[0],xc=b[1],b=g("div","split"),e.appendChild(b),ib=g("input","yes","button"),ib.value=d.yesText,b.appendChild(ib),jb=g("input","no","button"),jb.value=d.noText,b.appendChild(jb),null!==oa&&C(q.body,oa),oa=g("div","calendar-dialog select-export-type"),q.body.appendChild(oa),e=g("div","title-bar"),e.innerHTML=d.selectExportTypeTitle,oa.appendChild(e),b=g("div","contents"),oa.appendChild(b),e=g("div","radioButtonsContainer"),b.appendChild(e),yc=U(e,"CSV","ExportType"),Yc=U(e,"XML","ExportType"),
Zc=U(e,"JSON","ExportType"),$c=U(e,"TEXT","ExportType"),ad=U(e,"iCAL","ExportType"),e=g("div","split"),b.appendChild(e),b=g("input","ok","button"),b.value=d.okText,b.onclick=ee,e.appendChild(b),b=g("input","cancel","button"),b.value=d.cancelText,b.onclick=bd,e.appendChild(b),null!==z&&C(q.body,z),z=g("div","calendar-dialog search"),q.body.appendChild(z),e=g("div","title-bar"),e.innerHTML=d.searchEventsTitle,e.onmousedown=fe,e.onmouseup=ge,z.appendChild(e),b=g("div","ib-close"),b.onclick=he,e.appendChild(b),
p(b,d.closeTooltipText),pa=g("div","ib-minus"),pa.onclick=ie,e.appendChild(pa),p(pa,d.minimizedTooltipText),L=g("div","contents"),z.appendChild(L),e=g("p"),e.innerText=d.forText,L.appendChild(e),V=g("input",null,"text"),V.oninput=Ca,V.onpropertychange=Ca,V.onkeypress=je,L.appendChild(V),cd=H(L,d.matchCaseText,Ca)[0],e=g("p"),e.innerText=d.includeText,L.appendChild(e),e=g("div","checkboxContainer"),L.appendChild(e),dd=H(e,d.titleText.replace(":",""),Ca)[0],ed=H(e,d.locationText.replace(":",""),Ca)[0],
fd=H(e,d.descriptionText.replace(":",""),Ca)[0],e=g("div","split"),L.appendChild(e),Sa=g("input","previous","button"),Sa.value=d.previousText,Sa.onclick=ke,e.appendChild(Sa),Da=g("input","next","button"),Da.value=d.nextText,Da.onclick=gd,e.appendChild(Da),q.body.addEventListener("mousemove",le),null===w&&(w=g("div"),q.body.appendChild(w),zc=g("div","title"),Vb=g("div","date"),kb=g("div","repeats"),lb=g("div","description"),mb=g("div","location"),document.body.addEventListener("mousemove",Ac)),me(),
ne());nb.innerHTML=d.monthNames[t.getMonth()]+", "+t.getFullYear()+" \u25be"}function ob(){var a=[];pb(function(c){a.push(c)});return a}function pb(a){for(var c in M)if(M.hasOwnProperty(c))for(var b in M[c])if(M[c].hasOwnProperty(b)){var e=hd(M[c][b]);if(a(e,c,b))return}}function Ea(a,c){c=h(c)?c:!0;a=a.sort(function(b,e){return b.from-e.from});c&&(a=a.sort(function(b,e){return id(e.isAllDay)-id(b.isAllDay)}));return a}function Xd(){D=g("div","header-date");B.appendChild(D);d.fullScreenModeEnabled&&
(D.ondblclick=ba);var a=g("div","ib-arrow-left-full");a.onclick=Bc;a.ondblclick=r;D.appendChild(a);p(a,d.previousMonthTooltipText);a=g("div","ib-pin");a.onclick=Cc;a.ondblclick=r;D.appendChild(a);p(a,d.todayTooltipText);a=g("div","ib-refresh");a.onclick=Wb;a.ondblclick=r;D.appendChild(a);p(a,d.refreshTooltipText);a=g("div","ib-search");a.onclick=jd;a.ondblclick=r;D.appendChild(a);p(a,d.searchTooltipText);a=g("div","ib-arrow-right-full");a.onclick=Dc;a.ondblclick=r;D.appendChild(a);p(a,d.nextMonthTooltipText);
d.manualEditingEnabled&&(a=g("div","ib-plus"),a.onclick=Xb,a.ondblclick=r,D.appendChild(a),p(a,d.addEventTooltipText));d.exportEventsEnabled&&(Ta=g("div","ib-arrow-down-full-line"),Ta.ondblclick=r,D.appendChild(Ta),p(Ta,d.exportEventsTooltipText),Ta.onclick=function(){Yb()});a=g("div","ib-eye");a.ondblclick=r;D.appendChild(a);a.onclick=function(){kd(!0)};p(a,d.listAllEventsTooltipText);a=g("div","ib-hamburger");a.ondblclick=r;D.appendChild(a);a.onclick=function(){qb(null,!0)};p(a,d.listWeekEventsTooltipText);
d.fullScreenModeEnabled&&(ca=g("div","ib-arrow-expand-left-right"),ca.ondblclick=r,ca.onclick=ba,D.appendChild(ca),p(ca,d.enableFullScreenTooltipText));a=g("div","title-container");D.appendChild(a);nb=g("span");nb.ondblclick=r;a.appendChild(nb);oe(a)}function oe(a){var c=new Date(1900,1,1),b=(new Date).getFullYear()-c.getFullYear()+d.extraSelectableYearsAhead;N=g("div","years-drop-down");a.appendChild(N);Zb=g("div","contents custom-scroll-bars");N.appendChild(Zb);for(a=0;a<b;a++)pe(c.getFullYear()),
c.setFullYear(c.getFullYear()+1);nb.onclick=qe}function pe(a){var c=g("div");c.innerText=a.toString();c.id="year-selected-"+a.toString();Zb.appendChild(c);c.onclick=function(){t.setFullYear(a);J(t);$b()&&(N.style.display="none")}}function hd(a){a.isAllDay&&(a.from=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),0,0),a.to=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),23,59));return a}function rb(a,c){var b=new Date(a.getFullYear(),a.getMonth(),a.getDate()),e=new Date(c.getFullYear(),
c.getMonth(),c.getDate());return Math.ceil(Math.abs(e-b)/864E5)}function qe(a){if("block"!==N.style.display){xa();r(a);a=N.getElementsByClassName("current-year-selected");if(1<=a.length)for(var c=a.length,b=0;b<c;b++)a[b].removeAttribute("class");a=Ka("year-selected-"+t.getFullYear());null!==a&&(a.className="current-year-selected");N.style.display="block";Zb.scrollTop=a.offsetTop-N.offsetHeight/2}}function $b(){return null!==N&&"block"===N.style.display}function qa(a){if(null!==d&&Ec(d[a]))d[a]()}
function ac(a,c){if(null!==d&&Ec(d[a]))d[a](c)}function ld(){for(var a=[],c=0;32>c;c++){8!==c&&12!==c&&16!==c&&20!==c||a.push("-");var b=Math.floor(16*Math.random()).toString(16);a.push(b)}return a.join("")}function ba(){Ua?md():nd()}function nd(){!Ua&&d.fullScreenModeEnabled&&(od=B.style.cssText,Ua=!0,ca.className="ib-arrow-contract-left-right",da.className="ib-arrow-contract-left-right",ea.className="ib-arrow-contract-left-right",fa.className="ib-arrow-contract-left-right",p(ca,d.disableFullScreenTooltipText),
p(da,d.disableFullScreenTooltipText),p(ea,d.disableFullScreenTooltipText),p(fa,d.disableFullScreenTooltipText),B.className+=" full-screen-view",B.removeAttribute("style"))}function md(){Ua&&d.fullScreenModeEnabled&&(Ua=!1,ca.className="ib-arrow-expand-left-right",da.className="ib-arrow-expand-left-right",ea.className="ib-arrow-expand-left-right",fa.className="ib-arrow-expand-left-right",p(ca,d.enableFullScreenTooltipText),p(da,d.enableFullScreenTooltipText),p(ea,d.enableFullScreenTooltipText),p(fa,
d.enableFullScreenTooltipText),B.className=B.className.replace(" full-screen-view",""),B.style.cssText=od)}function Yd(){pd||(q.body.addEventListener("click",xa),q.body.addEventListener("contextmenu",xa),Fa.addEventListener("resize",xa),Fa.addEventListener("resize",qd),q.addEventListener("keydown",function(a){Ua&&rd()&&(37===a.keyCode&&(a.ctrlKey||a.metaKey)?(a.preventDefault(),sd()):39===a.keyCode&&(a.ctrlKey||a.metaKey)?(a.preventDefault(),td()):70===a.keyCode&&(a.ctrlKey||a.metaKey)?(a.preventDefault(),
jd()):27===a.keyCode?ba():37===a.keyCode?Bc():39===a.keyCode?Dc():40===a.keyCode?Cc():116===a.keyCode&&Wb())}),pd=!0)}function xa(){Fc()&&(I.style.display="none");Gc()&&(O.style.display="none");$b()&&(N.style.display="none");Ac()}function ja(){re();ud();for(var a=Ea(ob()),c=a.length,b=0;b<c;b++){var e=a[b];null!==bc(e.from)&&se(e);var f=W(e.repeatEvery);0<f&&(1===f?cc(e,function(k){k.setDate(k.getDate()+1)}):2===f?cc(e,function(k){k.setDate(k.getDate()+7)}):3===f?cc(e,function(k){k.setMonth(k.getMonth()+
1)}):4===f&&cc(e,function(k){k.setFullYear(k.getFullYear()+1)}))}d.exportEventsEnabled&&(Ta.style.display=0===c?"none":"inline-block");vd()}function cc(a,c){for(var b=new Date(a.from),e=X(a.repeatEveryExcludeDays),f=X(a.seriesIgnoreDates);b<tc;){c(b);var k=Va(b);-1===e.indexOf(b.getDay())&&-1===f.indexOf(k)&&null!==bc(b)&&Hc(b,a)}}function se(a){Hc(a.from,a);if(a.from.getDate()!==a.to.getDate()){var c=rb(a.from,a.to);if(0<c)for(var b=new Date(a.from),e=0;e<c;e++)b.setDate(b.getDate()+1),null!==bc(b)&&
Hc(b,a)}}function Hc(a,c){var b=bc(a);if(null!==b){var e=d.manualEditingEnabled?"event":"event-no-hover";if(b.getElementsByClassName(e).length<d.maximumEventsPerDayDisplay){e=g("div",e);var f=c.title;d.showTimesInMainCalendarEvents&&!c.isAllDay&&c.from.getDate()===c.to.getDate()&&(f=sb(c.from,c.to)+": "+f);e.innerHTML=f;b.appendChild(e);dc(c,e,Ic(c,a));e.onmousemove=function(l){wd(l,c)};if(d.manualEditingEnabled){var k=Va(a);e.oncontextmenu=function(l){ec(l,c,k)}}d.manualEditingEnabled&&(e.onclick=
function(){ra(c)});d.dragAndDropForEventsEnabled&&d.manualEditingEnabled&&(e.setAttribute("draggable",!0),e.ondragstart=function(){x=c})}else e=b.getElementsByClassName("plus-x-events"),e=0<e.length?e[0]:null,null===e?(e=g("div","plus-x-events"),e.setAttribute("events","1"),e.innerHTML="+1 "+d.moreText,b.appendChild(e)):(b=parseInt(e.getAttribute("events"))+1,e.setAttribute("events",b.toString()),e.innerHTML="+"+b+" "+d.moreText)}}function bc(a){var c=new Date(t.getFullYear(),t.getMonth(),1);var b=
new Date(t);var e=new Date(t),f=null,k=0;c=Jc(c);b.setMonth(b.getMonth()+1);e.setMonth(e.getMonth()-1);a.getMonth()===b.getMonth()&&a.getFullYear()===b.getFullYear()?(b=c+Fb(t.getFullYear(),t.getMonth()),k=a.getDate()+b):a.getMonth()===e.getMonth()&&a.getFullYear()===e.getFullYear()?k=c-rb(a,t)+1:a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear()&&(b=c,k=a.getDate()+b);0<k&&(f=Ka("calendar-day-"+k));return f}function re(){for(var a=0;6>a;a++)for(var c=0;7>c;c++){var b=Ka("calendar-day-"+
(7*a+(c+1)));Kc(b,d.manualEditingEnabled?"event":"event-no-hover");Kc(b,"plus-x-events")}}function Kc(a,c){for(var b=a.getElementsByClassName(c);b[0];)b[0].parentNode.removeChild(b[0])}function dc(a,c,b){h(b)&&b<new Date&&(c.className+=" expired");P(a.color)?(c.style.backgroundColor=a.color,P(a.colorText)&&(c.style.color=a.colorText),P(a.colorBorder)&&(c.style.borderLeftColor=a.colorBorder)):a.isAllDay&&(c.className+=" all-day")}function Ic(a,c){var b=W(a.repeatEvery),e=new Date(a.to);0<b&&(b=new Date(c),
b.setHours(e.getHours(),e.getMinutes()),e=b);return e}function Wd(){Ga=g("div","full-day-view");B.appendChild(Ga);var a=g("div","title-bar");Ga.appendChild(a);d.fullScreenModeEnabled&&(a.ondblclick=ba);tb=g("div","title");a.appendChild(tb);var c=g("div","ib-close");c.ondblclick=r;a.appendChild(c);p(c,d.closeTooltipText);c.onclick=function(){fc(Ga);Y=null};d.manualEditingEnabled&&(c=g("div","ib-plus"),c.onclick=Xb,c.ondblclick=r,a.appendChild(c),p(c,d.addEventTooltipText));c=g("div","ib-arrow-right-full");
c.onclick=te;c.ondblclick=r;a.appendChild(c);p(c,d.nextDayTooltipText);c=g("div","ib-arrow-left-full");c.onclick=ue;c.ondblclick=r;a.appendChild(c);p(c,d.previousDayTooltipText);d.exportEventsEnabled&&(Wa=g("div","ib-arrow-down-full-line"),Wa.ondblclick=r,a.appendChild(Wa),p(Wa,d.exportEventsTooltipText),Wa.onclick=function(){Yb(Lc)});d.fullScreenModeEnabled&&(da=g("div","ib-arrow-expand-left-right"),da.ondblclick=r,da.onclick=ba,a.appendChild(da),p(da,d.enableFullScreenTooltipText));ha=g("div","contents custom-scroll-bars");
Ga.appendChild(ha);Ha=g("div","content-events-all-day");ha.appendChild(Ha);a=g("div","all-day-text");a.innerHTML=d.allDayText;Ha.appendChild(a);ub=g("div","contents-events");ha.appendChild(ub);for(a=0;24>a;a++){c=g("div","hour");ub.appendChild(c);var b=g("div","hour-text");b.innerHTML=E(a)+":00";c.appendChild(b);b=g("div","hour-text");b.innerHTML=E(a)+":30";c.appendChild(b)}}function Xa(a,c){c=h(c)?c:!1;tb.innerText="";Y=new Date(a);Lc=[];Ha.style.display="block";Kc(ha,d.manualEditingEnabled?"event":
"event-no-hover");Mc(Ga);Ia(tb,a,!1,!0,!0);var b=xd(a),e=[];if(null!==b){var f=g("span","holiday");f.innerText=" ("+b+")";tb.appendChild(f)}pb(function(m){for(var n=rb(m.from,m.to)+1,u=new Date(m.from),Z=0;Z<n;Z++){if(gc(u,a)){e.push(m);break}u.setDate(u.getDate()+1)}n=W(m.repeatEvery);0<n&&(1===n?hc(m,e,a,function(y){y.setDate(y.getDate()+1)}):2===n?hc(m,e,a,function(y){y.setDate(y.getDate()+7)}):3===n?hc(m,e,a,function(y){y.setMonth(y.getMonth()+1)}):4===n&&hc(m,e,a,function(y){y.setFullYear(y.getFullYear()+
1)}))});e=Ea(e);b=e.length;f=null;for(var k=0;k<b;k++){var l=ve(e[k],a);null===f&&(f=l)}c&&(ha.scrollTop=f-ha.offsetHeight/2);1>=Ha.offsetHeight&&(Ha.style.display="none");d.exportEventsEnabled&&(Wa.style.display=0===e.length?"none":"inline-block")}function hc(a,c,b,e){for(var f=new Date(a.from),k=X(a.repeatEveryExcludeDays),l=X(a.seriesIgnoreDates);f<b;){e(f);var m=Va(f);if(-1===k.indexOf(f.getDay())&&-1===l.indexOf(m)&&gc(f,b)){c.push(a);break}}}function ve(a,c){var b=g("div",d.manualEditingEnabled?
"event":"event-no-hover");a.isAllDay?Ha.appendChild(b):ub.appendChild(b);if(d.manualEditingEnabled){var e=Va(c);b.oncontextmenu=function(k){ec(k,a,e)}}dc(a,b,Ic(a,c));var f=g("div","title");f.innerHTML=a.title;b.appendChild(f);f=g("div","date");b.appendChild(f);a.from.getDate()===a.to.getDate()?f.innerHTML=a.isAllDay?d.allDayText:sb(a.from,a.to):ic(f,a.from,a.to);vb(a.repeatEvery)&&0<a.repeatEvery&&(f=g("div","repeats"),f.innerHTML=d.repeatsText.replace(":","")+" "+Ya(a.repeatEvery),b.appendChild(f));
P(a.location)&&(f=g("div","location"),f.innerHTML=a.location,b.appendChild(f));P(a.description)&&(f=g("div","description"),f.innerHTML=a.description,b.appendChild(f));d.manualEditingEnabled&&(b.onclick=function(){ra(a)});f=0;a.isAllDay||(f=we(c,b,a));return f}function we(a,c,b){var e=ub.offsetHeight,f=e/1440,k=d.spacing,l=null;Lc.push(b);if(!b.isAllDay){l=W(b.repeatEvery);if(gc(b.from,a)||0<l)k=f*yd(b.from);l=gc(b.to,a)?f*yd(b.to)-k:e;l-=2*d.spacing}c.style.top=k+"px";null!==l&&(c.style.height=l+
"px");c.offsetTop+c.offsetHeight>e-d.spacing&&(c.style.height=e-c.offsetTop-3*d.spacing+"px");a=k+ha.offsetHeight/2;a<=ha.offsetHeight&&(a=0);return a}function gc(a,c){return a.getDate()===c.getDate()&&a.getMonth()===c.getMonth()&&a.getFullYear()===c.getFullYear()}function yd(a){var c=a.getHours();a=a.getMinutes();return 60*c+a}function ue(){Y.setDate(Y.getDate()-1);Xa(Y,!0)}function te(){Y.setDate(Y.getDate()+1);Xa(Y,!0)}function Ud(){sa=g("div","list-all-events-view");B.appendChild(sa);var a=g("div",
"title-bar");sa.appendChild(a);d.fullScreenModeEnabled&&(a.ondblclick=ba);var c=g("div","title");c.innerHTML=d.allEventsText;a.appendChild(c);c=g("div","ib-close");c.ondblclick=r;a.appendChild(c);p(c,d.closeTooltipText);c.onclick=function(){fc(sa)};d.manualEditingEnabled&&(c=g("div","ib-plus"),c.onclick=Xb,c.ondblclick=r,a.appendChild(c),p(c,d.addEventTooltipText));d.exportEventsEnabled&&(wb=g("div","ib-arrow-down-full-line"),wb.ondblclick=r,a.appendChild(wb),p(wb,d.exportEventsTooltipText),wb.onclick=
function(){Yb()});d.fullScreenModeEnabled&&(ea=g("div","ib-arrow-expand-left-right"),ea.ondblclick=r,ea.onclick=ba,a.appendChild(ea),p(ea,d.enableFullScreenTooltipText));xb=g("div","contents custom-scroll-bars");sa.appendChild(xb)}function kd(a){a=h(a)?a:!1;Mc(sa);xb.innerHTML="";a&&(xb.scrollTop=0);a=Ea(ob());for(var c=a.length,b=0;b<c;b++){var e=a[b],f=xe(e.from);ye(e,f)}}function ye(a,c){var b=g("div",d.manualEditingEnabled?"event":"event-no-hover");c.appendChild(b);d.manualEditingEnabled&&(b.oncontextmenu=
function(f){ec(f,a)});dc(a,b);var e=g("div","title");e.innerHTML=a.title;b.appendChild(e);e=g("div","date");b.appendChild(e);a.from.getDate()===a.to.getDate()?a.isAllDay?jc(e,a.from,null," - "+d.allDayText):jc(e,a.from,null," - "+sb(a.from,a.to)):ic(e,a.from,a.to);vb(a.repeatEvery)&&0<a.repeatEvery&&(e=g("div","repeats"),e.innerHTML=d.repeatsText.replace(":","")+" "+Ya(a.repeatEvery),b.appendChild(e));P(a.location)&&(e=g("div","location"),e.innerHTML=a.location,b.appendChild(e));P(a.description)&&
(e=g("div","description"),e.innerHTML=a.description,b.appendChild(e));d.manualEditingEnabled&&(b.onclick=function(){ra(a)})}function xe(a){var c="month-"+a.getMonth()+"-"+a.getFullYear(),b=Ka(c),e=new Date(a);if(null===b){var f=g("div","month");xb.appendChild(f);b=g("div","header");b.innerHTML=d.monthNames[a.getMonth()]+" "+a.getFullYear();f.appendChild(b);a=g("div","ib-arrow-expand-left-right");a.ondblclick=r;b.appendChild(a);a.onclick=function(){fc(sa);J(e)};p(a,d.expandMonthTooltipText);b=g("div",
"events");b.id=c;f.appendChild(b)}return b}function Vd(){Ja=g("div","list-all-week-events-view");B.appendChild(Ja);var a=g("div","title-bar");Ja.appendChild(a);d.fullScreenModeEnabled&&(a.ondblclick=ba);aa=g("div","title");a.appendChild(aa);var c=g("div","ib-close");c.ondblclick=r;a.appendChild(c);p(c,d.closeTooltipText);c.onclick=function(){fc(Ja)};d.manualEditingEnabled&&(c=g("div","ib-plus"),c.onclick=Xb,c.ondblclick=r,a.appendChild(c),p(c,d.addEventTooltipText));c=g("div","ib-arrow-right-full");
c.onclick=ze;c.ondblclick=r;a.appendChild(c);p(c,d.nextWeekTooltipText);c=g("div","ib-arrow-left-full");c.onclick=Ae;c.ondblclick=r;a.appendChild(c);p(c,d.previousWeekTooltipText);d.exportEventsEnabled&&(Za=g("div","ib-arrow-down-full-line"),Za.ondblclick=r,a.appendChild(Za),p(Za,d.exportEventsTooltipText),Za.onclick=function(){Yb(yb)});d.fullScreenModeEnabled&&(fa=g("div","ib-arrow-expand-left-right"),fa.ondblclick=r,fa.onclick=ba,a.appendChild(fa),p(fa,d.enableFullScreenTooltipText));zb=g("div",
"contents custom-scroll-bars");Ja.appendChild(zb)}function qb(a,c){c=h(c)?c:!1;Mc(Ja);zb.innerHTML="";$a={};Nc={};yb=[];ta=null===a?new Date:new Date(a);c&&(zb.scrollTop=0);var b=Be(a),e=b[0];b=b[1];Ce(e,b);for(var f=Ea(ob()),k=f.length,l=0;l<k;l++){for(var m=f[l],n=rb(m.from,m.to)+1,u=new Date(m.from),Z=!1,y=0;y<n;y++)u>=e&&u<=b&&(Z=zd(u),Ad(m,Z,u),Z=!0),u.setDate(u.getDate()+1);Z&&yb.push(m);n=W(m.repeatEvery);u=!1;0<n&&(1===n?u=kc(m,e,b,function(Q){Q.setDate(Q.getDate()+1)}):2===n?u=kc(m,e,b,function(Q){Q.setDate(Q.getDate()+
7)}):3===n?u=kc(m,e,b,function(Q){Q.setMonth(Q.getMonth()+1)}):4===n&&(u=kc(m,e,b,function(Q){Q.setFullYear(Q.getFullYear()+1)})));u&&!Z&&yb.push(m)}for(var Bd in $a)$a.hasOwnProperty(Bd)&&zb.appendChild($a[Bd]);d.exportEventsEnabled&&(Za.style.display=0===yb.length?"none":"inline-block")}function kc(a,c,b,e){for(var f=new Date(a.from),k=X(a.repeatEveryExcludeDays),l=X(a.seriesIgnoreDates),m=!1;f<b;){e(f);var n=Va(f);-1===k.indexOf(f.getDay())&&-1===l.indexOf(n)&&f>=c&&f<=b&&(m=zd(f),Ad(a,m,f),m=
!0)}return m}function Ce(a,c){aa.innerHTML="";if(a.getFullYear()===c.getFullYear()){Ia(aa,a,!1,!1);var b=g("span");b.innerHTML=" - ";aa.appendChild(b);Ia(aa,c,!1,!1);b=g("span");b.innerHTML=", "+a.getFullYear();aa.appendChild(b)}else Ia(aa,a,!1,!0),b=g("span"),b.innerHTML=" - ",aa.appendChild(b),Ia(aa,c,!1,!0)}function Ad(a,c,b){var e=g("div",d.manualEditingEnabled?"event":"event-no-hover");c.appendChild(e);if(d.manualEditingEnabled){var f=Va(b);e.oncontextmenu=function(k){ec(k,a,f)}}dc(a,e,Ic(a,
b));c=g("div","title");c.innerHTML=a.title;e.appendChild(c);c=g("div","date");e.appendChild(c);a.from.getDate()===a.to.getDate()?c.innerHTML=a.isAllDay?d.allDayText:sb(a.from,a.to):ic(c,a.from,a.to);vb(a.repeatEvery)&&0<a.repeatEvery&&(c=g("div","repeats"),c.innerHTML=d.repeatsText.replace(":","")+" "+Ya(a.repeatEvery),e.appendChild(c));P(a.location)&&(c=g("div","location"),c.innerHTML=a.location,e.appendChild(c));P(a.description)&&(c=g("div","description"),c.innerHTML=a.description,e.appendChild(c));
d.manualEditingEnabled&&(e.onclick=function(){ra(a)})}function zd(a){var c=Jc(a),b=a.getFullYear()+a.getMonth()+c,e=null,f=new Date(a);if($a.hasOwnProperty(b))e=Nc[b];else{var k=g("div","day");$a[b]=k;e=g("div","header");k.appendChild(e);jc(e,a,d.dayNames[c]+", ");a=g("div","ib-arrow-expand-left-right");a.ondblclick=r;e.appendChild(a);a.onclick=function(){Xa(f,!0)};p(a,d.expandDayTooltipText);e=g("div","events");k.appendChild(e);Nc[b]=e}return e}function Jc(a){return 0>a.getDay()-1?6:a.getDay()-1}
function Be(a){a=h(a)?a:new Date;var c=0===a.getDay()?7:a.getDay();c=a.getDate()-c+1;var b=c+6,e=new Date(a);a=new Date(a);e.setDate(c);e.setHours(0,0,0,0);a.setDate(b);a.setHours(23,59,59,99);return[e,a]}function Ae(){ta.setDate(ta.getDate()-7);qb(ta,!0)}function ze(){ta.setDate(ta.getDate()+7);qb(ta,!0)}function sb(a,c){return Oc(a)+" "+d.toTimeText+" "+Oc(c)}function Oc(a){return E(a.getHours())+":"+E(a.getMinutes())}function ic(a,c,b){a.innerHTML="";var e=g("span");e.innerText=d.startsOnText+
" ";a.appendChild(e);Ia(a,c);c=g("span");c.innerText=" "+d.andFinishesOnText+" ";a.appendChild(c);Ia(a,b)}function Ia(a,c,b,e,f){b=h(b)?b:!0;e=h(e)?e:!0;if(f=h(f)?f:!1){f=Jc(c);var k=g("span");k.innerText=d.dayNames[f]+", ";a.appendChild(k)}jc(a,c);f=g("span");f.innerText=" "+d.monthNames[c.getMonth()];a.appendChild(f);e&&(e=g("span"),e.innerText=" "+c.getFullYear(),a.appendChild(e));b&&(b=g("span"),b.innerText=" "+Oc(c),a.appendChild(b))}function jc(a,c,b,e){if(h(b)){var f=g("span");f.innerText=
b;a.appendChild(f)}b=g("span");b.innerText=c.getDate();a.appendChild(b);d.showDayNumberOrdinals&&(b=g("sup"),b.innerText=Cd(c.getDate()),a.appendChild(b));h(e)&&(c=g("span"),c.innerText=e,a.appendChild(c))}function sc(a,c,b,e,f){var k=new Date;k=a===k.getDate()&&e===k.getFullYear()&&b===k.getMonth();var l=Ka("calendar-day-"+c);c=g("span");var m=new Date(e,b,a);l.innerHTML="";c.className=f?"day-muted":"";c.className+=k?" today":"";c.innerText=a;if(6===m.getDay()||0===m.getDay()&&"cell"===l.className)l.className=
"cell weekend-day";l.oncontextmenu=function(u){lc=new Date(m);xa();r(u);Pc(u,I)};d.showDayNumberOrdinals&&(f=g("sup"),f.innerText=Cd(a),c.appendChild(f));l.appendChild(c);f=g("div","ib-arrow-top-right");l.appendChild(f);p(f,d.expandDayTooltipText);k=xd(m);if(null!==k){var n=g("span","holiday");n.innerText=k;c.appendChild(n)}f.onclick=function(){Xa(m,!0)};d.manualEditingEnabled&&(l.ondblclick=function(){ra(null,m)},d.manualEditingEnabled&&(l.ondragover=function(u){r(u);Dd(l)},l.ondragenter=function(u){r(u);
Dd(l)},l.ondragleave=function(u){r(u);Ed(l)},l.ondrop=function(u){r(u);if(null!==x){u=rb(x.from,x.to);var Z=new Date(e,b,a,x.from.getHours(),x.from.getMinutes()),y=new Date(e,b,a,x.to.getHours(),x.to.getMinutes());0<u&&y.setDate(y.getDate()+u);Ab.updateEvent(x.id,{from:Z,to:y,title:x.title,description:x.description,location:x.location,isAllDay:x.isAllDay,color:x.color,colorText:x.colorText,colorBorder:x.colorBorder,repeatEvery:x.repeatEvery,repeatEveryExcludeDays:x.repeatEveryExcludeDays})}Ed(l)}))}
function Dd(a){-1===a.className.indexOf(" drag-over")&&(a.className+=" drag-over")}function Ed(a){-1<a.className.indexOf(" drag-over")&&(a.className=a.className.replace(" drag-over",""))}function Fb(a,c){return(new Date(a,c+1,0)).getDate()}function Cd(a){var c=d.thText;if(31===a||21===a||1===a)c=d.stText;else if(22===a||2===a)c=d.ndText;else if(23===a||3===a)c=d.rdText;return c}function xd(a){for(var c=null,b=[],e=d.holidays.length,f=0;f<e;f++){var k=d.holidays[f];W(k.day)===a.getDate()&&W(k.month)===
a.getMonth()+1&&(k=v(k.title,null),null!==k&&b.push(k))}0<b.length&&(c=b.join(", "));return c}function me(){null!==I&&C(q.body,I);I=g("div","calendar-drop-down-menu");q.body.appendChild(I);if(d.manualEditingEnabled){var a=g("div","item");a.innerHTML=d.addEventTitle;I.appendChild(a);a.onclick=function(){ra(null,lc)};a=g("div","separator");I.appendChild(a)}a=g("div","item");a.innerHTML=d.expandDayTooltipText;I.appendChild(a);a.onclick=function(){Xa(lc,!0)};a=g("div","separator");I.appendChild(a);a=
g("div","item");a.innerHTML=d.listWeekEventsTooltipText;I.appendChild(a);a.onclick=function(){qb(lc,!0)}}function ne(){null!==O&&C(q.body,O);if(d.manualEditingEnabled){O=g("div","calendar-drop-down-menu");q.body.appendChild(O);var a=g("div","item");a.innerHTML=d.removeEventText;O.appendChild(a);a.onclick=function(){ab(q.body,R);var c=function(){C(q.body,R)},b=0<W(ua.repeatEvery)&&null!==Bb;Fd(d.confirmEventRemoveTitle,d.confirmEventRemoveMessage,function(){c();h(ua.id)&&(Ub.checked||null===Bb?Ab.removeEvent(ua.id,
!0):(Qc(ua.seriesIgnoreDates)?ua.seriesIgnoreDates.push(Bb):ua.seriesIgnoreDates=[Bb],ja()),mc())},c,b)};a=g("div","separator");O.appendChild(a);a=g("div","item");a.innerHTML=d.editEventTitle;O.appendChild(a);a.onclick=function(){ra(ua)}}}function ec(a,c,b){ua=c;Bb=h(b)?b:null;xa();r(a);Pc(a,O)}function Fc(){return null!==I&&"block"===I.style.display}function Gc(){return null!==O&&"block"===O.style.display}function Aa(a,c){try{a.type=c}catch(b){a.type="text"}}function Xb(){ra(null,Y)}function La(){Ma.disabled=
Ba.checked}function Ib(){var a=!1;eb.checked&&(G.value=K.value,S.value="00:00",T.value="23:59",a=!0);G.disabled=a;S.disabled=a;T.disabled=a;a=nc(K);var c=nc(G);c>a||c<a?(a=!0,Ba.checked=!0):a=!1;Ba.disabled=a;Jb.disabled=a;Kb.disabled=a;Lb.disabled=a;Mb.disabled=a;Ma.disabled=a;La()}function ra(a,c){ab(q.body,R);if(h(a)){Na.value=d.updateText;Oa.style.display="block";Hb.innerHTML=d.editEventTitle;F=a;K.value=oc(a.from,K.type);S.value=pc(a.from);G.value=oc(a.to,G.type);T.value=pc(a.to);eb.checked=
a.isAllDay;za.value=v(a.title);gb.value=v(a.description);fb.value=v(a.location);Pa.value=v(a.color,"#484848");Qa.value=v(a.colorText,"#F5F5F5");Ra.value=v(a.colorBorder,"#282828");var b=W(a.repeatEvery);0===b?Ba.checked=!0:1===b?Jb.checked=!0:2===b?Kb.checked=!0:3===b?Lb.checked=!0:4===b&&(Mb.checked=!0);b=X(a.repeatEveryExcludeDays);Nb.checked=-1<b.indexOf(1);Ob.checked=-1<b.indexOf(2);Pb.checked=-1<b.indexOf(3);Qb.checked=-1<b.indexOf(4);Rb.checked=-1<b.indexOf(5);Sb.checked=-1<b.indexOf(6);Tb.checked=
-1<b.indexOf(0)}else{b=new Date;var e=h(c)?c:b,f=new Date;e.getDate()===f.getDate()&&e.getFullYear()===f.getFullYear()&&e.getMonth()===f.getMonth()&&(e.setHours(b.getHours()),e.setMinutes(b.getMinutes()));Na.value=d.addText;Oa.style.display="none";Hb.innerHTML=d.addEventTitle;F={};K.value=oc(e,K.type);S.value=pc(e);G.value=oc(e,G.type);T.value=pc(e);eb.checked=!1;za.value="";gb.value="";fb.value="";Pa.value="#484848";Qa.value="#F5F5F5";Ra.value="#282828";Ba.checked=!0;Nb.checked=!1;Ob.checked=!1;
Pb.checked=!1;Qb.checked=!1;Rb.checked=!1;Sb.checked=!1;Tb.checked=!1}Ib();ya.style.display="block";hb.style.display="none";za.focus()}function ae(){var a=nc(K),c=nc(G),b=S.value.split(":"),e=T.value.split(":"),f=Rc(za.value),k=Rc(gb.value),l=Rc(fb.value);2>b.length?qc(d.fromTimeErrorMessage,S):2>e.length?qc(d.toTimeErrorMessage,T):""===f?qc(d.titleErrorMessage,za):(Gd(a,S.value),Gd(c,T.value),c<a?qc(d.toSmallerThanFromErrorMessage,G):(uc(),b=h(F.id),a={from:a,to:c,title:f,description:k,location:l,
isAllDay:eb.checked,color:F.color,colorText:F.colorText,colorBorder:F.colorBorder,repeatEveryExcludeDays:F.repeatEveryExcludeDays},Ba.checked?a.repeatEvery=0:Jb.checked?a.repeatEvery=1:Kb.checked?a.repeatEvery=2:Lb.checked?a.repeatEvery=3:Mb.checked&&(a.repeatEvery=4),b||(a.organizerName=d.organizerName,a.organizerEmailAddress=d.organizerEmailAddress),b?Ab.updateEvent(F.id,a,!1):Ab.addEvent(a,!1),ja(),mc()))}function Gd(a,c){var b=0,e=0,f=c.split(":");if(2===f.length){var k=parseInt(f[0]);f=parseInt(f[1]);
!isNaN(k)&&2>=k.toString().length&&(b=k);!isNaN(f)&&2>=f.toString().length&&(e=f)}a.setHours(b);a.setMinutes(e)}function nc(a){var c=new Date;if("date"===a.type)c=new Date(a.value);else if(a=a.value.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/))a=new Date(a[3],a[2]-1,a[1]),a instanceof Date&&!isNaN(a)&&(c=a);return c}function uc(){ya.style.display="none";C(q.body,R)}function be(){ka.style.display="block";var a=function(){ka.style.display="none"};Fd(d.confirmEventRemoveTitle,d.confirmEventRemoveMessage,
function(){a();uc();h(F.id)&&(Ab.removeEvent(F.id,!0),mc())},a)}function oc(a,c){var b=("0"+a.getDate()).slice(-2),e=("0"+(a.getMonth()+1)).slice(-2);return"date"===c?a.getFullYear()+"-"+e+"-"+b:b+"/"+e+"/"+a.getFullYear()}function Va(a){var c=("0"+a.getDate()).slice(-2),b=("0"+a.getMonth()).slice(-2);return c+"/"+b+"/"+a.getFullYear()}function pc(a){return E(a.getHours())+":"+E(a.getMinutes())}function E(a){a=a.toString();return 1===a.length?"0"+a:a}function qc(a,c){hb.innerHTML=a;hb.style.display=
"block";c.focus()}function Rc(a){return a.replace(/^\s+|\s+$/g,"")}function mc(){Cb(Ga)&&Xa(Y);Cb(sa)&&kd();Cb(Ja)&&qb(ta)}function ce(){Wc();F.color=Pa.value;F.colorText=Qa.value;F.colorBorder=Ra.value}function Wc(){la.style.display="none";ka.style.display="none"}function Zd(){la.style.display="block";ka.style.display="block"}function de(){Xc();var a=[];Nb.checked&&a.push(1);Ob.checked&&a.push(2);Pb.checked&&a.push(3);Qb.checked&&a.push(4);Rb.checked&&a.push(5);Sb.checked&&a.push(6);Tb.checked&&
a.push(0);F.repeatEveryExcludeDays=a}function Xc(){ma.style.display="none";ka.style.display="none"}function $d(){ma.style.display="block";ka.style.display="block"}function Fd(a,c,b,e,f){f=h(f)?f:!1;na.style.display="block";vc.innerHTML=a;wc.innerHTML=c;ib.onclick=Hd;jb.onclick=Hd;ib.addEventListener("click",b);f?(xc.style.display="block",Ub.checked=!1):(xc.style.display="none",Ub.checked=!0);Ec(e)&&jb.addEventListener("click",e)}function Hd(){na.style.display="none"}function Yb(a){ab(q.body,R);oa.style.display=
"block";bb=a;yc.checked=!0}function bd(){C(q.body,R);oa.style.display="none"}function ee(){bd();yc.checked?cb(bb,"csv"):Yc.checked?cb(bb,"xml"):Zc.checked?cb(bb,"json"):$c.checked?cb(bb,"text"):ad.checked&&cb(bb,"ical")}function fe(a){Db||(Db=!0,Id=a.pageX-z.offsetLeft,Jd=a.pageY-z.offsetTop)}function le(a){Db&&(z.style.left=a.pageX-Id+"px",z.style.top=a.pageY-Jd+"px")}function ge(){Db&&(Db=!1,Kd=!0)}function Ca(){Sa.disabled=!0;Da.disabled=""===V.value;ia=[];va=0}function jd(){"block"!==z.style.display&&
(ia=[],z.style.display="block",V.value="",qd(),Ca());V.focus()}function qd(){Kd||(z.style.left=Fa.innerWidth/2-z.offsetWidth/2+"px",z.style.top=Fa.innerHeight/2-z.offsetHeight/2+"px")}function he(){z.style.display="none"}function ie(){"none"!==L.style.display?(L.style.display="none",pa.className="ib-square-hollow",p(pa,d.restoreTooltipText)):(L.style.display="block",pa.className="ib-minus",p(pa,d.minimizedTooltipText))}function ke(){0<va&&(va--,Ld(),J(ia[va].from))}function je(a){13!==a.keyCode||
Da.disabled||gd()}function gd(){if(0===ia.length){var a=cd.checked,c=a?V.value:V.value.toLowerCase(),b={};pb(function(e){var f=v(e.title),k=v(e.location),l=v(e.description),m=!1;a||(f=f.toLowerCase(),l=l.toLowerCase(),k=k.toLowerCase());dd.checked&&-1<f.indexOf(c)?m=!0:ed.checked&&-1<k.indexOf(c)?m=!0:fd.checked&&-1<l.indexOf(c)&&(m=!0);m&&(f=e.from.getMonth()+"-"+e.from.getFullYear(),b.hasOwnProperty(f)||(ia.push(e),b[f]=!0))})}else va++;Ld();0<ia.length&&J(ia[va].from)}function Ld(){Sa.disabled=
0===va;Da.disabled=va===ia.length-1||0===ia.length}function wd(a,c,b){r(a);null!==wa&&(clearTimeout(wa),wa=null);Ac();"block"!==w.style.display&&(wa=setTimeout(function(){q.body.contains(R)||$b()||Fc()||Gc()||(b=h(b)?b:"",w.className=""===b?"calendar-tooltip-event":"calendar-tooltip",""!==b?w.innerHTML=b:(w.innerHTML="",w.appendChild(zc),w.appendChild(Vb),zc.innerHTML=c.title,vb(c.repeatEvery)&&0<c.repeatEvery?(kb.innerHTML=d.repeatsText.replace(":","")+" "+Ya(c.repeatEvery),ab(w,kb)):(kb.innerHTML=
"",C(w,kb)),P(c.location)?(mb.innerHTML=c.location,ab(w,mb)):(mb.innerHTML="",C(w,mb)),P(c.description)?(lb.innerHTML=c.description,ab(w,lb)):(lb.innerHTML="",C(w,lb)),c.from.getDate()===c.to.getDate()?Vb.innerHTML=c.isAllDay?d.allDayText:sb(c.from,c.to):ic(Vb,c.from,c.to)),Pc(a,w))},d.eventTooltipDelay))}function Ac(){null!==wa&&(clearTimeout(wa),wa=null);Md()&&(w.style.display="none")}function Md(){return null!==wa||null!==w&&"block"===w.style.display}function p(a,c){a.onmousemove=function(b){wd(b,
null,c)}}function vd(){null===Eb&&0<d.autoRefreshTimerDelay&&(Eb=setInterval(function(){Wb()},d.autoRefreshTimerDelay))}function ud(){null!==Eb&&0<d.autoRefreshTimerDelay&&(clearTimeout(Eb),Eb=null)}function Wb(){rd()&&(mc(),ja())}function rd(){return!Md()&&!q.body.contains(R)&&!$b()&&!Fc()&&!Gc()}function Mc(a){Cb(a)||(a.className+=" overlay-shown")}function fc(a){Cb(a)&&(a.className=a.className.replace(" overlay-shown",""))}function Cb(a){return-1<a.className.indexOf("overlay-shown")}function g(a,
c,b){a=a.toLowerCase();var e="text"===a;Sc.hasOwnProperty(a)||(Sc[a]=e?q.createTextNode(""):q.createElement(a));a=Sc[a].cloneNode(!1);h(c)&&(a.className=c);h(b)&&(a.type=b);return a}function Ka(a){db.hasOwnProperty(a)&&null!==db[a]||(db[a]=q.getElementById(a));q.body.contains(db[a])||(db[a]=q.getElementById(a));return db[a]}function ab(a,c){try{a.contains(c)||a.appendChild(c)}catch(b){console.warn(b.message)}}function C(a,c){try{a.contains(c)&&a.removeChild(c)}catch(b){console.warn(b.message)}}function r(a){a.preventDefault();
a.cancelBubble=!0}function Pc(a,c){var b=a.pageX,e=a.pageY;c.style.display="block";b+c.offsetWidth>Fa.innerWidth?b-=c.offsetWidth:b++;e+c.offsetHeight>Fa.innerHeight?e-=c.offsetHeight:e++;c.style.left=b+"px";c.style.top=e+"px"}function U(a,c,b,e){var f=g("div","radioButtonContainer");a.appendChild(f);a=g("label","radioButton");f.appendChild(a);f=g("input",null,"radio");f.name=b;a.appendChild(f);h(e)&&(f.onchange=e);b=g("span","check-mark");a.appendChild(b);b=g("span","text");b.innerText=c;a.appendChild(b);
return f}function H(a,c,b){var e=g("div");a.appendChild(e);a=g("label","checkbox");a.innerText=c;e.appendChild(a);c=g("input",null,"checkbox");a.appendChild(c);h(b)&&(c.onchange=b);b=g("span","check-mark");a.appendChild(b);return[c,a]}function h(a){return void 0!==a&&null!==a&&""!==a}function Ec(a){return h(a)&&"function"===typeof a}function Nd(a){return h(a)&&"string"===typeof a}function vb(a){return h(a)&&"number"===typeof a}function Qc(a){return h(a)&&"object"===typeof a&&a instanceof Array}function P(a){return Nd(a)&&
""!==a}function cb(a,c){c=h(c)?c.toLowerCase():"csv";var b="",e=[];e=h(a)?e.concat(a):ob();e=Ea(e);e=Ea(e,!1);if("csv"===c){var f=[d.idText,d.fromText,d.toText,d.isAllDayText,d.titleText,d.descriptionText,d.locationText,d.backgroundColorText,d.textColorText,d.borderColorText,d.repeatsText,d.repeatDaysToExcludeText,d.seriesIgnoreDatesText,d.createdText,d.organizerNameText,d.organizerEmailAddressText];b=f.length;for(var k=[],l=[],m=0;m<b;m++)k.push(A(f[m]));l.push(k.join(","));f=e.length;for(b=0;b<
f;b++){k=l;m=e[b];var n=[];n.push(A(v(m.id)));n.push(A(rc(m.from)));n.push(A(rc(m.to)));n.push(A(m.isAllDay?d.yesText:d.noText));n.push(A(v(m.title)));n.push(A(v(m.description)));n.push(A(v(m.location)));n.push(A(v(m.color)));n.push(A(v(m.colorText)));n.push(A(v(m.colorBorder)));n.push(A(Ya(m.repeatEvery)));n.push(A(Od(m.repeatEveryExcludeDays)));n.push(A(X(m.seriesIgnoreDates).join(",")));n.push(A(rc(m.created)));n.push(A(v(m.organizerName)));n.push(A(v(m.organizerEmailAddress)));k.push(n.join(","))}b=
l.join("\n")}else if("xml"===c){f=[];f.push('<?xml version="1.0" ?>');f.push("<Events>");b=e.length;for(k=0;k<b;k++){m=e[k];f.push("<Event>");for(l in m)m.hasOwnProperty(l)&&(n=Pd(l),f.push("<"+n+">"+Tc(l,m[l])+"</"+n+">"));f.push("</Event>")}f.push("</Events>");b=f.join("\n")}else if("json"===c){l=[];l.push("{");l.push('"events:": [');b=e.length;for(k=0;k<b;k++){m=e[k];l.push("{");for(f in m)m.hasOwnProperty(f)&&l.push('"'+f+'":"'+Tc(f,m[f])+'",');m=l[l.length-1];l[l.length-1]=m.substring(0,m.length-
1);l.push("},")}l[l.length-1]="}";l.push("]");l.push("}");b=l.join("\n")}else if("text"===c){l=[];f=e.length;for(b=0;b<f;b++){m=e[b];for(k in m)m.hasOwnProperty(k)&&l.push(Pd(k)+": "+Tc(k,m[k]));l.push("")}l.pop();b=l.join("\n")}else if("ical"===c){l=[];l.push("BEGIN:VCALENDAR");l.push("VERSION:2.0");l.push("PRODID:-//hacksw/handcal//NONSGML v1.0//EN");f=e.length;for(b=0;b<f;b++)k=e[b],l.push("BEGIN:VEVENT"),l.push("UID:"+v(k.id)),l.push("DTSTAMP:"+Uc(k.created)),l.push("ORGANIZER;CN="+v(k.organizerName)+
":MAILTO:"+v(k.organizerEmailAddress)),l.push("DTSTART:"+Uc(k.from)),l.push("DTEND:"+Uc(k.to)),l.push("SUMMARY:"+v(k.title)),l.push("END:VEVENT");l.push("END:VCALENDAR");b=l.join("\n")}""!==b&&(e=g("a"),l="text",f=k=c,"text"===c?(k="plain",f="txt"):"ical"===c?(k="calendar",f="ics"):"json"===c&&(l="application"),e.style.display="none",e.setAttribute("target","_blank"),e.setAttribute("href","data:"+l+"/"+k+";charset=utf-8,"+encodeURIComponent(b)),l=e.setAttribute,k=new Date,b=E(k.getDate())+"-"+E(k.getMonth())+
"-"+k.getFullYear(),k=E(k.getHours())+"-"+E(k.getMinutes()),l.call(e,"download",d.exportStartFilename+b+"_"+k+"."+f),q.body.appendChild(e),e.click(),q.body.removeChild(e),qa("onEventsExported"))}function rc(a){var c=E(a.getDate())+"/"+E(a.getMonth())+"/"+a.getFullYear();a=E(a.getHours())+":"+E(a.getMinutes());return c+" "+a}function v(a,c){c=h(c)?c:"";return Nd(a)?a:c}function W(a,c){c=h(c)?c:0;return vb(a)?a:c}function id(a,c){c=h(c)?c:0;return h(a)&&"boolean"===typeof a?a?1:0:c}function X(a,c){c=
h(c)?c:[];return Qc(a)?a:c}function Ya(a){var c=d.repeatsNever;a=W(a);1===a?c=d.repeatsEveryDayText:2===a?c=d.repeatsEveryWeekText:3===a?c=d.repeatsEveryMonthText:4===a&&(c=d.repeatsEveryYearText);return c}function Pd(a){return a.charAt(0).toUpperCase()+a.slice(1)}function Tc(a,c){var b=v(c);"boolean"===typeof c?b=c?d.yesText:d.noText:"object"===typeof c&&c instanceof Date?b=rc(c):"object"===typeof c&&c instanceof Array?b="repeatEveryExcludeDays"===a?Od(c):X(c).join(","):"number"===typeof c&&(b="repeatEvery"===
a?Ya(c):c.toString());return b}function Uc(a){var c=[];c.push(a.getFullYear());c.push(a.getMonth());c.push(a.getDate());c.push("T");c.push(a.getHours());c.push(a.getMinutes());c.push("00");c.push("Z");return c.join("")}function Od(a){var c=[];if(Qc(a))for(var b=a.length,e=0;e<b;e++){var f=a[e]-1;-1===f&&(f=6);c.push(d.dayNames[f])}return X(c).join(",")}function A(a){a=a.replace(/(\r\n|\n|\r)/gm,"").replace(/(\s\s)/gm," ");a=a.replace(/"/g,'""');return'"'+a+'"'}function Bc(){var a=new Date(t);a.setMonth(a.getMonth()-
1);J(a);qa("onPreviousMonth")}function Dc(){var a=new Date(t);a.setMonth(a.getMonth()+1);J(a);qa("onNextMonth")}function sd(){var a=new Date(t);a.setFullYear(a.getFullYear()-1);J(a);qa("onPreviousYear")}function td(){var a=new Date(t);a.setFullYear(a.getFullYear()+1);J(a);qa("onNextYear")}function Cc(){var a=new Date;if(t.getMonth()!==a.getMonth()||t.getFullYear()!==a.getFullYear())J(),qa("onToday")}function Qd(a){h(a)&&"object"===typeof a||(a={});return a}var d={},Ab=this,t=null,tc=null,Sc={},db=
{},q=null,Fa=null,Vc=null,Gb=!1,pd=!1,M={},Eb=null,x=null,od=null,Ua=!1,B=null,D=null,nb=null,N=null,Zb=null,Ta=null,ca=null,R=null,ya=null,ka=null,Hb=null,K=null,S=null,G=null,T=null,eb=null,za=null,gb=null,fb=null,Ba=null,Jb=null,Kb=null,Lb=null,Mb=null,Ma=null,hb=null,F={},Na=null,Oa=null,la=null,Pa=null,Qa=null,Ra=null,ma=null,Nb=null,Ob=null,Pb=null,Qb=null,Rb=null,Sb=null,Tb=null,Ga=null,tb=null,ha=null,Ha=null,ub=null,Y=null,Lc=[],Wa=null,da=null,sa=null,wb=null,ea=null,xb=null,Ja=null,aa=
null,Za=null,fa=null,zb=null,$a={},Nc={},yb=[],ta=null,na=null,vc=null,wc=null,Ub=null,xc=null,ib=null,jb=null,oa=null,yc=null,Yc=null,Zc=null,$c=null,ad=null,bb=null,w=null,zc=null,Vb=null,kb=null,lb=null,mb=null,wa=null,I=null,lc=null,O=null,ua=null,Bb=null,z=null,pa=null,L=null,V=null,cd=null,dd=null,ed=null,fd=null,Sa=null,Da=null,Db=!1,Kd=!1,Id=0,Jd=0,ia=[],va=0;this.turnOnFullScreen=function(){nd()};this.turnOffFullScreen=function(){md()};this.startTheAutoRefreshTimer=function(){vd()};this.stopTheAutoRefreshTimer=
function(){ud()};this.moveToPreviousMonth=function(){Bc()};this.moveToNextMonth=function(){Dc()};this.moveToPreviousYear=function(){sd()};this.moveToNextYear=function(){td()};this.moveToToday=function(){Cc()};this.getCurrentDisplayDate=function(){return new Date(t)};this.setCurrentDisplayDate=function(a){J(new Date(a));qa("onSetDate")};this.exportAllEvents=function(a){d.exportEventsEnabled&&(a=h(a)?a:"csv",cb(null,a))};this.refresh=function(){Wb()};this.addEvents=function(a,c,b){c=h(c)?c:!0;b=h(b)?
b:!0;for(var e=a.length,f=0;f<e;f++)this.addEvent(a[f],!1,!1);b&&ac("onEventAdded",a);c&&ja()};this.addEvent=function(a,c,b){var e=!1;if(a.from<=a.to){var f=a.from;f=f.getFullYear()+"-"+f.getMonth()+"-"+f.getDate();var k=ld();M.hasOwnProperty(f)||(M[f]={});M[f].hasOwnProperty(k)||(c=h(c)?c:!0,b=h(b)?b:!0,h(a.id)?k=a.id:a.id=k,h(a.created)||(a.created=new Date),M[f][k]=hd(a),e=!0,b&&ac("onEventAdded",a),c&&ja())}return e};this.updateEvent=function(a,c,b,e){if(a=this.removeEvent(a,!1,!1))b=h(b)?b:!0,
e=h(e)?e:!0,c.id=ld(),(a=this.addEvent(c,b,!1))&&e&&ac("onEventUpdated",c);return a};this.removeEvent=function(a,c,b){var e=!1;pb(function(f,k,l){if(l===a)return c=h(c)?c:!0,b=h(b)?b:!0,delete M[k][l],e=!0,b&&ac("onEventRemoved",f),c&&ja(),!0});return e};this.clearEvents=function(a){a=h(a)?a:!0;M={};qa("onEventsCleared");a&&ja()};this.getEvents=function(){return Ea(ob())};this.getEvent=function(a){var c=null;pb(function(b,e,f){if(f===a)return c=b,!0});return c};this.setOptions=function(a){a=Qd(a);
for(var c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);Gb&&(Gb=!1,J(t,!0))};(function(a,c){q=a;Fa=c;Vc=Rd;d=Qd(Sd);h(d.previousMonthTooltipText)||(d.previousMonthTooltipText="Previous Month");h(d.nextMonthTooltipText)||(d.nextMonthTooltipText="Next Month");h(d.previousDayTooltipText)||(d.previousDayTooltipText="Previous Day");h(d.nextDayTooltipText)||(d.nextDayTooltipText="Next Day");h(d.previousWeekTooltipText)||(d.previousWeekTooltipText="Previous Week");h(d.nextWeekTooltipText)||(d.nextWeekTooltipText=
"Next Week");h(d.addEventTooltipText)||(d.addEventTooltipText="Add Event");h(d.closeTooltipText)||(d.closeTooltipText="Close");h(d.exportEventsTooltipText)||(d.exportEventsTooltipText="Export Events");h(d.todayTooltipText)||(d.todayTooltipText="Today");h(d.refreshTooltipText)||(d.refreshTooltipText="Refresh");h(d.searchTooltipText)||(d.searchTooltipText="Search");h(d.expandDayTooltipText)||(d.expandDayTooltipText="Expand Day");h(d.listAllEventsTooltipText)||(d.listAllEventsTooltipText="View All Events");
h(d.listWeekEventsTooltipText)||(d.listWeekEventsTooltipText="View Current Week Events");h(d.dayHeaderNames)||(d.dayHeaderNames="Mon Tue Wed Thu Fri Sat Sun".split(" "));h(d.dayNames)||(d.dayNames="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "));h(d.fromText)||(d.fromText="From:");h(d.toText)||(d.toText="To:");h(d.isAllDayText)||(d.isAllDayText="Is All-Day");h(d.titleText)||(d.titleText="Title:");h(d.descriptionText)||(d.descriptionText="Description:");h(d.locationText)||(d.locationText=
"Location:");h(d.addText)||(d.addText="Add");h(d.updateText)||(d.updateText="Update");h(d.cancelText)||(d.cancelText="Cancel");h(d.removeEventText)||(d.removeEventText="Remove");h(d.addEventTitle)||(d.addEventTitle="Add Event");h(d.editEventTitle)||(d.editEventTitle="Edit Event");h(d.monthNames)||(d.monthNames="January February March April May June July August September October November December".split(" "));h(d.showDayNumberOrdinals)||(d.showDayNumberOrdinals=!0);h(d.dragAndDropForEventsEnabled)||
(d.dragAndDropForEventsEnabled=!0);h(d.exportStartFilename)||(d.exportStartFilename="exported_events_");h(d.fromTimeErrorMessage)||(d.fromTimeErrorMessage="Please select a valid 'From' time.");h(d.toTimeErrorMessage)||(d.toTimeErrorMessage="Please select a valid 'To' time.");h(d.toSmallerThanFromErrorMessage)||(d.toSmallerThanFromErrorMessage="Please select a 'To' date that is larger than the 'From' date.");h(d.titleErrorMessage)||(d.titleErrorMessage="Please enter a value in the 'Title' field (no empty space).");
h(d.stText)||(d.stText="st");h(d.ndText)||(d.ndText="nd");h(d.rdText)||(d.rdText="rd");h(d.thText)||(d.thText="th");h(d.maximumEventsPerDayDisplay)||(d.maximumEventsPerDayDisplay=3);h(d.yesText)||(d.yesText="Yes");h(d.noText)||(d.noText="No");h(d.extraSelectableYearsAhead)||(d.extraSelectableYearsAhead=51);h(d.allDayText)||(d.allDayText="All-Day");h(d.allEventsText)||(d.allEventsText="All Events");h(d.exportEventsEnabled)||(d.exportEventsEnabled=!0);h(d.manualEditingEnabled)||(d.manualEditingEnabled=
!0);h(d.showTimesInMainCalendarEvents)||(d.showTimesInMainCalendarEvents=!1);h(d.startsOnText)||(d.startsOnText="Starts on the");h(d.andFinishesOnText)||(d.andFinishesOnText="and finishes on the");h(d.toTimeText)||(d.toTimeText="to");h(d.autoRefreshTimerDelay)||(d.autoRefreshTimerDelay=5E3);h(d.confirmEventRemoveTitle)||(d.confirmEventRemoveTitle="Confirm Event Removal");h(d.confirmEventRemoveMessage)||(d.confirmEventRemoveMessage="Removing this event cannot be undone.  Do you want to continue?");
h(d.okText)||(d.okText="OK");h(d.selectExportTypeTitle)||(d.selectExportTypeTitle="Select Export Type");h(d.fullScreenModeEnabled)||(d.fullScreenModeEnabled=!0);h(d.eventTooltipDelay)||(d.eventTooltipDelay=1E3);h(d.selectColorsText)||(d.selectColorsText="Select Colors");h(d.backgroundColorText)||(d.backgroundColorText="Background Color:");h(d.textColorText)||(d.textColorText="Text Color:");h(d.borderColorText)||(d.borderColorText="Border Color:");h(d.searchEventsTitle)||(d.searchEventsTitle="Search Events");
h(d.forText)||(d.forText="For:");h(d.previousText)||(d.previousText="Previous");h(d.nextText)||(d.nextText="Next");h(d.matchCaseText)||(d.matchCaseText="Match Case");h(d.minimumDayHeight)||(d.minimumDayHeight=0);h(d.repeatsText)||(d.repeatsText="Repeats:");h(d.repeatDaysToExcludeText)||(d.repeatDaysToExcludeText="Repeat Days To Exclude:");h(d.daysToExcludeText)||(d.daysToExcludeText="Days To Exclude:");h(d.seriesIgnoreDatesText)||(d.seriesIgnoreDatesText="Series Ignore Dates:");h(d.repeatsNever)||
(d.repeatsNever="Never");h(d.repeatsEveryDayText)||(d.repeatsEveryDayText="Every Day");h(d.repeatsEveryWeekText)||(d.repeatsEveryWeekText="Every Week");h(d.repeatsEveryMonthText)||(d.repeatsEveryMonthText="Every Month");h(d.repeatsEveryYearText)||(d.repeatsEveryYearText="Every Year");h(d.repeatOptionsTitle)||(d.repeatOptionsTitle="Repeat Options");h(d.moreText)||(d.moreText="More");h(d.includeText)||(d.includeText="Include:");h(d.holidays)||(d.holidays=[{day:24,month:12,title:"Christmas Eve"},{day:25,
month:12,title:"Christmas Day"},{day:26,month:12,title:"Boxing Day"},{day:31,month:12,title:"New Year's Eve"},{day:1,month:1,title:"New Year's Day"}]);h(d.minimizedTooltipText)||(d.minimizedTooltipText="Minimize");h(d.restoreTooltipText)||(d.restoreTooltipText="Restore");h(d.removeAllEventsInSeriesText)||(d.removeAllEventsInSeriesText="Remove All Events In Series");h(d.createdText)||(d.createdText="Created:");h(d.organizerName)||(d.organizerName="");h(d.organizerEmailAddress)||(d.organizerEmailAddress=
"");h(d.organizerNameText)||(d.organizerNameText="Organizer:");h(d.organizerEmailAddressText)||(d.organizerEmailAddressText="Organizer Email:");h(d.enableFullScreenTooltipText)||(d.enableFullScreenTooltipText="Turn On Full-Screen Mode");h(d.disableFullScreenTooltipText)||(d.disableFullScreenTooltipText="Turn Off Full-Screen Mode");h(d.idText)||(d.idText="ID:");h(d.spacing)||(d.spacing=10);h(d.expandMonthTooltipText)||(d.expandMonthTooltipText="Expand Month");J(Td,!0)})(document,window)};
